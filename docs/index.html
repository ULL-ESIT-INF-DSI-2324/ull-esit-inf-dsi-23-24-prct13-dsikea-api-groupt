<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>practica-13-dsi-kea</title><meta name="description" content="Documentation for practica-13-dsi-kea"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">practica-13-dsi-kea</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>practica-13-dsi-kea</h2></div><div class="tsd-panel tsd-typography"><a id="md:práctica-13-api-rest-con-nodeexpress-para-gestionar-una-tienda-de-muebles" class="tsd-anchor"></a><h1><a href="#md:práctica-13-api-rest-con-nodeexpress-para-gestionar-una-tienda-de-muebles">Práctica 13: API REST con Node/Express para gestionar una tienda de muebles</a></h1><p><strong>Nombre:</strong> Alba Pérez Rodríguez</p>
<p><strong>Nombre:</strong> Tomás Javes Tommasone</p>
<p><strong>Nombre:</strong> Guillermo Plaza Gayan</p>
<p><strong>Fecha:</strong> 07/05/2024</p>
<p><strong>Estudios:</strong> Ingeniería Informática</p>
<p><strong>Asignatura:</strong> Desarrollo en Sistemas Informáticos</p>
<p><strong>Profesor:</strong> Eduardo Manuel Segredo González</p>
<hr>
<a id="md:índice" class="tsd-anchor"></a><h1><a href="#md:índice">Índice</a></h1><ol>
<li><a href="#md:1-introducción">Introducción</a></li>
<li><a href="#md:2-objetivos">Objetivos</a></li>
<li><a href="#md:3-antes-de-empezar">Antes de empezar</a></li>
<li><a href="#md:4-configuracion-de-istambul-y-coveralls">Configuración de Istambul y coveralls</a></li>
<li><a href="#md:5-principios-solid">Principios SOLID</a></li>
<li><a href="#md:6-github-actions">GitHub Actions</a></li>
<li><a href="#md:7-módulos">Modulos</a></li>
<li><a href="#md:8-sonarcloud">SonarCloud</a></li>
<li><a href="#md:9-mongodb-y-mongoose">Mongodb y Mongoose</a></li>
<li><a href="#md:11-ejercicio">Ejercicio</a></li>
<li><a href="#md:9-conclusiones">Conclusiones</a></li>
</ol>
<hr>
<a id="md:1-introducción" class="tsd-anchor"></a><h1><a href="#md:1-introducción">1. Introducción.</a></h1><p>Este informe detalla el proceso de desarrollo de la última práctica de la asignatura. </p>
<p>En esta práctica, la segunda grupal de la asignatura, se ha llevado a cabo la implementación de un API REST utilizando Node.js y Express. El objetivo principal ha sido permitir operaciones CRUD (Crear, Leer, Actualizar y Borrar) para la gestión de una tienda de muebles.</p>
<p>Todo el código desarrollado se ha alojado en el repositorio generado tras la aceptación de la asignación grupal de GitHub Classroom, siguiendo una estructura de proyecto similar a la vista en clase.</p>
<p>Además, se ha documentado la solución diseñada, haciendo especial énfasis en las decisiones de diseño implementadas, y se ha realizado un vídeo de 10 minutos de duración máxima en el que todos los miembros del grupo han intervenido. El objetivo del vídeo ha sido describir todas las fases del desarrollo: código fuente implementado, documentación, pruebas, integración continua, calidad del código y despliegue.</p>
<hr>
<a id="md:2-objetivos" class="tsd-anchor"></a><h1><a href="#md:2-objetivos">2. Objetivos.</a></h1><p>Los objetivos de esta práctica han sido:</p>
<ul>
<li><p>Implementar un API REST con Node.js y Express.</p>
</li>
<li><p>Permitir operaciones CRUD para la gestión de una tienda de muebles.</p>
</li>
<li><p>Utilizar MongoDB/MongoDB Atlas como sistema de base de datos no relacional, junto con Mongoose para la gestión desde Node.js.</p>
</li>
<li><p>Desplegar el API en cyclic.</p>
</li>
<li><p>Documentar la solución diseñada, haciendo hincapié en las decisiones de diseño.</p>
</li>
<li><p>Realizar un vídeo descriptivo de todas las fases del desarrollo.</p>
</li>
</ul>
<hr>
<a id="md:3-antes-de-empezar" class="tsd-anchor"></a><h1><a href="#md:3-antes-de-empezar">3. Antes de empezar</a></h1><p>Antes de comenzar con la resolución de ejercicios de la práctica deberemos poner a punto nuestro entorno de trabajo. Para ello, lo haremos siguiendo los siguientes pasos:</p>
<a id="md:creación-de-directorios" class="tsd-anchor"></a><h2><a href="#md:creación-de-directorios">Creación de directorios.</a></h2><p>Crearemos los siguientes directorios para nuestro proyecto:</p>
<ul>
<li><p><strong>src/:</strong> Este directorio almacenará los archivos fuente de TypeScript. En este caso, el código fuente escrito en TypeScript se encuentra en el directorio src.</p>
</li>
<li><p><strong>dist/:</strong> Este directorio se utilizará para almacenar los archivos JavaScript generados por el compilador de TypeScript. La compilación de TypeScript produce código JavaScript, y este código se guarda en el directorio dist.</p>
</li>
</ul>
<a id="md:configuración-para-llevar-a-cabo-la-práctica" class="tsd-anchor"></a><h2><a href="#md:configuración-para-llevar-a-cabo-la-práctica">Configuración para llevar a cabo la práctica:</a></h2><p>Necesitaremo inicializar el proyecto con <em><strong>npm</strong></em>, para ello seguiremos los pasos siguientes:</p>
<p><strong>Paso 1:</strong></p>
<p>Utilizamos el comando *<strong>npm init --yes</strong> para generar un archivo <strong>package.json</strong>. Este archivo contiene la información del proyecto, incluidas las dependencias y scripts.</p>
<pre><code class="language-bash"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;name&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;ull-esit-inf-dsi-23-24-prct04-arrays-tuples-enums-albaaperez&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;version&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;1.0.0&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;description&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;main&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;index.js&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;scripts&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">{</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;start&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;tsc-watch --onSuccess </span><span class="hl-3">\&quot;</span><span class="hl-2">node dist/index.js</span><span class="hl-3">\&quot;</span><span class="hl-2">&quot;,</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;keywords&quot;</span><span class="hl-1">:</span><span class="hl-0"> [],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;author&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;license&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;ISC&quot;,</span><br/><span class="hl-0">}</span><br/>
</code><button>Copy</button></pre>
<p><strong>Paso 2:</strong></p>
<p>Instalación del Compilador de TypeScript. Se instala el compilador de TypeScript globalmente con el comando <em><strong>npm install --global typescript</strong></em>.</p>
<p><strong>Paso 3:</strong></p>
<p>Configuración del Compilador con tsconfig.json. Se crea un archivo de configuración llamado <strong>tsconfig.json</strong> en la raíz del proyecto. Este archivo especifica opciones para el compilador de TypeScript, como el directorio de entrada <strong>(rootDir)</strong> y el directorio de salida <strong>(outDir)</strong>.</p>
<pre><code class="language-bash"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;exclude&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;./tests&quot;</span><span class="hl-1">,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;./node_modules&quot;</span><span class="hl-1">,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;./dist&quot;</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;compilerOptions&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">{</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;target&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;es2022&quot;,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;module&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;commonjs&quot;,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;declaration&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;rootDir&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;./src&quot;,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;outDir&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;./dist&quot;,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;noImplicitAny&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;strictNullChecks&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;noImplicitReturns&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}</span>
</code><button>Copy</button></pre>
<p><strong>Paso 4:</strong></p>
<p>Instalación de tsc-watch para Compilación Automática. Se instala tsc-watch como una dependencia de desarrollo con el comando <strong>npm install --save-dev tsc-watch</strong>.</p>
<p><strong>Paso 5:</strong> </p>
<p>Modificamos la sección de scripts en <strong>package.json</strong> para utilizar tsc-watch y ejecutar el código compilado solo si la compilación es exitosa.</p>
<pre><code class="language-bash"><span class="hl-1">&quot;scripts&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><br/><span class="hl-0">    </span><span class="hl-1">&quot;start&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;tsc-watch --onSuccess </span><span class="hl-3">\&quot;</span><span class="hl-2">node dist/index.js</span><span class="hl-3">\&quot;</span><span class="hl-2">&quot;</span>
</code><button>Copy</button></pre>
<p><strong>Paso 6:</strong>
Ejecutamos el comando <strong>npm start</strong>, que utiliza <strong>tsc-watch</strong> para observar cambios en los archivos de origen y compilar automáticamente.</p>
<a id="md:instalación-de-eslint" class="tsd-anchor"></a><h2><a href="#md:instalación-de-eslint">Instalación de ESlint.</a></h2><p>ESLint, un linter muy conocido para trabajar con JavaScript y TypeScript. Para instalarlo haremos lo siguiente:</p>
<ol>
<li><strong>Instalación de ESLint</strong>:</li>
</ol>
<ul>
<li>Instalamos el ESLint de manera global utilizando el comando <em><strong>npm i -g eslint</strong></em>.</li>
<li>Verificamos la instalación con <strong>eslint --version</strong>.</li>
</ul>
<ol start="2">
<li><strong>Configuración de ESLint</strong>:</li>
</ol>
<ul>
<li>Iniciamos la configuración de ESLint con el comando <em><strong>eslint --init</strong></em>.</li>
<li>Durante la configuración, se elige el tipo de proyecto, el sistema de módulos, el framework (en este caso, ninguno), si se utiliza TypeScript, el entorno de ejecución (Node.js), el formato del archivo de configuración (JSON), y se instalan las dependencias necesarias.</li>
</ul>
<ol start="3">
<li><strong>Archivo de Configuración de ESLint</strong>:</li>
</ol>
<ul>
<li>Configuraremos el archivo de configuración <strong>.eslintrc.json</strong>, que indica el entorno, las extensiones recomendadas (como eslint:recommended y plugin:@typescript-eslint/recommended), el parser de TypeScript, y la configuración de reglas. Se verá de la siguiente manera:</li>
</ul>
<pre><code class="language-bash"><span class="hl-0">  </span><span class="hl-1">&quot;env&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">{</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;es2021&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;node&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;extends&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;eslint:recommended&quot;</span><span class="hl-1">,</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;plugin:@typescript-eslint/recommended&quot;</span><span class="hl-1">,</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;prettier&quot;</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;overrides&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;parser&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;@typescript-eslint/parser&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;parserOptions&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">{</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;ecmaVersion&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;latest&quot;</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;plugins&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;@typescript-eslint&quot;</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;rules&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">{</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;require-jsdoc&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;off&quot;,</span><br/><span class="hl-0">      </span><span class="hl-1">&quot;valid-jsdoc&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;off&quot;</span><br/><span class="hl-0">  }</span>
</code><button>Copy</button></pre>
<ol start="4">
<li><strong>Personalización de Reglas</strong></li>
</ol>
<ul>
<li>Editamos el archivo de configuración para activar, desactivar o personalizar reglas específicas según las necesidades del proyecto.</li>
</ul>
<ol start="5">
<li><strong>Ignorar Archivos:</strong></li>
</ol>
<ul>
<li>Creamos un archivo <strong>.eslintignore</strong> para especificar qué archivos y directorios deben ser ignorados por ESLint.</li>
</ul>
<ol start="6">
<li><strong>Ejecución de ESLint:</strong></li>
</ol>
<ul>
<li>Ejecutamos ESLint en el proyecto con el comando <strong>eslint .</strong>, y se muestra cómo se informan los problemas detectados.</li>
</ul>
<ol start="7">
<li><strong>Formateo del Código con Prettier:</strong></li>
</ol>
<ul>
<li>Instalamos Prettier y eslint-config-prettier para desactivar reglas de formato en ESLint.</li>
<li>Configuramos el ESLint para integrarse con Prettier añadiendo &quot;prettier&quot; a la lista de extensiones en el archivo de configuración.</li>
<li>Se crea un archivo de configuración de Prettier (.prettierrc.json) y un archivo de ignorar (.prettierignore).</li>
</ul>
<hr>
<a id="md:typedoc" class="tsd-anchor"></a><h2><a href="#md:typedoc">Typedoc.</a></h2><p><em><strong>TypeDoc</strong></em> es una herramienta de generación de documentación para proyectos TypeScript. Proporciona una forma eficiente de documentar el código fuente y generar automáticamente documentación en formato HTML. A continuación, se presenta una breve introducción a TypeDoc y cómo se puede utilizar en el contexto de esta práctica.</p>
<a id="md:instalación-de-la-herramienta" class="tsd-anchor"></a><h3><a href="#md:instalación-de-la-herramienta">Instalación de la herramienta.</a></h3><p>Podemos instalar TypeDoc utilizando <em><strong>npm</strong></em> (Node Package Manager). Abrimos la terminal y ejecutamos el siguiente comando:</p>
<pre><code class="language-bash"><span class="hl-1">npm</span><span class="hl-0"> </span><span class="hl-2">install</span><span class="hl-0"> </span><span class="hl-4">--save-dev</span><span class="hl-0"> </span><span class="hl-2">typedoc</span>
</code><button>Copy</button></pre>
<p>Este comando instalará TypeDoc como una dependencia de desarrollo en el proyecto.</p>
<a id="md:uso-básico" class="tsd-anchor"></a><h3><a href="#md:uso-básico">Uso básico.</a></h3><p>Para generar documentación con TypeDoc, simplemente ejecutamos el siguiente comando en la terminal desde el directorio de su proyecto:</p>
<pre><code class="language-bash"><span class="hl-1">npx</span><span class="hl-0"> </span><span class="hl-2">typedoc</span>
</code><button>Copy</button></pre>
<p>Otra forma de hacerlo, es en el compilador, cuyo fichero es <em><strong>package.json</strong></em>. Aquí especificaremos la siguiente línea en el apartado de <strong>scripts</strong>:</p>
<pre><code class="language-bash"><span class="hl-1">&quot;doc&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;typedoc&quot;</span>
</code><button>Copy</button></pre>
<a id="md:configuración" class="tsd-anchor"></a><h3><a href="#md:configuración">Configuración.</a></h3><p><strong>TypeDoc</strong> puede configurarse utilizando un archivo <em><strong>typedoc.json</strong></em> en la raíz del proyecto. Aquí podemos especificar la configuración específica que deseamos para la documentación. </p>
<p><strong>Paso 1: Crear el archivo typedoc.json:</strong></p>
<p>En la raíz de nuestro proyecto crearemos a mano un archivo denominado <strong>typedoc.json</strong>.
Este es un archivo de configuración para TypeDoc.</p>
<p><strong>Paso 2: Configuración específica:</strong></p>
<p>Una vez creado el fichero, dentro escribiremos lo siguiente:</p>
<pre><code class="language-bash"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;entryPoints&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><br/><span class="hl-0">    </span><span class="hl-1">&quot;./src/**/*.ts</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  &quot;</span><span class="hl-1">out</span><span class="hl-1">&quot;: &quot;</span><span class="hl-1">./docs</span><span class="hl-1">&quot;,</span><br/><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Este archivo de configuración le dice a TypeDoc qué archivos deben considerarse para la <strong>generación de documentación</strong>, en este caso, todos los ficheros de los ejercicios realizados y, <strong>dónde debe colocar esa documentación generada</strong>, en nuestro directorio /docs. Cuando ejecutemos <strong>npx typedoc</strong> desde la terminal, TypeDoc utilizará esta configuración para procesar los archivos de entrada y generar la documentación en el directorio especificado.</p>
<p>Configurado TypeDoc podremos ejecutarlo desde la terminal con el comando:</p>
<pre><code class="language-bash"><span class="hl-1">npm</span><span class="hl-0"> </span><span class="hl-2">run</span><span class="hl-0"> </span><span class="hl-2">doc</span>
</code><button>Copy</button></pre>
<hr>
<a id="md:mocha-y-chai" class="tsd-anchor"></a><h2><a href="#md:mocha-y-chai">mocha y chai</a></h2><p><em><strong>Mocha y Chai</strong></em> son herramientas populares para realizar pruebas unitarias en proyectos JavaScript y TypeScript. Mocha es un marco de ejecución de pruebas y Chai es una biblioteca de aserciones que se integra bien con Mocha. Aquí hay una breve introducción sobre cómo comenzar con Mocha y Chai.</p>
<a id="md:instalación-de-las-herramientas" class="tsd-anchor"></a><h3><a href="#md:instalación-de-las-herramientas">Instalación de las herramientas.</a></h3><p>En primer lugar, instalaremos Mocha y Chai como dependencias de desarrollo en nuestro proyecto con el comando:</p>
<pre><code class="language-bash"><span class="hl-0"> </span><span class="hl-1">npm</span><span class="hl-0"> </span><span class="hl-2">install</span><span class="hl-0"> </span><span class="hl-4">--save-dev</span><span class="hl-0"> </span><span class="hl-2">mocha</span><span class="hl-0"> </span><span class="hl-2">chai@4.4.1</span><span class="hl-0"> </span><span class="hl-2">@types/mocha</span><span class="hl-0"> </span><span class="hl-2">@types/chai</span><span class="hl-0"> </span><span class="hl-2">ts-node</span>
</code><button>Copy</button></pre>
<ul>
<li>mocha: El marco de ejecución de pruebas.</li>
<li>chai: Una biblioteca de aserciones. Le especificaremos la versión anterior para trabajar de forma correcta con chai.</li>
<li>@types/mocha y @types/chai: Tipos TypeScript para Mocha y Chai.</li>
<li>ts-node: Permite ejecutar archivos TypeScript directamente en Node.js.</li>
</ul>
<p>Hecho esto, crearemos un fichero denominado <em><strong>.mocharc.json</strong></em>. Este fichero se utiliza para especificar configuraciones personalizadas para la ejecución de pruebas con Mocha.
Este contendrá lo siguiente:</p>
<pre><code class="language-bash"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;extension&quot;</span><span class="hl-1">:</span><span class="hl-0"> [</span><span class="hl-2">&quot;ts&quot;</span><span class="hl-0">],</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;spec&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;tests/**/*.spec.ts&quot;,</span><br/><span class="hl-0">  </span><span class="hl-1">&quot;require&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;ts-node/register&quot;</span><br/><span class="hl-0">}</span>
</code><button>Copy</button></pre>
<ul>
<li><strong>&quot;extension&quot;</strong> --&gt; Mocha reconocerá los archivos con la extensión .ts como archivos de prueba TypeScript.</li>
<li><strong>&quot;spec&quot;</strong> --&gt; Mocha buscará los archivos de prueba en la carpeta tests y sus subdirectorios (**/) que tengan la extensión .spec.ts.</li>
<li><strong>&quot;require&quot;</strong> --&gt; antes de ejecutar las pruebas, se debe registrar el módulo ts-node para permitir la ejecución de archivos TypeScript directamente en Mocha.</li>
</ul>
<a id="md:estructura-de-las-pruebas" class="tsd-anchor"></a><h3><a href="#md:estructura-de-las-pruebas">Estructura de las pruebas.</a></h3><p>En nuestro directorio raíz crearemos un nuevo directorio denominado <strong>/tests</strong> que contendrá nuestros archivos para las pruebas. Nuestros directorios deberán quedar de una forma similar a esta:</p>
<pre><code class="language-bash"><span class="hl-1">/proyecto</span><br/><span class="hl-0">  </span><span class="hl-1">/src</span><br/><span class="hl-0">    </span><span class="hl-1">/EJERCICIO1</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">interfaz.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">index.ts</span><br/><span class="hl-0">    </span><span class="hl-1">/EJERCICIO2</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase1.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase2.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">index.ts</span><br/><span class="hl-0">    </span><span class="hl-1">...</span><br/><span class="hl-0">  </span><span class="hl-1">/test</span><br/><span class="hl-0">    </span><span class="hl-1">/EJERCICIO1</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">interfaz.spec.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase.spec.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">index.spec.ts</span><br/><span class="hl-0">    </span><span class="hl-1">/EJERCICIO2</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase1.spec.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">clase2.spec.ts</span><br/><span class="hl-0">      </span><span class="hl-1">-</span><span class="hl-0"> </span><span class="hl-2">index.spec.ts</span><br/><span class="hl-0">    </span><span class="hl-1">...</span><br/>
</code><button>Copy</button></pre>
<a id="md:escribir-las-pruebas" class="tsd-anchor"></a><h3><a href="#md:escribir-las-pruebas">Escribir las pruebas.</a></h3><p>Por último, lo que deberemos hacer será escribir las pruebas en esos ficheros que vamos a crear terminados en <strong>.spec.ts</strong>. La importancion de mocha y chai en nuestro archivos de prueba serán:</p>
<pre><code class="language-bash"><span class="hl-1">import</span><span class="hl-0"> </span><span class="hl-2">&#39;mocha&#39;</span><span class="hl-0">;</span><br/><span class="hl-1">import</span><span class="hl-0"> </span><span class="hl-2">{expect}</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-0">;</span><br/><span class="hl-1">import</span><span class="hl-0"> </span><span class="hl-2">{</span><span class="hl-0"> </span><span class="hl-2">mcd</span><span class="hl-0"> </span><span class="hl-2">}</span><span class="hl-0"> </span><span class="hl-2">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/EJERCICIO1&#39;</span><span class="hl-0">;</span>
</code><button>Copy</button></pre>
<ul>
<li>Utilizamos <strong>describe</strong> para agrupar las pruebas relacionadas</li>
<li>Cada prueba se crea con <strong>it</strong>.</li>
<li>Usamos las aserciones de Chai, por ejemplo, <strong>expect(result).to.be.undefined.</strong></li>
</ul>
<a id="md:subir-archivos" class="tsd-anchor"></a><h2><a href="#md:subir-archivos">Subir archivos</a></h2><p>Una vez hayamos terminado de realizar los ejercicios, procederemos a subirlos a nuestro repositorio de github mediante:</p>
<ul>
<li><strong>git add .</strong></li>
<li><strong>git commit -m &quot; &quot;</strong></li>
<li><strong>git push</strong></li>
</ul>
<p>Pero antes de hacer esto deberemos crear un fichero ***.gitignore** donde introduciremos lo siguiente:</p>
<pre><code class="language-bash"><span class="hl-1">node_modules</span><br/><span class="hl-1">dist</span><br/><span class="hl-1">package-lock.json</span>
</code><button>Copy</button></pre>
<p>El archivo <strong>.gitignore</strong> se utiliza para especificar archivos y directorios que no deben ser incluidos en el control de versiones de Git. En este caso, estos archivos serán ignorados a la hora de subirlos a GitHub.</p>
<hr>
<a id="md:4-configuracion-de-istanbul-y-coveralls" class="tsd-anchor"></a><h1><a href="#md:4-configuracion-de-istanbul-y-coveralls">4. Configuracion de Istanbul y coveralls.</a></h1><a id="md:¿que-son" class="tsd-anchor"></a><h3><a href="#md:¿que-son">¿Que son?</a></h3><p>En esta sección, detallaremos la configuración necesaria para utilizar <strong>Istanbul y Coveralls</strong> en nuestro proyecto. Estas herramientas son valiosas para evaluar la cobertura de nuestro código fuente y realizar un seguimiento de la misma.</p>
<a id="md:instalación" class="tsd-anchor"></a><h3><a href="#md:instalación">Instalación</a></h3><p>Primero, realizaremos la instalación de los mismos con los siguientes comandos:</p>
<pre><code class="language-bash"><span class="hl-1">npm</span><span class="hl-0"> </span><span class="hl-2">install</span><span class="hl-0"> </span><span class="hl-4">--save-dev</span><span class="hl-0"> </span><span class="hl-2">nyc</span><span class="hl-0"> </span><span class="hl-2">coveralls</span>
</code><button>Copy</button></pre>
<p>En nuestro fichero <strong>package.json</strong> detallaremos lo siguiente para terminar de configurar Istanbul y coveralls:</p>
<pre><code class="language-bash"><span class="hl-1">&quot;test&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;nyc mocha&quot;,</span><br/><span class="hl-1">&quot;coverage&quot;</span><span class="hl-1">:</span><span class="hl-0"> </span><span class="hl-2">&quot;nyc npm test &amp;&amp; nyc report --reporter=text-lcov | coveralls &amp;&amp; rm -rf .nyc_output&quot;,</span>
</code><button>Copy</button></pre>
<a id="md:inicio-de-sesión-en-coveralls-para-el-cubrimiento-del-código" class="tsd-anchor"></a><h3><a href="#md:inicio-de-sesión-en-coveralls-para-el-cubrimiento-del-código">Inicio de sesión en Coveralls para el cubrimiento del código</a></h3><p>Para realizar esto, nos deberemos meter en la página de <a href="#md:https://coveralls.io/">Coveralls</a>.
Dentro de esta iniciaremos sesión con nuestras credenciales de GitHub.
Si deseamos agregar un repositorio para el cubrimiento de nuestro código este deberá ser de visibilidad pública.<br>Lo agregaremos dándole a <strong>ADD REPOS</strong> y una vez elegido el repositorio copiaremos el token.
Por último, en nuestro directorio raíz crearemos el <strong>.coveralls.yml</strong> que contendrá el token de nuestro repositorio:</p>
<pre><code class="language-bash"><span class="hl-1">repo_token:</span><span class="hl-0"> </span><span class="hl-2">xbwn8u45rB3Q44dE2hFjQT0kbhDmRPDuu</span>
</code><button>Copy</button></pre>
<hr>
<a id="md:5-principios-solid" class="tsd-anchor"></a><h1><a href="#md:5-principios-solid">5. Principios SOLID.</a></h1><p>En el desarrollo de software, <em><strong>los Principios SOLID</strong></em> son un conjunto de principios de diseño orientados a la creación de sistemas más mantenibles, flexibles y escalables. Estos principios fueron introducidos por el ingeniero de software Robert C. Martin y representan un conjunto de directrices que buscan mejorar la calidad del código y facilitar su mantenimiento a lo largo del tiempo.</p>
<a id="md:¿cuáles-son" class="tsd-anchor"></a><h2><a href="#md:¿cuáles-son">¿Cuáles son?</a></h2><p>Los Principios SOLID son un acrónimo que representa los siguientes principios:</p>
<a id="md:s---principio-de-responsabilidad-única-single-responsibility-principle---srp" class="tsd-anchor"></a><h3><a href="#md:s---principio-de-responsabilidad-única-single-responsibility-principle---srp">S - Principio de Responsabilidad Única (Single Responsibility Principle - SRP)</a></h3><p>El <strong>SRP</strong> establece que una clase debería tener una única razón para cambiar. En otras palabras, una clase debería tener una <strong>única responsabilidad</strong>, una única función.</p>
<a id="md:o---principio-de-abiertocerrado-openclosed-principle---ocp" class="tsd-anchor"></a><h3><a href="#md:o---principio-de-abiertocerrado-openclosed-principle---ocp">O - Principio de Abierto/Cerrado (Open/Closed Principle - OCP)</a></h3><p>El <strong>OCP</strong> propone que una entidad de software, como una clase, debe estar <strong>abierta para la extensión pero cerrada para la modificación</strong>. Se busca lograr esto mediante la creación de código que pueda ser extendido sin modificar su funcionalidad existente.</p>
<a id="md:l---principio-de-sustitución-de-liskov-liskov-substitution-principle---lsp" class="tsd-anchor"></a><h3><a href="#md:l---principio-de-sustitución-de-liskov-liskov-substitution-principle---lsp">L - Principio de Sustitución de Liskov (Liskov Substitution Principle - LSP)</a></h3><p>El <strong>LSP</strong> establece que los objetos de una clase base deben <strong>poder ser sustituidos por objetos de sus clases derivadas</strong> sin afectar la corrección del programa.</p>
<a id="md:i---principio-de-segregación-de-interfaces-interface-segregation-principle---isp" class="tsd-anchor"></a><h3><a href="#md:i---principio-de-segregación-de-interfaces-interface-segregation-principle---isp">I - Principio de Segregación de Interfaces (Interface Segregation Principle - ISP)</a></h3><p>El <strong>ISP</strong> propone que una clase no debería verse obligada a implementar interfaces que no utiliza. En lugar de interfaces generales, se prefieren interfaces más específicas.</p>
<a id="md:d---principio-de-inversión-de-dependencia-dependency-inversion-principle---dip" class="tsd-anchor"></a><h3><a href="#md:d---principio-de-inversión-de-dependencia-dependency-inversion-principle---dip">D - Principio de Inversión de Dependencia (Dependency Inversion Principle - DIP)</a></h3><p>El <strong>DIP</strong> propone que las dependencias de alto nivel no deben depender de módulos de bajo nivel, sino que ambos deben depender de abstracciones. Además, las abstracciones no deben depender de los detalles, sino que los detalles deben depender de las abstracciones.</p>
<a id="md:importancia-y-beneficios" class="tsd-anchor"></a><h2><a href="#md:importancia-y-beneficios">Importancia y Beneficios</a></h2><p>La aplicación de los Principios SOLID en el desarrollo de software tiene varios beneficios, entre ellos:</p>
<ul>
<li><strong>Mantenibilidad:</strong> Facilitan el mantenimiento del código a lo largo del tiempo.</li>
<li><strong>Escalabilidad:</strong> Permiten construir sistemas más flexibles y escalables.</li>
<li><strong>Reusabilidad:</strong> Favorecen la reutilización de código y componentes.</li>
<li><strong>Legibilidad:</strong> Mejoran la claridad y la comprensión del código.</li>
</ul>
<p>En esta práctica, se presentarán ejemplos específicos de código que ilustrarán la aplicación práctica de los Principios SOLID en nuestro proyecto. Veremos cómo estos principios se traducen en un código más limpio, modular y fácil de entender.</p>
<p>A lo largo de la revisión de los ejercicios, se destacarán las áreas donde los Principios SOLID han sido implementados con éxito, subrayando la importancia de seguir estas directrices para lograr un diseño de software robusto y sostenible.</p>
<hr>
<a id="md:6-github-actions" class="tsd-anchor"></a><h1><a href="#md:6-github-actions">6. GitHub Actions</a></h1><a id="md:¿qué-es" class="tsd-anchor"></a><h2><a href="#md:¿qué-es">¿Qué es?</a></h2><p><em><strong>GitHub Actions</strong></em> es una característica integrada en GitHub que te permite automatizar, personalizar y ejecutar flujos de trabajo directamente desde tu repositorio. Con GitHub Actions, podemos crear flujos de trabajo que respondan a eventos específicos en tu repositorio, como solicitudes de extracción, confirmaciones de código, creación de problemas y mucho más.</p>
<a id="md:características" class="tsd-anchor"></a><h2><a href="#md:características">Características</a></h2><p>Encontramos algunas características de esta herramienta:</p>
<a id="md:automatización-de-tareas" class="tsd-anchor"></a><h3><a href="#md:automatización-de-tareas">Automatización de tareas</a></h3><p>Con GitHub Actions, puedes automatizar tareas repetitivas, como pruebas de código, compilaciones, despliegues, notificaciones y más.</p>
<a id="md:personalización" class="tsd-anchor"></a><h3><a href="#md:personalización">Personalización</a></h3><p>Los flujos de trabajo de GitHub Actions son altamente personalizables. Puedes crear flujos de trabajo específicos para tus necesidades utilizando una variedad de acciones predefinidas o creando tus propias acciones personalizadas.</p>
<a id="md:eventos-del-repositorio" class="tsd-anchor"></a><h3><a href="#md:eventos-del-repositorio">Eventos del repositorio</a></h3><p>Los flujos de trabajo pueden activarse en respuesta a una amplia gama de eventos en tu repositorio, lo que te permite ejecutar acciones específicas en función de las acciones de los colaboradores, el estado del código y otros factores.</p>
<a id="md:integración-con-el-ecosistema-de-github" class="tsd-anchor"></a><h3><a href="#md:integración-con-el-ecosistema-de-github">Integración con el ecosistema de GitHub</a></h3><p>GitHub Actions se integra perfectamente con el ecosistema de GitHub, lo que te permite acceder a tus repositorios, problemas, solicitudes de extracción y otros datos directamente desde tus flujos de trabajo.</p>
<a id="md:configuración-1" class="tsd-anchor"></a><h2><a href="#md:configuración-1">Configuración</a></h2><p>Para la configuración de las Github Actions deberemos meternos en el apartado de nuestro repositorio de <strong>Actions</strong> y seleccionar <strong>Node.js</strong> como flujo de trabajo. 
Al hacer esto se nos creará un archivo denominado node.js.yml que contendrá lo siguiente:</p>
<pre><code class="language-typescript"><span class="hl-0"># </span><span class="hl-5">This</span><span class="hl-0"> </span><span class="hl-5">workflow</span><span class="hl-0"> </span><span class="hl-5">will</span><span class="hl-0"> </span><span class="hl-6">do</span><span class="hl-0"> </span><span class="hl-5">a</span><span class="hl-0"> </span><span class="hl-5">clean</span><span class="hl-0"> </span><span class="hl-5">installation</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">node</span><span class="hl-0"> </span><span class="hl-5">dependencies</span><span class="hl-0">, </span><span class="hl-5">cache</span><span class="hl-0">/</span><span class="hl-5">restore</span><span class="hl-0"> </span><span class="hl-5">them</span><span class="hl-0">, </span><span class="hl-5">build</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">source</span><span class="hl-0"> </span><span class="hl-5">code</span><span class="hl-0"> </span><span class="hl-5">and</span><span class="hl-0"> </span><span class="hl-5">run</span><span class="hl-0"> </span><span class="hl-5">tests</span><span class="hl-0"> </span><span class="hl-5">across</span><span class="hl-0"> </span><span class="hl-5">different</span><span class="hl-0"> </span><span class="hl-5">versions</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">node</span><br/><span class="hl-0"># </span><span class="hl-5">For</span><span class="hl-0"> </span><span class="hl-5">more</span><span class="hl-0"> </span><span class="hl-5">information</span><span class="hl-0"> </span><span class="hl-7">see</span><span class="hl-0">: </span><span class="hl-7">https</span><span class="hl-0">:</span><span class="hl-8">//docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-nodejs</span><br/><br/><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Tests</span><br/><br/><span class="hl-7">on</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">push</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-2">&quot;main&quot;</span><span class="hl-0"> ]</span><br/><span class="hl-0">  </span><span class="hl-7">pull_request</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-2">&quot;main&quot;</span><span class="hl-0"> ]</span><br/><br/><span class="hl-7">jobs</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">build</span><span class="hl-0">:</span><br/><br/><span class="hl-0">    </span><span class="hl-5">runs</span><span class="hl-0">-</span><span class="hl-7">on</span><span class="hl-0">: </span><span class="hl-5">ubuntu</span><span class="hl-0">-</span><span class="hl-5">latest</span><br/><br/><span class="hl-0">    </span><span class="hl-7">strategy</span><span class="hl-0">:</span><br/><span class="hl-0">      </span><span class="hl-7">matrix</span><span class="hl-0">:</span><br/><span class="hl-0">        </span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-7">version</span><span class="hl-0">: [16.</span><span class="hl-5">x</span><span class="hl-0">, 18.</span><span class="hl-5">x</span><span class="hl-0">, 19.</span><span class="hl-5">x</span><span class="hl-0">, 20.</span><span class="hl-5">x</span><span class="hl-0">, 21.</span><span class="hl-5">x</span><span class="hl-0">]</span><br/><span class="hl-0">        # </span><span class="hl-5">See</span><span class="hl-0"> </span><span class="hl-5">supported</span><span class="hl-0"> </span><span class="hl-5">Node</span><span class="hl-0">.</span><span class="hl-5">js</span><span class="hl-0"> </span><span class="hl-5">release</span><span class="hl-0"> </span><span class="hl-5">schedule</span><span class="hl-0"> </span><span class="hl-5">at</span><span class="hl-0"> </span><span class="hl-7">https</span><span class="hl-0">:</span><span class="hl-8">//nodejs.org/en/about/releases/</span><br/><br/><span class="hl-0">    </span><span class="hl-7">steps</span><span class="hl-0">:</span><br/><span class="hl-0">    - </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">checkout</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">    - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Use</span><span class="hl-0"> </span><span class="hl-5">Node</span><span class="hl-0">.</span><span class="hl-5">js</span><span class="hl-0"> </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">matrix</span><span class="hl-0">.</span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-5">version</span><span class="hl-0"> }}</span><br/><span class="hl-0">      </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">setup</span><span class="hl-0">-</span><span class="hl-5">node</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">      </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">        </span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-7">version</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">matrix</span><span class="hl-0">.</span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-5">version</span><span class="hl-0"> }}</span><br/><span class="hl-0">    - </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">install</span><br/><span class="hl-0">    - </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">test</span>
</code><button>Copy</button></pre>
<p>Este fichero será para las pruebas o tests como se indica en el nombre.
Deberemos configurar más Actions para llevar a cabo toda la práctica. 
Tras hacer un commit con los cambios comenzaremos a utilizar las GitHub Actions.
Ahora, en visual podemos hacer la configuración de la Action de coveralls. Crearemos el fichero coveralls.yml que tendrá lo siguiente:</p>
<pre><code class="language-typescript"><span class="hl-0"># </span><span class="hl-5">This</span><span class="hl-0"> </span><span class="hl-5">workflow</span><span class="hl-0"> </span><span class="hl-5">will</span><span class="hl-0"> </span><span class="hl-6">do</span><span class="hl-0"> </span><span class="hl-5">a</span><span class="hl-0"> </span><span class="hl-5">clean</span><span class="hl-0"> </span><span class="hl-5">installation</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">node</span><span class="hl-0"> </span><span class="hl-5">dependencies</span><span class="hl-0">, </span><span class="hl-5">cache</span><span class="hl-0">/</span><span class="hl-5">restore</span><span class="hl-0"> </span><span class="hl-5">them</span><span class="hl-0">, </span><span class="hl-5">build</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">source</span><span class="hl-0"> </span><span class="hl-5">code</span><span class="hl-0"> </span><span class="hl-5">and</span><span class="hl-0"> </span><span class="hl-5">run</span><span class="hl-0"> </span><span class="hl-5">tests</span><span class="hl-0"> </span><span class="hl-5">across</span><span class="hl-0"> </span><span class="hl-5">different</span><span class="hl-0"> </span><span class="hl-5">versions</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">node</span><br/><span class="hl-0"># </span><span class="hl-5">For</span><span class="hl-0"> </span><span class="hl-5">more</span><span class="hl-0"> </span><span class="hl-5">information</span><span class="hl-0"> </span><span class="hl-7">see</span><span class="hl-0">: </span><span class="hl-7">https</span><span class="hl-0">:</span><span class="hl-8">//docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-nodejs</span><br/><br/><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Coveralls</span><br/><br/><span class="hl-7">on</span><span class="hl-0">:</span><br/><span class="hl-7">push</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-2">&quot;main&quot;</span><span class="hl-0"> ]</span><br/><span class="hl-7">pull_request</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-2">&quot;main&quot;</span><span class="hl-0"> ]</span><br/><br/><span class="hl-7">jobs</span><span class="hl-0">:</span><br/><span class="hl-7">build</span><span class="hl-0">:</span><br/><br/><span class="hl-0">  </span><span class="hl-5">runs</span><span class="hl-0">-</span><span class="hl-7">on</span><span class="hl-0">: </span><span class="hl-5">ubuntu</span><span class="hl-0">-</span><span class="hl-5">latest</span><br/><br/><span class="hl-0">  </span><span class="hl-7">steps</span><span class="hl-0">:</span><br/><span class="hl-0">  - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Cloning</span><span class="hl-0"> </span><span class="hl-5">repo</span><br/><span class="hl-0">    </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">checkout</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">  - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Use</span><span class="hl-0"> </span><span class="hl-5">Node</span><span class="hl-0">.</span><span class="hl-5">js</span><span class="hl-0"> 21.</span><span class="hl-5">x</span><br/><span class="hl-0">    </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">setup</span><span class="hl-0">-</span><span class="hl-5">node</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">    </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">      </span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-7">version</span><span class="hl-0">: 21.</span><span class="hl-5">x</span><br/><span class="hl-0">  - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Installing</span><span class="hl-0"> </span><span class="hl-5">dependencies</span><br/><span class="hl-0">    </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">ci</span><br/><span class="hl-0">  - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Generating</span><span class="hl-0"> </span><span class="hl-5">coverage</span><span class="hl-0"> </span><span class="hl-5">information</span><br/><span class="hl-0">    </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">run</span><span class="hl-0"> </span><span class="hl-5">coverage</span><br/><span class="hl-0">  - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Coveralls</span><span class="hl-0"> </span><span class="hl-5">GitHub</span><span class="hl-0"> </span><span class="hl-5">Action</span><br/><span class="hl-0">    </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">coverallsapp</span><span class="hl-0">/</span><span class="hl-5">github</span><span class="hl-0">-</span><span class="hl-5">action</span><span class="hl-0">@</span><span class="hl-5">v2</span><span class="hl-0">.</span><span class="hl-9">2.3</span><br/><span class="hl-0">    </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">      </span><span class="hl-5">github</span><span class="hl-0">-</span><span class="hl-7">token</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">secrets</span><span class="hl-0">.</span><span class="hl-10">GITHUB_TOKEN</span><span class="hl-0"> }}</span>
</code><button>Copy</button></pre>
<p>Hecho esto, cada vez que hagamos un git commit y un git push nos saldrán las Acciones.</p>
<hr>
<a id="md:7-módulos" class="tsd-anchor"></a><h1><a href="#md:7-módulos">7. Módulos</a></h1><p>En el desarrollo de aplicaciones en TypeScript, especialmente en entornos de pruebas con Mocha y herramientas de cobertura de código como nyc, es esencial configurar adecuadamente el manejo de módulos ESM (ECMAScript Modules). Esta configuración garantiza que nuestras pruebas sean efectivas y que los informes de cobertura reflejen con precisión el estado de nuestros módulos.</p>
<p><strong>Paso 1: Instalación de c8.</strong></p>
<p>Para comenzar, es necesario instalar la herramienta de cobertura <strong>c8</strong> como dependencia de desarrollo. Esto se logra ejecutando el siguiente comando:</p>
<pre><code class="language-bash"><span class="hl-1">npm</span><span class="hl-0"> </span><span class="hl-2">i</span><span class="hl-0"> </span><span class="hl-4">--save-dev</span><span class="hl-0"> </span><span class="hl-2">c8</span>
</code><button>Copy</button></pre>
<p><strong>Paso 2: Configuración del Script de Cobertura en package.json</strong></p>
<p>Posteriormente, en el archivo <strong>package.json</strong>, ajustamos el script de cobertura para utilizar c8 en lugar de nyc. Esto se logra modificando la sección &quot;scripts&quot; como se muestra a continuación:</p>
<pre><code class="language-typescript"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-2">&quot;scripts&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-2">&quot;coverage&quot;</span><span class="hl-5">:</span><span class="hl-0"> </span><span class="hl-2">&quot;c8 npm test &amp;&amp; c8 report --reporter=lcov&quot;</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}</span>
</code><button>Copy</button></pre>
<p><strong>Paso 3: Ajuste de las Pruebas para Módulos ESM</strong></p>
<p>Es necesario modificar el archivo de configuración de Mocha, <strong>.mocharc.json</strong>, para utilizar el cargador ESM de ts-node al ejecutar las pruebas. Esto se logra configurando la propiedad &quot;loader&quot; como se muestra a continuación:</p>
<pre><code class="language-typescript"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-2">&quot;extension&quot;</span><span class="hl-0">: [</span><br/><span class="hl-0">    </span><span class="hl-2">&quot;ts&quot;</span><br/><span class="hl-0">  ],</span><br/><span class="hl-0">  </span><span class="hl-2">&quot;spec&quot;</span><span class="hl-0">: </span><span class="hl-2">&quot;tests/**/*.spec.ts&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-2">&quot;loader&quot;</span><span class="hl-0">: </span><span class="hl-2">&quot;ts-node/esm&quot;</span><br/><span class="hl-0">}</span>
</code><button>Copy</button></pre>
<p><strong>Paso 4: Importación de Módulos con Extensión .js</strong></p>
<p>En los archivos de prueba <strong>(*.spec.ts)</strong>, cuando importamos módulos, es fundamental añadir la extensión .js a los nombres de los módulos importados. Esto es necesario para que funcionen correctamente con el cargador ESM. Un ejemplo de importación sería el siguiente:</p>
<pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">expect</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-0">; </span><span class="hl-8">// Importamos el módulo con extensión .js</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">myFunction</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/myModule.js&#39;</span><span class="hl-0">; </span><span class="hl-8">// Importamos nuestro módulo con extensión .js</span>
</code><button>Copy</button></pre>
<p>Con esta configuración, aseguramos que nuestras pruebas sean efectivas, generamos informes precisos de cobertura y garantizamos que nuestros módulos ESM se manejen correctamente en el entorno de prueba.</p>
<hr>
<a id="md:8-sonarcloud" class="tsd-anchor"></a><h1><a href="#md:8-sonarcloud">8. SonarCloud</a></h1><a id="md:¿qué-es-sonarcloud" class="tsd-anchor"></a><h3><a href="#md:¿qué-es-sonarcloud">¿Qué es SonarCloud?</a></h3><p>SonarCloud es una plataforma de análisis estático de código diseñada para mejorar la calidad del software. Utiliza técnicas de análisis estático para identificar y reportar problemas de calidad del código, como errores, vulnerabilidades de seguridad, malas prácticas y duplicación de código.</p>
<a id="md:características-de-sonarcloud" class="tsd-anchor"></a><h3><a href="#md:características-de-sonarcloud">Características de SonarCloud:</a></h3><ul>
<li><p><strong>Análisis de código estático:</strong> SonarCloud examina el código fuente de tu proyecto en busca de posibles problemas de calidad, proporcionando una visión detallada de la salud del código.</p>
</li>
<li><p><strong>Integración continua:</strong> Puedes integrar SonarCloud en tu proceso de integración continua para automatizar el análisis del código cada vez que se realice un cambio, lo que te permite detectar problemas de calidad de forma proactiva.</p>
</li>
<li><p><strong>Métricas y seguimiento:</strong> SonarCloud ofrece métricas detalladas sobre la calidad del código y su evolución a lo largo del tiempo, lo que te permite realizar un seguimiento del progreso y tomar medidas para mejorar la calidad del código.</p>
</li>
<li><p><strong>Comentarios y recomendaciones:</strong> SonarCloud proporciona comentarios detallados y recomendaciones para cada problema identificado, ayudándote a comprender la naturaleza del problema y cómo solucionarlo de manera efectiva.</p>
</li>
<li><p><strong>Integración con GitHub:</strong> SonarCloud se integra estrechamente con GitHub, lo que te permite ver los resultados del análisis directamente en tus solicitudes de extracción y gestionar la calidad del código desde el mismo entorno en el que trabajas.</p>
</li>
</ul>
<a id="md:configuración-2" class="tsd-anchor"></a><h2><a href="#md:configuración-2">Configuración</a></h2><p>Para la configuración de <strong>SonarCloud</strong> lo que deberemos hacer es lo siguiente:</p>
<p><strong>Paso 1</strong>: Iniciamos sesión en la Página de SonarCloud.</p>
<p><strong>Paso 2</strong>: Añadimos un nuevo proyecto. En nuestro caso seleccionamos la organizacion del curso de dsi y localizamos nuestro repositorio que anteriormente debe estar en <strong>Public</strong>.</p>
<p><strong>Paso 3</strong>: Al comenzar un nuevo proyecto con el repositorio seleccionado deberemos meternos dentro de este y seleccionar <strong>Analysis Method</strong>. Dentro de esto, desactivaremos el botón de <strong>Automatic Analysis</strong> y nos meteremos a la opción de <strong>GitHub Actions</strong>.</p>
<p><strong>Paso 4</strong>: Dentro de los Actions de esta página copiaremos el SONAR_TOKEN y el valor secreto bajo este. Seguidamente, nos dirigiremos a GitHub a nuestro repositorio y en el apartado de settings -&gt; secretos deberemos introducir estos datos copiados anteriormente. </p>
<p><strong>Paso 5</strong>: Hecho esto, nos dirigimos a la página de antes de SonarCloud y eligiremos la opción de ts para typscript. Se nos desplegará los siguiente:</p>
<pre><code class="language-typescript"><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Build</span><br/><span class="hl-7">on</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">push</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">branches</span><span class="hl-0">:</span><br/><span class="hl-0">      - </span><span class="hl-5">main</span><br/><span class="hl-0">  </span><span class="hl-7">pull_request</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">types</span><span class="hl-0">: [</span><span class="hl-5">opened</span><span class="hl-0">, </span><span class="hl-5">synchronize</span><span class="hl-0">, </span><span class="hl-5">reopened</span><span class="hl-0">]</span><br/><span class="hl-7">jobs</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">sonarcloud</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">SonarCloud</span><br/><span class="hl-0">    </span><span class="hl-5">runs</span><span class="hl-0">-</span><span class="hl-7">on</span><span class="hl-0">: </span><span class="hl-5">ubuntu</span><span class="hl-0">-</span><span class="hl-5">latest</span><br/><span class="hl-0">    </span><span class="hl-7">steps</span><span class="hl-0">:</span><br/><span class="hl-0">      - </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">checkout</span><span class="hl-0">@</span><span class="hl-5">v3</span><br/><span class="hl-0">        </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">          </span><span class="hl-5">fetch</span><span class="hl-0">-</span><span class="hl-7">depth</span><span class="hl-0">: </span><span class="hl-9">0</span><span class="hl-0">  # </span><span class="hl-5">Shallow</span><span class="hl-0"> </span><span class="hl-5">clones</span><span class="hl-0"> </span><span class="hl-5">should</span><span class="hl-0"> </span><span class="hl-5">be</span><span class="hl-0"> </span><span class="hl-5">disabled</span><span class="hl-0"> </span><span class="hl-5">for</span><span class="hl-0"> </span><span class="hl-5">a</span><span class="hl-0"> </span><span class="hl-5">better</span><span class="hl-0"> </span><span class="hl-5">relevancy</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">analysis</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">SonarCloud</span><span class="hl-0"> </span><span class="hl-5">Scan</span><br/><span class="hl-0">        </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">SonarSource</span><span class="hl-0">/</span><span class="hl-5">sonarcloud</span><span class="hl-0">-</span><span class="hl-5">github</span><span class="hl-0">-</span><span class="hl-5">action</span><span class="hl-0">@</span><span class="hl-5">master</span><br/><span class="hl-0">        </span><span class="hl-7">env</span><span class="hl-0">:</span><br/><span class="hl-0">          </span><span class="hl-7">GITHUB_TOKEN</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">secrets</span><span class="hl-0">.</span><span class="hl-10">GITHUB_TOKEN</span><span class="hl-0"> }}  # </span><span class="hl-5">Needed</span><span class="hl-0"> </span><span class="hl-5">to</span><span class="hl-0"> </span><span class="hl-5">get</span><span class="hl-0"> </span><span class="hl-10">PR</span><span class="hl-0"> </span><span class="hl-5">information</span><span class="hl-0">, </span><span class="hl-6">if</span><span class="hl-0"> </span><span class="hl-5">any</span><br/><span class="hl-0">          </span><span class="hl-7">SONAR_TOKEN</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">secrets</span><span class="hl-0">.</span><span class="hl-10">SONAR_TOKEN</span><span class="hl-0"> }}</span>
</code><button>Copy</button></pre>
<p>Esto lo copiaremos y haremos lo mismo que hicimos anteriormente con las Actions de Tests y Coveralls. Crear un fichero sonarcloud.yml y poner:</p>
<pre><code class="language-typescript"><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Sonar</span><span class="hl-0">-</span><span class="hl-5">Cloud</span><span class="hl-0"> </span><br/><br/><span class="hl-7">on</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">push</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-5">main</span><span class="hl-0"> ]</span><br/><span class="hl-0">  </span><span class="hl-7">pull_request</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">branches</span><span class="hl-0">: [ </span><span class="hl-5">main</span><span class="hl-0"> ]</span><br/><br/><span class="hl-7">jobs</span><span class="hl-0">:</span><br/><span class="hl-0">  </span><span class="hl-7">sonarcloud</span><span class="hl-0">:</span><br/><span class="hl-0">    </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">SonarCloud</span><br/><span class="hl-0">    </span><span class="hl-5">runs</span><span class="hl-0">-</span><span class="hl-7">on</span><span class="hl-0">: </span><span class="hl-5">ubuntu</span><span class="hl-0">-</span><span class="hl-5">latest</span><br/><span class="hl-0">    </span><span class="hl-7">steps</span><span class="hl-0">:</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Cloning</span><span class="hl-0"> </span><span class="hl-5">repo</span><br/><span class="hl-0">        </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">checkout</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">        </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">          </span><span class="hl-5">fetch</span><span class="hl-0">-</span><span class="hl-7">depth</span><span class="hl-0">: </span><span class="hl-9">0</span><span class="hl-0">  # </span><span class="hl-5">Shallow</span><span class="hl-0"> </span><span class="hl-5">clones</span><span class="hl-0"> </span><span class="hl-5">should</span><span class="hl-0"> </span><span class="hl-5">be</span><span class="hl-0"> </span><span class="hl-5">disabled</span><span class="hl-0"> </span><span class="hl-5">for</span><span class="hl-0"> </span><span class="hl-5">a</span><span class="hl-0"> </span><span class="hl-5">better</span><span class="hl-0"> </span><span class="hl-5">relevancy</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">analysis</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Using</span><span class="hl-0"> </span><span class="hl-5">Node</span><span class="hl-0">.</span><span class="hl-5">js</span><span class="hl-0"> 21.</span><span class="hl-5">x</span><br/><span class="hl-0">        </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">actions</span><span class="hl-0">/</span><span class="hl-5">setup</span><span class="hl-0">-</span><span class="hl-5">node</span><span class="hl-0">@</span><span class="hl-5">v4</span><br/><span class="hl-0">        </span><span class="hl-6">with</span><span class="hl-0">:</span><br/><span class="hl-0">          </span><span class="hl-5">node</span><span class="hl-0">-</span><span class="hl-7">version</span><span class="hl-0">: 21.</span><span class="hl-5">x</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Installing</span><span class="hl-0"> </span><span class="hl-5">dependencies</span><br/><span class="hl-0">        </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">ci</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">Generating</span><span class="hl-0"> </span><span class="hl-5">coverage</span><span class="hl-0"> </span><span class="hl-5">report</span><br/><span class="hl-0">        </span><span class="hl-7">run</span><span class="hl-0">: </span><span class="hl-5">npm</span><span class="hl-0"> </span><span class="hl-5">run</span><span class="hl-0"> </span><span class="hl-5">coverage</span><br/><span class="hl-0">      - </span><span class="hl-7">name</span><span class="hl-0">: </span><span class="hl-5">SonarCloud</span><span class="hl-0"> </span><span class="hl-5">Scan</span><br/><span class="hl-0">        </span><span class="hl-7">uses</span><span class="hl-0">: </span><span class="hl-5">SonarSource</span><span class="hl-0">/</span><span class="hl-5">sonarcloud</span><span class="hl-0">-</span><span class="hl-5">github</span><span class="hl-0">-</span><span class="hl-5">action</span><span class="hl-0">@</span><span class="hl-5">master</span><br/><span class="hl-0">        </span><span class="hl-7">env</span><span class="hl-0">:</span><br/><span class="hl-0">          </span><span class="hl-7">GITHUB_TOKEN</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">secrets</span><span class="hl-0">.</span><span class="hl-10">GITHUB_TOKEN</span><span class="hl-0"> }}  # </span><span class="hl-5">Needed</span><span class="hl-0"> </span><span class="hl-5">to</span><span class="hl-0"> </span><span class="hl-5">get</span><span class="hl-0"> </span><span class="hl-10">PR</span><span class="hl-0"> </span><span class="hl-5">information</span><span class="hl-0">, </span><span class="hl-6">if</span><span class="hl-0"> </span><span class="hl-5">any</span><br/><span class="hl-0">          </span><span class="hl-7">SONAR_TOKEN</span><span class="hl-0">: </span><span class="hl-5">$</span><span class="hl-0">{{ </span><span class="hl-5">secrets</span><span class="hl-0">.</span><span class="hl-10">SONAR_TOKEN</span><span class="hl-0"> }}</span>
</code><button>Copy</button></pre>
<p>Para finliazar crearemos en la raíz del directorio un <strong>sonar-project.properties</strong> que tendra:</p>
<pre><code class="language-typescript"><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">projectKey</span><span class="hl-0">=</span><span class="hl-10">ULL</span><span class="hl-0">-</span><span class="hl-10">ESIT</span><span class="hl-0">-</span><span class="hl-10">INF</span><span class="hl-0">-</span><span class="hl-10">DSI</span><span class="hl-0">-2324</span><span class="hl-5">_ull</span><span class="hl-0">-</span><span class="hl-5">esit</span><span class="hl-0">-</span><span class="hl-5">inf</span><span class="hl-0">-</span><span class="hl-5">dsi</span><span class="hl-0">-</span><span class="hl-9">23</span><span class="hl-0">-</span><span class="hl-9">24</span><span class="hl-0">-</span><span class="hl-5">prct09</span><span class="hl-0">-</span><span class="hl-5">filesystem</span><span class="hl-0">-</span><span class="hl-5">magic</span><span class="hl-0">-</span><span class="hl-5">app</span><span class="hl-0">-</span><span class="hl-10">ALBAAPEREZ</span><br/><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">organization</span><span class="hl-0">=</span><span class="hl-5">ull</span><span class="hl-0">-</span><span class="hl-5">esit</span><span class="hl-0">-</span><span class="hl-5">inf</span><span class="hl-0">-</span><span class="hl-5">dsi</span><span class="hl-0">-</span><span class="hl-9">2324</span><br/><br/><span class="hl-0"># </span><span class="hl-5">This</span><span class="hl-0"> </span><span class="hl-5">is</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0"> </span><span class="hl-5">and</span><span class="hl-0"> </span><span class="hl-5">version</span><span class="hl-0"> </span><span class="hl-5">displayed</span><span class="hl-0"> </span><span class="hl-4">in</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">SonarCloud</span><span class="hl-0"> </span><span class="hl-10">UI</span><span class="hl-0">.</span><br/><span class="hl-0">#</span><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">projectName</span><span class="hl-0">=</span><span class="hl-5">ull</span><span class="hl-0">-</span><span class="hl-5">esit</span><span class="hl-0">-</span><span class="hl-5">inf</span><span class="hl-0">-</span><span class="hl-5">dsi</span><span class="hl-0">-</span><span class="hl-9">23</span><span class="hl-0">-</span><span class="hl-9">24</span><span class="hl-0">-</span><span class="hl-5">prct09</span><span class="hl-0">-</span><span class="hl-5">filesystem</span><span class="hl-0">-</span><span class="hl-5">magic</span><span class="hl-0">-</span><span class="hl-5">app</span><span class="hl-0">-</span><span class="hl-10">ALBAAPEREZ</span><br/><span class="hl-0">#</span><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">projectVersion</span><span class="hl-0">=</span><span class="hl-9">1.0</span><br/><br/><br/><span class="hl-0"># </span><span class="hl-5">Path</span><span class="hl-0"> </span><span class="hl-5">is</span><span class="hl-0"> </span><span class="hl-5">relative</span><span class="hl-0"> </span><span class="hl-5">to</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">sonar</span><span class="hl-0">-</span><span class="hl-5">project</span><span class="hl-0">.</span><span class="hl-5">properties</span><span class="hl-0"> </span><span class="hl-5">file</span><span class="hl-0">. </span><span class="hl-5">Replace</span><span class="hl-0"> </span><span class="hl-2">&quot;</span><span class="hl-3">\&quot;</span><span class="hl-2"> by &quot;</span><span class="hl-0">/</span><span class="hl-2">&quot; on Windows</span><span class="hl-11">.</span><br/><span class="hl-0">#</span><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">sources</span><span class="hl-0">=.</span><br/><br/><span class="hl-0"># </span><span class="hl-5">Encoding</span><span class="hl-0"> </span><span class="hl-4">of</span><span class="hl-0"> </span><span class="hl-5">the</span><span class="hl-0"> </span><span class="hl-5">source</span><span class="hl-0"> </span><span class="hl-5">code</span><span class="hl-0">. </span><span class="hl-5">Default</span><span class="hl-0"> </span><span class="hl-5">is</span><span class="hl-0"> </span><span class="hl-6">default</span><span class="hl-0"> </span><span class="hl-5">system</span><span class="hl-0"> </span><span class="hl-5">encoding</span><br/><span class="hl-0">#</span><span class="hl-5">sonar</span><span class="hl-0">.</span><span class="hl-5">sourceEncoding</span><span class="hl-0">=</span><span class="hl-10">UTF</span><span class="hl-0">-</span><span class="hl-9">8</span>
</code><button>Copy</button></pre>
<p>Hecho esto en nuestro repositorio, haremos git add, git commit y un push y si todo ha ido bien comenzará a funcionar todo sin problemas.</p>
<hr>
<a id="md:9-mongodb-y-mongoose" class="tsd-anchor"></a><h1><a href="#md:9-mongodb-y-mongoose">9. Mongodb y Mongoose.</a></h1><a id="md:¿qué-es-mongodb" class="tsd-anchor"></a><h2><a href="#md:¿qué-es-mongodb">¿Qué es Mongodb?</a></h2><p>MongoDB es una base de datos NoSQL que utiliza un modelo de datos basado en documentos. En lugar de utilizar tablas y filas como en las bases de datos relacionales, MongoDB utiliza colecciones y documentos JSON.</p>
<a id="md:operaciones-crud-en-mongodb" class="tsd-anchor"></a><h2><a href="#md:operaciones-crud-en-mongodb">Operaciones CRUD en MongoDB</a></h2><p>Las operaciones CRUD (Crear, Leer, Actualizar, Borrar) son comunes en cualquier sistema de gestión de bases de datos. En MongoDB, estas operaciones se realizan de la siguiente manera:</p>
<ul>
<li><strong>Crear:</strong> Utilizando el método <code>insertOne</code> o <code>insertMany</code> para añadir documentos a una colección.</li>
<li><strong>Leer:</strong> Utilizando métodos como <code>findOne</code> o <code>find</code> para buscar documentos en una colección.</li>
<li><strong>Actualizar:</strong> Utilizando métodos como <code>updateOne</code> o <code>updateMany</code> para modificar documentos existentes.</li>
<li><strong>Borrar:</strong> Utilizando métodos como <code>deleteOne</code> o <code>deleteMany</code> para eliminar documentos de una colección.</li>
</ul>
<a id="md:¿qué-es-mongoose" class="tsd-anchor"></a><h2><a href="#md:¿qué-es-mongoose">¿Qué es Mongoose?</a></h2><p>Mongoose es una biblioteca de modelado de objetos para MongoDB y Node.js. Proporciona una solución basada en esquemas para modelar datos de la aplicación.</p>
<a id="md:características-principales-de-mongoose" class="tsd-anchor"></a><h3><a href="#md:características-principales-de-mongoose">Características principales de Mongoose:</a></h3><ul>
<li>Define modelos con un esquema claro y estructurado.</li>
<li>Proporciona validación de datos.</li>
<li>Permite definir relaciones entre datos.</li>
<li>Ofrece una API sencilla para realizar operaciones CRUD en MongoDB desde Node.js.</li>
</ul>
<a id="md:instalación-1" class="tsd-anchor"></a><h2><a href="#md:instalación-1">Instalación</a></h2><p>El primer paso para utilizar este módulo es instalarlo:</p>
<pre><code class="language-bash"><span class="hl-1">$</span><span class="hl-0"> </span><span class="hl-2">npm</span><span class="hl-0"> </span><span class="hl-2">i</span><span class="hl-0"> </span><span class="hl-2">mongoose</span>
</code><button>Copy</button></pre>
<a id="md:10-ejercicio" class="tsd-anchor"></a><h1><a href="#md:10-ejercicio">10. Ejercicio.</a></h1><a id="md:enunciado-del-ejercicio" class="tsd-anchor"></a><h2><a href="#md:enunciado-del-ejercicio">Enunciado del ejercicio.</a></h2><p> Se solicita la implementación de un API REST para gestionar una tienda de muebles utilizando Node.js y Express. El API permite operaciones CRUD (Create, Read, Update, Delete) para clientes, proveedores, muebles y transacciones, con funcionalidades como la creación de nuevas entidades, consulta por diferentes criterios y manejo de transacciones complejas. El enfoque incluye el uso de MongoDB/MongoDB Atlas como base de datos no relacional y Mongoose para interactuar con la base de datos. El desarrollo del API se complementa con documentación, pruebas y un vídeo explicativo sobre el proceso de desarrollo.</p>
<a id="md:código-propuesto" class="tsd-anchor"></a><h2><a href="#md:código-propuesto">Código propuesto.</a></h2><a id="md:database" class="tsd-anchor"></a><h3><a href="#md:database">Database</a></h3><a id="md:databasets" class="tsd-anchor"></a><h4><a href="#md:databasets">Database.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;mongoose&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Lo que hace este script es conectarse a la base de datos de MongoDB.</span><br/><span class="hl-8">* Si la conexión es exitosa, imprime un mensaje en la consola.</span><br/><span class="hl-8">* Si la conexión falla, imprime el error en la consola.</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-1">connectDB</span><span class="hl-0"> = </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-1">connect</span><span class="hl-0">(</span><span class="hl-2">&#39;mongodb+srv://guillermoplaza:dsi@dsi-groupt-dsikea.czuoep8.mongodb.net/&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-2">&#39;Database connected&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-1">error</span><span class="hl-0">(</span><span class="hl-2">&#39;Database connection error:&#39;</span><span class="hl-0">, </span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-5">error</span><span class="hl-0">;</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Lo que hace este script es cerrar la conexión a la base de datos de MongoDB.</span><br/><span class="hl-8">* Si la conexión se cierra exitosamente, imprime un mensaje en la consola.</span><br/><span class="hl-8">* Si la conexión falla, imprime el error en la consola.</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-1">closeDB</span><span class="hl-0"> = </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> { </span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">connection</span><span class="hl-0">.</span><span class="hl-1">close</span><span class="hl-0">();</span><br/><span class="hl-0">   </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-2">&#39;Database connection closed&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-1">error</span><span class="hl-0">(</span><span class="hl-2">&#39;Error closing database connection:&#39;</span><span class="hl-0">, </span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-5">error</span><span class="hl-0">;</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">};</span>
</code><button>Copy</button></pre>
<a id="md:models" class="tsd-anchor"></a><h3><a href="#md:models">Models</a></h3><a id="md:customerts" class="tsd-anchor"></a><h4><a href="#md:customerts">Customer.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Document</span><span class="hl-0">, </span><span class="hl-5">Schema</span><span class="hl-0">, </span><span class="hl-5">model</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;mongoose&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Genre</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../variables/types.js&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Interfaz para la creación de un objeto Cliente que hereda de Document.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">surname</span><span class="hl-8"> - El apellido del cliente.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">name</span><span class="hl-8"> - El nombre del cliente.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">nif</span><span class="hl-8"> - El NIF del cliente. Debe tener 8 dígitos seguidos de 1 letra.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">genre</span><span class="hl-8"> - El género del cliente. Puede ser &#39;male&#39; (masculino) o &#39;female&#39; (femenino). Este campo es opcional.</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">interface</span><span class="hl-0"> </span><span class="hl-12">CustomerInterface</span><span class="hl-0"> </span><span class="hl-4">extends</span><span class="hl-0"> </span><span class="hl-12">Document</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-5">surname</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">nif</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">genre</span><span class="hl-0">?: </span><span class="hl-12">Genre</span><span class="hl-0">,</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* CustomerSchema define la estructura del documento Cliente en MongoDB.</span><br/><span class="hl-8">* Incluye los siguientes campos:</span><br/><span class="hl-8">* - surname (apellido): Una cadena que se recorta y es obligatoria.</span><br/><span class="hl-8">* - name (nombre): Una cadena que se recorta y es obligatoria.</span><br/><span class="hl-8">* - nif: Una cadena única que se recorta y es obligatoria. Debe tener 8 dígitos seguidos de 1 letra.</span><br/><span class="hl-8">* - genre (género): Una cadena que se recorta, no es obligatoria, y puede ser &#39;male&#39; (masculino) o &#39;female&#39; (femenino). Se convierte a minúsculas.</span><br/><span class="hl-8">*/</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">CustomerSchema</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Schema</span><span class="hl-0">&lt;</span><span class="hl-12">CustomerInterface</span><span class="hl-0">&gt;({</span><br/><span class="hl-0"> </span><span class="hl-5">surname:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">nif:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">unique:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-1">validate</span><span class="hl-5">:</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">expression</span><span class="hl-0"> =</span><span class="hl-13"> /</span><span class="hl-14">\b</span><span class="hl-13">\d</span><span class="hl-15">{8}</span><span class="hl-16">[</span><span class="hl-13">A-Z</span><span class="hl-16">]</span><span class="hl-14">$</span><span class="hl-13">/</span><br/><span class="hl-0">     </span><span class="hl-6">if</span><span class="hl-0">(!</span><span class="hl-5">expression</span><span class="hl-0">.</span><span class="hl-1">test</span><span class="hl-0">(</span><span class="hl-5">value</span><span class="hl-0">)) { </span><br/><span class="hl-0">       </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Error</span><span class="hl-0">(</span><span class="hl-2">&#39;NIF del cliente debe tener 8 dígitos seguidos de 1 letra&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">     }</span><br/><span class="hl-0">   },</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">genre:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">lowercase:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">enum:</span><span class="hl-0"> [</span><span class="hl-2">&#39;male&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;female&#39;</span><span class="hl-0">],</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><br/><span class="hl-0"> },</span><br/><span class="hl-0">}, {</span><br/><span class="hl-0"> </span><span class="hl-5">timestamps:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">// exportamos el modelo Customer</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">Customer</span><span class="hl-0"> = </span><span class="hl-1">model</span><span class="hl-0">&lt;</span><span class="hl-12">CustomerInterface</span><span class="hl-0">&gt;(</span><span class="hl-2">&#39;Customer&#39;</span><span class="hl-0">, </span><span class="hl-5">CustomerSchema</span><span class="hl-0">)</span>
</code><button>Copy</button></pre>
<a id="md:furniturets" class="tsd-anchor"></a><h4><a href="#md:furniturets">Furniture.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Schema</span><span class="hl-0">, </span><span class="hl-5">model</span><span class="hl-0">, </span><span class="hl-5">Document</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;mongoose&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Color</span><span class="hl-0">, </span><span class="hl-5">Material</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../variables/types.js&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Interfaz para la creación de un objeto Mueble que hereda de Document.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">name</span><span class="hl-8"> - El nombre del mueble.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">productCode</span><span class="hl-8"> - El código de producto del mueble.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{Material}</span><span class="hl-8"> </span><span class="hl-5">material</span><span class="hl-8"> - El material del mueble.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">height</span><span class="hl-8"> - La altura del mueble.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">width</span><span class="hl-8"> - La anchura del mueble.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">depth</span><span class="hl-8"> - La profundidad del mueble. Esta es una propiedad opcional.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">warranty</span><span class="hl-8"> - El período de garantía del mueble en años.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{Color}</span><span class="hl-8"> </span><span class="hl-5">color</span><span class="hl-8"> - El color del mueble. Esta es una propiedad opcional.</span><br/><span class="hl-8">* </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">prize</span><span class="hl-8"> - El precio del mueble.</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">interface</span><span class="hl-0"> </span><span class="hl-12">FurnitureInterface</span><span class="hl-0"> </span><span class="hl-4">extends</span><span class="hl-0"> </span><span class="hl-12">Document</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">material</span><span class="hl-0">: </span><span class="hl-12">Material</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">height</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">width</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">depth</span><span class="hl-0">?: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">warranty</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">color</span><span class="hl-0">?: </span><span class="hl-12">Color</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">prize</span><span class="hl-0">: </span><span class="hl-12">number</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* FurnitureSchema define la estructura del documento Mueble en MongoDB.</span><br/><span class="hl-8">* Incluye los siguientes campos:</span><br/><span class="hl-8">* - name (nombre): Una cadena que se recorta y es obligatoria. No puede contener números ni algunos caracteres especiales.</span><br/><span class="hl-8">* - productCode (código de producto): Una cadena que es obligatoria.</span><br/><span class="hl-8">* - material: Un valor de tipo Material que es obligatorio.</span><br/><span class="hl-8">* - height (altura), width (anchura), depth (profundidad): Números que representan las dimensiones del mueble. Depth es opcional.</span><br/><span class="hl-8">* - warranty (garantía): Un número que representa el período de garantía del mueble en años.</span><br/><span class="hl-8">* - color: Un valor de tipo Color que es opcional.</span><br/><span class="hl-8">* - prize (precio): Un número que representa el precio del mueble.</span><br/><span class="hl-8">*/</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">FurnitureSchema</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Schema</span><span class="hl-0">&lt;</span><span class="hl-12">FurnitureInterface</span><span class="hl-0">&gt;({</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-1">validate</span><span class="hl-5">:</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">expression</span><span class="hl-0"> =</span><span class="hl-13"> /</span><span class="hl-14">^</span><span class="hl-16">[</span><span class="hl-13">a-zA-ZÀ-ÿ</span><span class="hl-4">\u00f1\u00d1</span><span class="hl-13">\s.\-&#39;</span><span class="hl-16">]</span><span class="hl-15">+</span><span class="hl-14">$</span><span class="hl-13">/</span><span class="hl-0">;</span><br/><span class="hl-0">     </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">expression</span><span class="hl-0">.</span><span class="hl-1">test</span><span class="hl-0">(</span><span class="hl-5">value</span><span class="hl-0">)) {</span><br/><span class="hl-0">       </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Error</span><span class="hl-0">(</span><span class="hl-2">&quot;El nombre del mueble no puede contener números ni algunos carácteres especiales&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">     }</span><br/><span class="hl-0">   }</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">productCode:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">unique:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">material:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">lowercase:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">enum:</span><span class="hl-0"> [</span><span class="hl-2">&quot;wood&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;metal&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;unpholstery&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;plastic&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;glass&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;stone&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">],</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-2">&quot;other&quot;</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">height:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">max:</span><span class="hl-0"> </span><span class="hl-9">100000</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">width:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">max:</span><span class="hl-0"> </span><span class="hl-9">100000</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">depth:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">max:</span><span class="hl-0"> </span><span class="hl-9">100000</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">warranty:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">max:</span><span class="hl-0"> </span><span class="hl-9">100000</span><br/><span class="hl-0"> }, </span><br/><span class="hl-0"> </span><span class="hl-5">color:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">lowercase:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">enum:</span><span class="hl-0"> [</span><span class="hl-2">&quot;white&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;black&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;blue&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;red&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;yellow&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;green&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;brown&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;gray&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">],</span><br/><span class="hl-0">   </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-2">&quot;other&quot;</span><br/><span class="hl-0"> },</span><br/><span class="hl-0"> </span><span class="hl-5">prize:</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">   </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><span class="hl-0">,</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">}, {</span><br/><span class="hl-0"> </span><span class="hl-5">timestamps:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">Furniture</span><span class="hl-0"> = </span><span class="hl-1">model</span><span class="hl-0">&lt;</span><span class="hl-12">FurnitureInterface</span><span class="hl-0">&gt;(</span><span class="hl-2">&#39;Furniture&#39;</span><span class="hl-0">, </span><span class="hl-5">FurnitureSchema</span><span class="hl-0">);</span>
</code><button>Copy</button></pre>
<a id="md:providerts" class="tsd-anchor"></a><h4><a href="#md:providerts">Provider.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">model</span><span class="hl-0">, </span><span class="hl-5">Schema</span><span class="hl-0">, </span><span class="hl-5">Document</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;mongoose&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">CatergoryType</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../variables/types.js&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Interfaz para la creación de un objeto Proveedor que hereda de Document.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">cif</span><span class="hl-8"> - El Código de Identificación Fiscal del proveedor.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">name</span><span class="hl-8"> - El nombre del proveedor.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-5">address</span><span class="hl-8"> - La dirección del proveedor.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">phone</span><span class="hl-8"> - El número de teléfono del proveedor.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{CatergoryType}</span><span class="hl-8"> </span><span class="hl-5">category</span><span class="hl-8"> - La categoría del proveedor. Puede ser &#39;wood&#39;, &#39;upholstered&#39;, &#39;office&#39;, &#39;outdoor&#39;, &#39;antique&#39;, &#39;kids&#39;, &#39;custom&#39; u &#39;other&#39;. Este campo es opcional.</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">interface</span><span class="hl-0"> </span><span class="hl-12">ProviderInterface</span><span class="hl-0"> </span><span class="hl-4">extends</span><span class="hl-0"> </span><span class="hl-12">Document</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-5">cif</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">name</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">address</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">phone</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">category</span><span class="hl-0">?: </span><span class="hl-12">CatergoryType</span><span class="hl-0">,</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * ProviderSchema define la estructura del documento Proveedor en MongoDB.</span><br/><span class="hl-8"> * Incluye los siguientes campos:</span><br/><span class="hl-8"> * - cif: Una cadena que se recorta y es obligatoria. Debe tener 8 dígitos seguidos de 1 letra.</span><br/><span class="hl-8"> * - name (nombre): Una cadena que se recorta y es obligatoria. No puede contener números ni algunos caracteres especiales.</span><br/><span class="hl-8"> * - address (dirección): Una cadena que se recorta y es obligatoria.</span><br/><span class="hl-8"> * - phone (teléfono): Un número que representa el número de teléfono del proveedor.</span><br/><span class="hl-8"> * - category (categoría): Una cadena que se convierte a minúsculas, no es obligatoria, y puede ser &#39;wood&#39;, &#39;upholstered&#39;, &#39;office&#39;, &#39;outdoor&#39;, &#39;antique&#39;, &#39;kids&#39;, &#39;custom&#39; u &#39;other&#39;.</span><br/><span class="hl-8"> * </span><span class="hl-4">@constant</span><span class="hl-8"> </span><span class="hl-12">{Schema&lt;ProviderInterface&gt;}</span><span class="hl-8"> </span><span class="hl-5">ProviderSchema</span><span class="hl-8"> - El esquema de la colección de proveedores.</span><br/><span class="hl-8"> * </span><span class="hl-4">@constant</span><span class="hl-8"> </span><span class="hl-12">{Model&lt;ProviderInterface&gt;}</span><span class="hl-8"> </span><span class="hl-5">Provider</span><span class="hl-8"> - El modelo de la colección de proveedores.</span><br/><span class="hl-8"> */</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">ProviderSchema</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Schema</span><span class="hl-0">&lt;</span><span class="hl-12">ProviderInterface</span><span class="hl-0">&gt;({</span><br/><span class="hl-0">  </span><span class="hl-5">cif:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">unique:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-1">validate</span><span class="hl-5">:</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">regexCIF</span><span class="hl-0"> =</span><span class="hl-13"> /</span><span class="hl-14">^</span><span class="hl-16">[</span><span class="hl-13">A-HJNPQRSUVW</span><span class="hl-16">]</span><span class="hl-15">{1}</span><span class="hl-16">[</span><span class="hl-13">0-9</span><span class="hl-16">]</span><span class="hl-15">{7}</span><span class="hl-16">[</span><span class="hl-13">0-9A-J</span><span class="hl-16">]</span><span class="hl-14">$</span><span class="hl-13">/</span><span class="hl-4">i</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-6">if</span><span class="hl-0">(!</span><span class="hl-5">regexCIF</span><span class="hl-0">.</span><span class="hl-1">test</span><span class="hl-0">(</span><span class="hl-5">value</span><span class="hl-0">)) {</span><br/><span class="hl-0">        </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Error</span><span class="hl-0">(</span><span class="hl-2">&quot;El Código de Identificación Fiscal no es válido&quot;</span><span class="hl-0">)</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">name:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-1">validate</span><span class="hl-5">:</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">expression</span><span class="hl-0"> =</span><span class="hl-13"> /</span><span class="hl-14">^</span><span class="hl-16">[</span><span class="hl-13">a-zA-ZÀ-ÿ</span><span class="hl-4">\u00f1\u00d1</span><span class="hl-13">\s.\-&#39;</span><span class="hl-16">]</span><span class="hl-15">+</span><span class="hl-14">$</span><span class="hl-13">/</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">expression</span><span class="hl-0">.</span><span class="hl-1">test</span><span class="hl-0">(</span><span class="hl-5">value</span><span class="hl-0">)) {</span><br/><span class="hl-0">        </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Error</span><span class="hl-0">(</span><span class="hl-2">&quot;El nombre del proveedor no puede contener números ni algunos carácteres especiales&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">address:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">phone:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-1">validate</span><span class="hl-5">:</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">value</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">().</span><span class="hl-5">length</span><span class="hl-0"> !== </span><span class="hl-9">9</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-6">throw</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Error</span><span class="hl-0">(</span><span class="hl-2">&quot;Número de teléfono válido&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">category:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">lowercase:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">enum:</span><span class="hl-0"> [</span><span class="hl-2">&quot;wood&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;upholstered&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;office&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;outdoor&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;antique&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;kids&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;custom&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">],</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-2">&quot;other&quot;</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}, {</span><br/><span class="hl-0">  </span><span class="hl-5">timestamps:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * exportamos el modelo Provider</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">Provider</span><span class="hl-0"> = </span><span class="hl-1">model</span><span class="hl-0">&lt;</span><span class="hl-12">ProviderInterface</span><span class="hl-0">&gt;(</span><span class="hl-2">&#39;Provider&#39;</span><span class="hl-0">, </span><span class="hl-5">ProviderSchema</span><span class="hl-0">)</span>
</code><button>Copy</button></pre>
<a id="md:transactionsts" class="tsd-anchor"></a><h4><a href="#md:transactionsts">Transactions.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">model</span><span class="hl-0">, </span><span class="hl-5">Schema</span><span class="hl-0">, </span><span class="hl-5">Document</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;mongoose&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">TransactionType</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../variables/types.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">ProviderInterface</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;./providers.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">FurnitureInterface</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;./furnitures.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">CustomerInterface</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;./customers.js&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Interfaz para la creación de un objeto Transacción que hereda de Document.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{TransactionType}</span><span class="hl-8"> </span><span class="hl-5">type</span><span class="hl-8"> - El tipo de transacción. Puede ser &#39;sell&#39; (venta) o &#39;purchase&#39; (compra). Este campo es opcional.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{number}</span><span class="hl-8"> </span><span class="hl-5">moneyAmount</span><span class="hl-8"> - La cantidad de dinero de la transacción.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{FurnitureInterface}</span><span class="hl-8"> </span><span class="hl-5">furnitureID</span><span class="hl-8"> - El ID del mueble</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{ProviderInterface}</span><span class="hl-8"> </span><span class="hl-5">providerID</span><span class="hl-8"> - El ID del proveedor. Este campo es opcional.</span><br/><span class="hl-8"> * </span><span class="hl-4">@property</span><span class="hl-8"> </span><span class="hl-12">{CustomerInterface}</span><span class="hl-8"> </span><span class="hl-5">customerID</span><span class="hl-8"> - El ID del cliente. Este campo es opcional.</span><br/><span class="hl-8"> */</span><br/><span class="hl-4">interface</span><span class="hl-0"> </span><span class="hl-12">TransactionInterface</span><span class="hl-0"> </span><span class="hl-4">extends</span><span class="hl-0"> </span><span class="hl-12">Document</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-5">type</span><span class="hl-0">: </span><span class="hl-12">TransactionType</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">productCode</span><span class="hl-0">: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">providerCIF</span><span class="hl-0">?: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">customerNIF</span><span class="hl-0">?: </span><span class="hl-12">string</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">moneyAmount</span><span class="hl-0">: </span><span class="hl-12">number</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">furnitureID</span><span class="hl-0">: </span><span class="hl-12">FurnitureInterface</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">providerID</span><span class="hl-0">?: </span><span class="hl-12">ProviderInterface</span><span class="hl-0">,</span><br/><span class="hl-0">  </span><span class="hl-5">customerID</span><span class="hl-0">?: </span><span class="hl-12">CustomerInterface</span><br/><span class="hl-0">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * TransactionSchema define la estructura del documento Transacción en MongoDB.</span><br/><span class="hl-8"> * Incluye los siguientes campos:</span><br/><span class="hl-8"> * - type (tipo): Una cadena que se recorta, no es obligatoria, y puede ser &#39;sell&#39; (venta) o &#39;purchase&#39; (compra).</span><br/><span class="hl-8"> * - moneyAmount (cantidad de dinero): Un número que debe ser mayor o igual a 0.</span><br/><span class="hl-8"> * - furnitureID (ID del mueble): Un ObjectId que es obligatorio y hace referencia a un documento Mueble.</span><br/><span class="hl-8"> * - providerID (ID del proveedor): Un ObjectId que es opcional y hace referencia a un documento Proveedor.</span><br/><span class="hl-8"> * - customerID (ID del cliente): Un ObjectId que es opcional y hace referencia a un documento Cliente.</span><br/><span class="hl-8"> */</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">TransactionSchema</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Schema</span><span class="hl-0">&lt;</span><span class="hl-12">TransactionInterface</span><span class="hl-0">&gt;({</span><br/><span class="hl-0">  </span><span class="hl-5">type:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">enum:</span><span class="hl-0"> [</span><span class="hl-2">&quot;sell&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;purchase&quot;</span><span class="hl-0">],</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">productCode:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">providerCIF:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">customerNIF:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">String</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">trim:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Number</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">min:</span><span class="hl-0"> </span><span class="hl-9">0</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">furnitureID:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Schema</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-5">ObjectId</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">true</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">ref:</span><span class="hl-0"> </span><span class="hl-2">&#39;Furniture&#39;</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">providerID:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Schema</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-5">ObjectId</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">ref:</span><span class="hl-0"> </span><span class="hl-2">&#39;Provider&#39;</span><br/><span class="hl-0">  },</span><br/><span class="hl-0">  </span><span class="hl-5">customerID:</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">Schema</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-5">ObjectId</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">required:</span><span class="hl-0"> </span><span class="hl-4">false</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">default:</span><span class="hl-0"> </span><span class="hl-4">undefined</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-5">ref:</span><span class="hl-0"> </span><span class="hl-2">&#39;Customer&#39;</span><br/><span class="hl-0">  }</span><br/><br/><span class="hl-0">}, {</span><br/><span class="hl-0">  </span><span class="hl-5">timestamps:</span><span class="hl-0"> </span><span class="hl-4">true</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Exportamos el modelo Transaction.</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">Transaction</span><span class="hl-0"> = </span><span class="hl-1">model</span><span class="hl-0">&lt;</span><span class="hl-12">TransactionInterface</span><span class="hl-0">&gt;(</span><span class="hl-2">&#39;Transaction&#39;</span><span class="hl-0">, </span><span class="hl-5">TransactionSchema</span><span class="hl-0">);</span>
</code><button>Copy</button></pre>
<a id="md:routers" class="tsd-anchor"></a><h3><a href="#md:routers">Routers</a></h3><a id="md:customerts-1" class="tsd-anchor"></a><h4><a href="#md:customerts-1">Customer.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Customer</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/customers.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customerRouter</span><span class="hl-0"> = </span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">Router</span><span class="hl-0">()</span><br/><br/><span class="hl-8">// __________________________________________________________________POST__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta POST para &#39;/customers&#39;. Crea un nuevo cliente en la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos del cliente a crear.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente creado con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Customer</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">customer</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// ___________________________________________________________________GET__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/customers&#39;. Obtiene uno o más clientes de la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta puede contener un NIF para filtrar los clientes.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve los clientes encontrados en caso de éxito, un error con un estado 404 si no se encontró ningún cliente con el NIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">filter</span><span class="hl-0"> = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0">? {</span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">()} : {};</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customers</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">find</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encontró ningún cliente con el NIF proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customers</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0"> !== </span><span class="hl-9">0</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customers</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer NIF not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/customers/:id&#39;. Obtiene un cliente específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. Los parámetros deben contener el ID del cliente a obtener.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente encontrado en caso de éxito, un error con un estado 404 si no se encontró ningún cliente con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">id</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">;</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer ID not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">// __________________________________________________________________PATCH_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/customers&#39;. Actualiza un cliente específico en la base de datos utilizando su NIF.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta debe contener el NIF del cliente a actualizar y el cuerpo de la solicitud debe contener los campos a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente actualizado en caso de éxito, un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encontró ningún cliente con el NIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// constantes para validar las actualizaciones permitidas</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;surname&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;genre&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la actualización solicitada no es válida</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Busca y actualiza el cliente según el NIF proporcionado en la consulta</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findOneAndUpdate</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">nif</span><br/><span class="hl-0">    }, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// Devuelve el cliente actualizado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-8">// Si no se encuentra el cliente, devuelve un error</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer NIF not found&quot;</span><span class="hl-0"> }); </span><br/><span class="hl-0">  </span><span class="hl-8">// Si hay un error interno del servidor, devuelve el error</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/customers/:id&#39;. Actualiza un cliente específico en la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. Los parámetros deben contener el ID del cliente a actualizar y el cuerpo de la solicitud debe contener los campos a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente actualizado en caso de éxito, un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encontró ningún cliente con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// constantes para validar las actualizaciones permitidas</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;surname&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;genre&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la actualización solicitada no es válida</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findByIdAndUpdate</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encuentra el cliente, devuelve el cliente actualizado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encuentra el cliente, devuelve un error</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer ID not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }  </span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________DELETE_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/customers&#39;. Elimina un cliente específico de la base de datos utilizando su NIF.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta debe contener el NIF del cliente a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún cliente con el NIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findOneAndDelete</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">nif</span><br/><span class="hl-0">    });</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encuentra el cliente, devuelve el cliente eliminado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer NIF not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/customers/:id&#39;. Elimina un cliente específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. Los parámetros deben contener el ID del cliente a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el cliente eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún cliente con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">customerRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findByIdAndDelete</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer ID not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:defaultsts" class="tsd-anchor"></a><h4><a href="#md:defaultsts">Defaults.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">defaultRouter</span><span class="hl-0"> = </span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">Router</span><span class="hl-0">();</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta por defecto para cualquier petición HTTP no soportada.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">_</span><span class="hl-8"> - La solicitud HTTP.</span><br/><span class="hl-8"> * Se encarga de devolver un estado 501 en caso de que la petición no sea soportada.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">defaultRouter</span><span class="hl-0">.</span><span class="hl-1">all</span><span class="hl-0">(</span><span class="hl-2">&#39;*&#39;</span><span class="hl-0">, (</span><span class="hl-5">_</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">501</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/>
</code><button>Copy</button></pre>
<a id="md:furniturets-1" class="tsd-anchor"></a><h4><a href="#md:furniturets-1">Furniture.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Furniture</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/furnitures.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furnitureRouter</span><span class="hl-0"> = </span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">Router</span><span class="hl-0">()</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________POST__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta POST para &#39;/furnitures&#39;. Crea un nuevo mueble en la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos del mueble a crear.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble creado con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-8">// lo que hace es crear un nuevo objeto de la clase Furniture con los datos que vienen en el cuerpo de la solicitud</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// ___________________________________________________________________GET__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/furnitures&#39;. Obtiene uno o más muebles de la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta puede contener un nombre, material, altura, anchura, profundidad, garantía, color o precio para filtrar los muebles.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve los muebles encontrados en caso de éxito, un error con un estado 404 si no se encontró ningún mueble con los filtros proporcionados, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// constante que almacena los valores de la consulta</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">name</span><span class="hl-0">, </span><span class="hl-10">material</span><span class="hl-0">, </span><span class="hl-10">height</span><span class="hl-0">, </span><span class="hl-10">width</span><span class="hl-0">, </span><span class="hl-10">depth</span><span class="hl-0">, </span><span class="hl-10">warranty</span><span class="hl-0">, </span><span class="hl-10">color</span><span class="hl-0">, </span><span class="hl-10">prize</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0">  </span><span class="hl-8">// si no se proporciona ningún filtro, se devuelven todos los muebles</span><br/><span class="hl-0">  </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">name</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">material</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-5">material</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">height</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-5">height</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">width</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-5">width</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">depth</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">depth:</span><span class="hl-0"> </span><span class="hl-5">depth</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">warranty</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-5">warranty</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">color</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">color:</span><span class="hl-0"> </span><span class="hl-5">color</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">prize</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-5">prize</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furnitures</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">find</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encontró ningún mueble con los filtros proporcionados</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furnitures</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0"> !== </span><span class="hl-9">0</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furnitures</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/furnitures/:id&#39;. Obtiene un mueble específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. Los parámetros deben contener el ID del mueble a obtener.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble encontrado en caso de éxito, un error con un estado 404 si no se encontró ningún mueble con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">id</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">;</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encontró ningún mueble con el ID proporcionado retorna un error</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture ID not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">// __________________________________________________________________PATCH_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/furnitures&#39;. Actualiza un mueble específico en la base de datos utilizando su código de producto.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos del mueble a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble actualizado en caso de éxito, un error con un estado 404 si no se encontró ningún mueble con el código de producto proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// constante que almacena los valores de la consulta</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">name</span><span class="hl-0">, </span><span class="hl-10">material</span><span class="hl-0">, </span><span class="hl-10">height</span><span class="hl-0">, </span><span class="hl-10">width</span><span class="hl-0">, </span><span class="hl-10">depth</span><span class="hl-0">, </span><span class="hl-10">warranty</span><span class="hl-0">, </span><span class="hl-10">color</span><span class="hl-0">, </span><span class="hl-10">prize</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0">  </span><span class="hl-8">// si no se proporciona ningún filtro, se devuelven todos los muebles</span><br/><span class="hl-0">  </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">name</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">material</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-5">material</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">height</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-5">height</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">width</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-5">width</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">depth</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">depth:</span><span class="hl-0"> </span><span class="hl-5">depth</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">warranty</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-5">warranty</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">color</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">color:</span><span class="hl-0"> </span><span class="hl-5">color</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">prize</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-5">prize</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Constantes para validar los campos que se pueden actualizar</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;material&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;width&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;height&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;depth&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;color&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;prize&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;warranty&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la solicitud no es válida, se devuelve un error</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">updateMany</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró el mueble y se actualizó correctamente, se devuelve el mueble actualizado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/furnitures/:id&#39;. Actualiza un mueble específico en la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los campos a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble actualizado en caso de éxito, un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encontró ningún mueble con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// cosntantes para validar los campos que se pueden actualizar</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;material&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;width&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;height&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;depth&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;color&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;prize&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;warranty&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la solicitud no es válida, se devuelve un error</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">findByIdAndUpdate</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró el mueble y se actualizó correctamente, se devuelve el mueble actualizado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture ID not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }  </span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________DELETE_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/furnitures&#39;. Elimina un mueble específico de la base de datos utilizando su código de producto.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta debe contener el código de producto del mueble a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún mueble con el código de producto proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// constante que almacena los valores de la consulta</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">name</span><span class="hl-0">, </span><span class="hl-10">material</span><span class="hl-0">, </span><span class="hl-10">height</span><span class="hl-0">, </span><span class="hl-10">width</span><span class="hl-0">, </span><span class="hl-10">depth</span><span class="hl-0">, </span><span class="hl-10">warranty</span><span class="hl-0">, </span><span class="hl-10">color</span><span class="hl-0">, </span><span class="hl-10">prize</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0">  </span><span class="hl-8">// si no se proporciona ningún filtro, se devuelven todos los muebles</span><br/><span class="hl-0">  </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">name</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">material</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-5">material</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">height</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-5">height</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">width</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-5">width</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">depth</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">depth:</span><span class="hl-0"> </span><span class="hl-5">depth</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">warranty</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-5">warranty</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">color</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">color:</span><span class="hl-0"> </span><span class="hl-5">color</span><span class="hl-0"> }};</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">prize</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-5">prize</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró el mueble y se eliminó correctamente, se devuelve el mueble eliminado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/furnitures/:id&#39;. Elimina un mueble específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. Los parámetros deben contener el ID del mueble a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el mueble eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún mueble con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">furnitureRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">findByIdAndDelete</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró el mueble y se eliminó correctamente, se devuelve el mueble eliminado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Furniture ID not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:providerts-1" class="tsd-anchor"></a><h4><a href="#md:providerts-1">Provider.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Provider</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/providers.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">providerRouter</span><span class="hl-0"> = </span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">Router</span><span class="hl-0">()</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________POST__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta POST para &#39;/providers&#39;. Crea un nuevo proveedor en la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos del proveedor a crear.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor creado con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Provider</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-8">// Lo que hace es crear un nuevo objeto de la clase Provider con los datos que vienen en el cuerpo de la solicitud</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// ___________________________________________________________________GET__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/providers&#39;. Obtiene uno o más proveedores de la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta puede contener un CIF para filtrar los proveedores.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve los proveedores encontrados en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">filter</span><span class="hl-0"> = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">cif</span><span class="hl-0">? {</span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">cif</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">()} : {};</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">providers</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">find</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encontró ningún proveedor con el CIF proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">providers</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0"> !== </span><span class="hl-9">0</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider cif not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta GET para &#39;/providers/:id&#39;. Obtiene un proveedor específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del proveedor a buscar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor encontrado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">id</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">;</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si no se encontró ningún proveedor con el ID proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider ID not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">// __________________________________________________________________PATCH_________________________________________________________________</span><br/><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/providers&#39;. Actualiza uno o más proveedores de la base de datos.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor actualizado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// constantes  que almacenan los valores permitidos para actualizar</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;cif&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;address&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;phone&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;category&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la solicitud no es válida, se devuelve un error</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// se busca un proveedor por su CIF y se actualizan los datos</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findOneAndUpdate</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">cif</span><br/><span class="hl-0">    }, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró un proveedor con el CIF proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider cif not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  } </span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta PATCH para &#39;/providers/:id&#39;. Actualiza un proveedor específico en la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del proveedor a actualizar. El cuerpo de la solicitud debe contener los datos a actualizar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor actualizado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// constantes para validar los campos que se pueden actualizar</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;cif&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;name&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;address&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;phone&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;category&quot;</span><span class="hl-0">];</span><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><br/><span class="hl-0">  </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-8">// si la solicitud no es válida, se devuelve un error</span><br/><span class="hl-0">  </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findByIdAndUpdate</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró un proveedor con el ID proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider ID not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0">  }  </span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________DELETE_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/providers&#39;. Elimina un proveedor de la base de datos utilizando su CIF.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta debe contener el CIF del proveedor a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findOneAndDelete</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">cif</span><br/><span class="hl-0">    });</span><br/><span class="hl-0">    </span><span class="hl-8">// si se encontró un proveedor con el CIF proporcionado</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider cif not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Ruta DELETE para &#39;/providers/:id&#39;. Elimina un proveedor específico de la base de datos utilizando su ID.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del proveedor a eliminar.</span><br/><span class="hl-8"> * </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el proveedor eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8"> * </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">providerRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findByIdAndDelete</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// si el proveedor con el ID proporcionado no se encontró</span><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider ID not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">  } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:transactionsts-1" class="tsd-anchor"></a><h4><a href="#md:transactionsts-1">Transactions.ts</a></h4><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Transaction</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../models/transactions.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Furniture</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/furnitures.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Provider</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/providers.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Customer</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../models/customers.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transactionRouter</span><span class="hl-0"> = </span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">Router</span><span class="hl-0">()</span><br/><br/><span class="hl-8">// __________________________________________________________________POST__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta POST para &#39;/transactions</span><br/><span class="hl-8">*&#39;. Crea una nueva transacción en la base de datos.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos del transacción a crear.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción creado con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> { </span><br/><span class="hl-0">     </span><span class="hl-10">providerCIF</span><span class="hl-0">, </span><br/><span class="hl-0">     </span><span class="hl-10">customerNIF</span><span class="hl-0">, </span><br/><span class="hl-0">     </span><span class="hl-10">type</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-8">// También si no está creado deberemos introducir los datos para crear el mueble</span><br/><span class="hl-0">     </span><span class="hl-10">name</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">productCode</span><span class="hl-0">, </span><br/><span class="hl-0">     </span><span class="hl-10">material</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">height</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">width</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">depth</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">warranty</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-10">color</span><span class="hl-0">,</span><br/><span class="hl-0">    } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">;</span><br/><br/><span class="hl-0">   </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">findOne</span><span class="hl-0">({ </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0"> });</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">furniture</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-8">// si no ha encontrado ningún mueble con el productCode, crea uno nuevo con los datos introducidos</span><br/><span class="hl-0">     </span><span class="hl-5">furniture</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">       </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-5">name</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-5">material</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-5">height</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-5">width</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">depth:</span><span class="hl-0"> </span><span class="hl-5">depth</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-5">warranty</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">color:</span><span class="hl-0"> </span><span class="hl-5">color</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><br/><span class="hl-0">     })</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">()</span><br/><span class="hl-0">   }</span><br/><br/><span class="hl-0">   </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">entityID</span><span class="hl-0">;</span><br/><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">providerCIF</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findOne</span><span class="hl-0">({ </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-5">providerCIF</span><span class="hl-0"> });</span><br/><span class="hl-0">     </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">provider</span><span class="hl-0">) {</span><br/><span class="hl-0">       </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Provider not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">     }</span><br/><span class="hl-0">     </span><span class="hl-5">entityID</span><span class="hl-0"> = </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">;</span><br/><span class="hl-0">   } </span><span class="hl-6">else</span><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customerNIF</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findOne</span><span class="hl-0">({ </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-5">customerNIF</span><span class="hl-0"> });</span><br/><span class="hl-0">     </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">customer</span><span class="hl-0">) {</span><br/><span class="hl-0">       </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Customer not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">     }</span><br/><span class="hl-0">     </span><span class="hl-5">entityID</span><span class="hl-0"> = </span><span class="hl-5">customer</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">;</span><br/><span class="hl-0">   } </span><span class="hl-6">else</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Must insert a customer nif or a provider cif&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0">   }</span><br/><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Transaction</span><span class="hl-0">({</span><br/><span class="hl-0">     ...</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">providerID:</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">() === </span><span class="hl-2">&#39;purchase&#39;</span><span class="hl-0"> ? </span><span class="hl-5">entityID</span><span class="hl-0"> : </span><span class="hl-4">undefined</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">customerID:</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">() === </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0"> ? </span><span class="hl-5">entityID</span><span class="hl-0"> : </span><span class="hl-4">undefined</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-1">populate</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">path:</span><span class="hl-0"> </span><span class="hl-2">&#39;furnitureID&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">select:</span><span class="hl-0"> [</span><span class="hl-2">&#39;name&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;material&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;height&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;width&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;depth&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;warranty&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;color&#39;</span><span class="hl-0">]</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">type</span><span class="hl-0"> === </span><span class="hl-2">&#39;purchase&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-1">populate</span><span class="hl-0">({</span><br/><span class="hl-0">       </span><span class="hl-5">path:</span><span class="hl-0"> </span><span class="hl-2">&#39;providerID&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">select:</span><span class="hl-0"> [</span><span class="hl-2">&#39;cif&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;name&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;address&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;phone&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;category&#39;</span><span class="hl-0">]</span><br/><span class="hl-0">     });</span><br/><span class="hl-0">   } </span><span class="hl-6">else</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-1">populate</span><span class="hl-0">({</span><br/><span class="hl-0">       </span><span class="hl-5">path:</span><span class="hl-0"> </span><span class="hl-2">&#39;customerID&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-5">select:</span><span class="hl-0"> [</span><span class="hl-2">&#39;surname&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;name&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;nif&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;genre&#39;</span><span class="hl-0">]</span><br/><span class="hl-0">     });</span><br/><span class="hl-0">   }</span><br/><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0"> }</span><br/><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// ___________________________________________________________________GET__________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta GET para &#39;/transactions</span><br/><span class="hl-8">*&#39;. Obtiene una o más transacciones de la base de datos.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta puede contener un CIF para filtrar los transacciones.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve los transacciones encontrados en caso de éxito, un error con un estado 404 si no se encontró ningún transacción con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">type</span><span class="hl-0">, </span><span class="hl-10">productCode</span><span class="hl-0">, </span><span class="hl-10">customerNIF</span><span class="hl-0">, </span><span class="hl-10">providerCIF</span><span class="hl-0">, </span><span class="hl-10">moneyAmount</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0"> </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">type</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">productCode</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customerNIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">customerNIF:</span><span class="hl-0"> </span><span class="hl-5">customerNIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">providerCIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">providerCIF:</span><span class="hl-0"> </span><span class="hl-5">providerCIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">moneyAmount</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-5">moneyAmount</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transactions</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">find</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// si no se encontró ningún transacción con el CIF proporcionado</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transactions</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0"> !== </span><span class="hl-9">0</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transactions</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction cif not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta GET para &#39;/transactions</span><br/><span class="hl-8">*:id&#39;. Obtiene un transacción específico de la base de datos utilizando su ID.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del transacción a buscar.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción encontrado en caso de éxito, un error con un estado 404 si no se encontró ningún transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">id</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">;</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// si no se encontró ninguna transacción con el ID proporcionado</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transaction</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction ID not found&quot;</span><span class="hl-0">});</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">// __________________________________________________________________PATCH_________________________________________________________________</span><br/><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta PATCH para &#39;/transactions</span><br/><span class="hl-8">*&#39;. Actualiza una o más transacciones de la base de datos.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El cuerpo de la solicitud debe contener los datos a actualizar.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción actualizada en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">type</span><span class="hl-0">, </span><span class="hl-10">productCode</span><span class="hl-0">, </span><span class="hl-10">customerNIF</span><span class="hl-0">, </span><span class="hl-10">providerCIF</span><span class="hl-0">, </span><span class="hl-10">moneyAmount</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0"> </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">type</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">productCode</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customerNIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">customerNIF:</span><span class="hl-0"> </span><span class="hl-5">customerNIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">providerCIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">providerCIF:</span><span class="hl-0"> </span><span class="hl-5">providerCIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">moneyAmount</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-5">moneyAmount</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;type&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;productCode&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;providerCIF&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;customerNIF&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;moneyAmount&quot;</span><span class="hl-0">];</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0"> }</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">updateMany</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transaction</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0"> } </span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta PATCH para &#39;/transactions</span><br/><span class="hl-8">*:id&#39;. Actualiza un transacción específico en la base de datos utilizando su ID.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del transacción a actualizar. El cuerpo de la solicitud debe contener los datos a actualizar.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción actualizada en caso de éxito, un error con un estado 404 si no se encontró ningún transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">allowedUpdates</span><span class="hl-0"> = [</span><span class="hl-2">&quot;type&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;productCode&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;providerCIF&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;customerNIF&quot;</span><span class="hl-0">, </span><span class="hl-2">&quot;moneyAmount&quot;</span><span class="hl-0">];</span><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">requestedUpdates</span><span class="hl-0"> = </span><span class="hl-5">Object</span><span class="hl-0">.</span><span class="hl-1">keys</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">);</span><br/><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">isValidrequest</span><span class="hl-0"> = </span><span class="hl-5">requestedUpdates</span><span class="hl-0">.</span><span class="hl-1">every</span><span class="hl-0">((</span><span class="hl-5">data</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-5">allowedUpdates</span><span class="hl-0">.</span><span class="hl-1">includes</span><span class="hl-0">(</span><span class="hl-5">data</span><span class="hl-0">));</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-5">isValidrequest</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Invalid update&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0"> }</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">findByIdAndUpdate</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">, </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0"> )</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transaction</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction ID not found&quot;</span><span class="hl-0"> }); </span><br/><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">);</span><br/><span class="hl-0"> }  </span><br/><span class="hl-0">});</span><br/><br/><br/><span class="hl-8">// __________________________________________________________________DELETE_________________________________________________________________</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta DELETE para &#39;/transactions</span><br/><span class="hl-8">*&#39;. Elimina un transacción de la base de datos utilizando su CIF.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. La consulta debe contener el CIF del transacción a eliminar.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún transacción con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><br/><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> { </span><span class="hl-10">type</span><span class="hl-0">, </span><span class="hl-10">productCode</span><span class="hl-0">, </span><span class="hl-10">customerNIF</span><span class="hl-0">, </span><span class="hl-10">providerCIF</span><span class="hl-0">, </span><span class="hl-10">moneyAmount</span><span class="hl-0"> } = </span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">query</span><br/><span class="hl-0"> </span><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-5">filter</span><span class="hl-0"> = {}</span><br/><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">type</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">productCode</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-5">productCode</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">customerNIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">customerNIF:</span><span class="hl-0"> </span><span class="hl-5">customerNIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">providerCIF</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">providerCIF:</span><span class="hl-0"> </span><span class="hl-5">providerCIF</span><span class="hl-0"> }};</span><br/><span class="hl-0"> </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">moneyAmount</span><span class="hl-0">) </span><span class="hl-5">filter</span><span class="hl-0"> = {...</span><span class="hl-5">filter</span><span class="hl-0">, ...{ </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-5">moneyAmount</span><span class="hl-0"> }};</span><br/><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">(</span><span class="hl-5">filter</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transaction</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction cif not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0"> }</span><br/><br/><span class="hl-0">})</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Ruta DELETE para &#39;/transactions</span><br/><span class="hl-8">*:id&#39;. Elimina un transacción específica de la base de datos utilizando su ID.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Request}</span><span class="hl-8"> </span><span class="hl-5">req</span><span class="hl-8"> - La solicitud HTTP. El parámetro de la ruta debe contener el ID del transacción a eliminar.</span><br/><span class="hl-8">* </span><span class="hl-4">@param</span><span class="hl-8"> </span><span class="hl-12">{Response}</span><span class="hl-8"> </span><span class="hl-5">res</span><span class="hl-8"> - La respuesta HTTP. Devuelve el transacción eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</span><br/><span class="hl-8">* </span><span class="hl-4">@returns</span><span class="hl-8"> </span><span class="hl-12">{Promise&lt;Response&gt;}</span><span class="hl-8"> Una promesa que resuelve a una respuesta HTTP.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">transactionRouter</span><span class="hl-0">.</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions/:id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">req</span><span class="hl-0">, </span><span class="hl-5">res</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">findByIdAndDelete</span><span class="hl-0">(</span><span class="hl-5">req</span><span class="hl-0">.</span><span class="hl-5">params</span><span class="hl-0">.</span><span class="hl-5">id</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-5">transaction</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">Error:</span><span class="hl-0"> </span><span class="hl-2">&quot;Transaction ID not found&quot;</span><span class="hl-0"> });</span><br/><span class="hl-0"> } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">error</span><span class="hl-0">) {</span><br/><span class="hl-0">   </span><span class="hl-6">return</span><span class="hl-0"> </span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-1">status</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><span class="hl-0"> }</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:variables" class="tsd-anchor"></a><h3><a href="#md:variables">Variables</a></h3><a id="md:typests" class="tsd-anchor"></a><h4><a href="#md:typests">Types.ts</a></h4><pre><code class="language-typescript"><span class="hl-8">/**</span><br/><span class="hl-8">* Tipo de dato para el género de una persona</span><br/><span class="hl-8">* Puede ser femenino, masculino o undefined</span><br/><span class="hl-8">* </span><span class="hl-4">@typedef</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-12">Genre</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">type</span><span class="hl-0"> </span><span class="hl-12">Genre</span><span class="hl-0"> = </span><span class="hl-2">&quot;male&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;female&quot;</span><span class="hl-0"> | </span><span class="hl-12">undefined</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Tipo de dato para el color de un mueble.</span><br/><span class="hl-8">* Puede ser &quot;white&quot;, &quot;black&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;yellow&quot;, &quot;green&quot;, &quot;brown&quot;, &quot;gray&quot; u &quot;other&quot;.</span><br/><span class="hl-8">* </span><span class="hl-4">@typedef</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-12">Color</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">type</span><span class="hl-0"> </span><span class="hl-12">Color</span><span class="hl-0"> = </span><span class="hl-2">&quot;white&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;black&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;blue&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;red&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;yellow&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;green&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;brown&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;gray&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Tipo de dato para el material de un mueble.</span><br/><span class="hl-8">* Puede ser &quot;wood&quot;, &quot;metal&quot;, &quot;unpholstery&quot;, &quot;plastic&quot;, &quot;glass&quot;, &quot;stone&quot; u &quot;other&quot;.</span><br/><span class="hl-8">* </span><span class="hl-4">@typedef</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-12">Material</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">type</span><span class="hl-0"> </span><span class="hl-12">Material</span><span class="hl-0"> = </span><span class="hl-2">&quot;wood&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;metal&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;unpholstery&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;plastic&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;glass&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;stone&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Tipo de dato para el tipo de transacción.</span><br/><span class="hl-8">* Puede ser &quot;sell&quot;, &quot;purchase&quot;.</span><br/><span class="hl-8">* </span><span class="hl-4">@typedef</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-12">TransactionType</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">type</span><span class="hl-0"> </span><span class="hl-12">TransactionType</span><span class="hl-0"> = </span><span class="hl-2">&quot;sell&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;purchase&quot;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Tipo de dato para el tipo de categoría de muebles.</span><br/><span class="hl-8">* Puede ser &quot;wood&quot;, &quot;upholstered&quot;, &quot;office&quot;, &quot;outdoor&quot;, &quot;antique&quot;, &quot;kids&quot;, &quot;custom&quot; u &quot;other&quot;.</span><br/><span class="hl-8">* </span><span class="hl-4">@typedef</span><span class="hl-8"> </span><span class="hl-12">{string}</span><span class="hl-8"> </span><span class="hl-12">CatergoryType</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">type</span><span class="hl-0"> </span><span class="hl-12">CatergoryType</span><span class="hl-0"> = </span><span class="hl-2">&quot;wood&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;upholstered&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;office&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;outdoor&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;antique&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;kids&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;custom&quot;</span><span class="hl-0"> | </span><span class="hl-2">&quot;other&quot;</span><span class="hl-0">;</span><br/>
</code><button>Copy</button></pre>
<a id="md:indexts" class="tsd-anchor"></a><h3><a href="#md:indexts">Index.ts</a></h3><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">express</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">cors</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;cors&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">customerRouter</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;./routers/customers.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">furnitureRouter</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;./routers/furniture.js&#39;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">defaultRouter</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;./routers/defaults.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">providerRouter</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;./routers/providers.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">transactionRouter</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;./routers/transactions.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">&#39;./db/database.js&#39;</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">port</span><span class="hl-0"> = </span><span class="hl-5">process</span><span class="hl-0">.</span><span class="hl-5">env</span><span class="hl-0">.</span><span class="hl-10">PORT</span><span class="hl-0"> || </span><span class="hl-9">3000</span><span class="hl-0">;</span><br/><br/><span class="hl-6">export</span><span class="hl-0"> </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">app</span><span class="hl-0"> = </span><span class="hl-1">express</span><span class="hl-0">();</span><br/><br/><span class="hl-8">// Son necesarios para que el servidor pueda recibir peticiones POST</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-1">cors</span><span class="hl-0">());</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">express</span><span class="hl-0">.</span><span class="hl-1">json</span><span class="hl-0">());</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">customerRouter</span><span class="hl-0">);</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">furnitureRouter</span><span class="hl-0">);</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">providerRouter</span><span class="hl-0">);</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">transactionRouter</span><span class="hl-0">)</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">use</span><span class="hl-0">(</span><span class="hl-5">defaultRouter</span><span class="hl-0">);</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Esta función se ejecuta cuando se hace una petición GET a la raíz de la API.</span><br/><span class="hl-8">*/</span><br/><span class="hl-5">app</span><span class="hl-0">.</span><span class="hl-1">listen</span><span class="hl-0">(</span><span class="hl-5">port</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-1">log</span><span class="hl-0">(</span><span class="hl-2">&#39;Server is up on https://ull-esit-inf-dsi-23-24-prct13-dsikea-api-3m1d.onrender.com&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">})</span>
</code><button>Copy</button></pre>
<a id="md:explicacion-de-lo-realizado" class="tsd-anchor"></a><h2><a href="#md:explicacion-de-lo-realizado">Explicacion de lo realizado</a></h2><a id="md:database-1" class="tsd-anchor"></a><h3><a href="#md:database-1">Database</a></h3><a id="md:databasets-1" class="tsd-anchor"></a><h4><a href="#md:databasets-1">Database.ts</a></h4><a id="md:descripción-general" class="tsd-anchor"></a><h4><a href="#md:descripción-general">Descripción General</a></h4><p>El script proporciona dos funciones principales:</p>
<ol>
<li><strong><code>connectDB</code></strong>: Conecta a la base de datos de MongoDB.</li>
<li><strong><code>closeDB</code></strong>: Cierra la conexión a la base de datos de MongoDB.</li>
</ol>
<a id="md:detalles-del-código" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código">Detalles del Código</a></h4><a id="md:importación-de-mongoose" class="tsd-anchor"></a><h4><a href="#md:importación-de-mongoose">Importación de Mongoose</a></h4><p>El script comienza importando Mongoose, una biblioteca de modelado de datos para MongoDB y Node.js que proporciona una solución basada en esquemas para modelar los datos de la aplicación.</p>
<a id="md:función-connectdb" class="tsd-anchor"></a><h4><a href="#md:función-connectdb">Función <code>connectDB</code></a></h4><p>Esta función intenta establecer una conexión a la base de datos MongoDB utilizando una URL de conexión específica.</p>
<ul>
<li><strong>Conexión Exitosa</strong>: Si la conexión es exitosa, se imprime un mensaje en la consola indicando que la base de datos se ha conectado.</li>
<li><strong>Conexión Fallida</strong>: Si la conexión falla, se captura el error, se imprime un mensaje en la consola detallando el error y se lanza una excepción para que pueda ser manejada por el código que llama a esta función.</li>
</ul>
<a id="md:función-closedb" class="tsd-anchor"></a><h4><a href="#md:función-closedb">Función <code>closeDB</code></a></h4><p>Esta función intenta cerrar la conexión a la base de datos MongoDB.</p>
<ul>
<li><strong>Cierre Exitoso</strong>: Si la conexión se cierra exitosamente, se imprime un mensaje en la consola indicando que la conexión se ha cerrado.</li>
<li><strong>Cierre Fallido</strong>: Si el cierre falla, se captura el error, se imprime un mensaje en la consola detallando el error y se lanza una excepción para que pueda ser manejada por el código que llama a esta función.</li>
</ul>
<a id="md:resumen" class="tsd-anchor"></a><h4><a href="#md:resumen">Resumen</a></h4><ul>
<li><strong>Conexión a la Base de Datos</strong>: La función <code>connectDB</code> establece una conexión con la base de datos MongoDB y maneja errores potenciales durante el proceso.</li>
<li><strong>Cierre de la Conexión</strong>: La función <code>closeDB</code> cierra la conexión con la base de datos y maneja errores que puedan ocurrir durante el cierre.</li>
</ul>
<p>Este script es esencial para gestionar la conexión y desconexión de la base de datos en aplicaciones Node.js, asegurando que los recursos se manejen adecuadamente y los errores se capturen y manejen de manera eficiente.</p>
<a id="md:models-1" class="tsd-anchor"></a><h3><a href="#md:models-1">Models</a></h3><a id="md:customerts-2" class="tsd-anchor"></a><h4><a href="#md:customerts-2">Customer.ts</a></h4><a id="md:descripción-general-1" class="tsd-anchor"></a><h4><a href="#md:descripción-general-1">Descripción General</a></h4><p>El script proporciona la definición de un esquema y un modelo para los documentos de Cliente. Esto incluye la creación de una interfaz que describe los campos de un Cliente y un esquema de Mongoose que implementa esta interfaz.</p>
<a id="md:detalles-del-código-1" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-1">Detalles del Código</a></h4><a id="md:importación-de-mongoose-1" class="tsd-anchor"></a><h5><a href="#md:importación-de-mongoose-1">Importación de Mongoose</a></h5><p>El script comienza importando Mongoose, una biblioteca de modelado de datos para MongoDB y Node.js que proporciona una solución basada en esquemas para modelar los datos de la aplicación. También se importa el tipo <code>Genre</code> desde un archivo de tipos externo.</p>
<a id="md:interfaz-customerinterface" class="tsd-anchor"></a><h5><a href="#md:interfaz-customerinterface">Interfaz <code>CustomerInterface</code></a></h5><p>Se define una interfaz <code>CustomerInterface</code> que extiende de <code>Document</code>. Esta interfaz describe los campos que un documento de Cliente debe tener:</p>
<ul>
<li><strong>surname</strong>: El apellido del cliente. Es una cadena obligatoria.</li>
<li><strong>name</strong>: El nombre del cliente. Es una cadena obligatoria.</li>
<li><strong>nif</strong>: El NIF del cliente. Es una cadena única y obligatoria que debe tener 8 dígitos seguidos de 1 letra.</li>
<li><strong>genre</strong>: El género del cliente. Es una cadena opcional que puede ser &#39;male&#39; (masculino) o &#39;female&#39; (femenino).</li>
</ul>
<a id="md:esquema-customerschema" class="tsd-anchor"></a><h5><a href="#md:esquema-customerschema">Esquema <code>CustomerSchema</code></a></h5><p>Se define el esquema <code>CustomerSchema</code> utilizando la interfaz <code>CustomerInterface</code>. Este esquema incluye los siguientes campos y validaciones:</p>
<ul>
<li><strong>surname</strong>: Una cadena que se recorta y es obligatoria.</li>
<li><strong>name</strong>: Una cadena que se recorta y es obligatoria.</li>
<li><strong>nif</strong>: Una cadena única que se recorta y es obligatoria. Debe tener 8 dígitos seguidos de 1 letra. Se valida usando una expresión regular.</li>
<li><strong>genre</strong>: Una cadena que se recorta, no es obligatoria, y puede ser &#39;male&#39; o &#39;female&#39;. Se convierte a minúsculas automáticamente.</li>
</ul>
<p>El esquema también incluye marcas de tiempo (<code>timestamps</code>) para rastrear la fecha de creación y la última actualización de los documentos.</p>
<a id="md:exportación-del-modelo" class="tsd-anchor"></a><h5><a href="#md:exportación-del-modelo">Exportación del Modelo</a></h5><p>Finalmente, se exporta el modelo <code>Customer</code> basado en el esquema <code>CustomerSchema</code>, permitiendo que este modelo sea utilizado en otras partes de la aplicación para interactuar con la colección de Clientes en la base de datos MongoDB.</p>
<a id="md:resumen-1" class="tsd-anchor"></a><h4><a href="#md:resumen-1">Resumen</a></h4><ul>
<li><strong>Interfaz del Cliente</strong>: Define la estructura de un documento de Cliente con campos obligatorios y opcionales.</li>
<li><strong>Esquema del Cliente</strong>: Implementa la interfaz del Cliente y define las validaciones y transformaciones necesarias para cada campo.</li>
<li><strong>Modelo del Cliente</strong>: Exporta el modelo de Mongoose basado en el esquema, permitiendo su uso para operaciones CRUD en la base de datos.</li>
</ul>
<p>Este script es esencial para gestionar la estructura y las validaciones de los documentos de Cliente en una aplicación Node.js, asegurando que los datos se almacenen correctamente y cumplan con los requisitos establecidos.</p>
<a id="md:furniturets-2" class="tsd-anchor"></a><h4><a href="#md:furniturets-2">Furniture.ts</a></h4><p> En el fichero de furnitures se ralizo lo siguiente:</p>
<a id="md:interfaz-del-mueble-furnitureinterface" class="tsd-anchor"></a><h3><a href="#md:interfaz-del-mueble-furnitureinterface">Interfaz del Mueble (FurnitureInterface)</a></h3><p>La interfaz <code>FurnitureInterface</code> define la estructura de un objeto de tipo mueble. Contiene propiedades como <code>name</code>, <code>productCode</code>, <code>material</code>, <code>height</code>, <code>width</code>, <code>depth</code>, <code>warranty</code>, <code>color</code>, y <code>prize</code>, cada una con su tipo de dato correspondiente.</p>
<a id="md:esquema-del-mueble-furnitureschema" class="tsd-anchor"></a><h5><a href="#md:esquema-del-mueble-furnitureschema">Esquema del Mueble (FurnitureSchema)</a></h5><p>El esquema <code>FurnitureSchema</code> define la estructura del documento de Mueble en MongoDB. Incluye los siguientes campos:</p>
<ul>
<li><code>name</code>: Nombre del mueble, una cadena recortada y obligatoria.</li>
<li><code>productCode</code>: Código de producto del mueble, una cadena obligatoria y única.</li>
<li><code>material</code>: Material del mueble, un valor de tipo Material con un valor predeterminado &quot;other&quot;.</li>
<li><code>height</code>, <code>width</code>, <code>depth</code>: Dimensiones del mueble, números con validaciones de mínimo y máximo.</li>
<li><code>warranty</code>: Período de garantía del mueble en años, un número.</li>
<li><code>color</code>: Color del mueble, un valor de tipo Color con un valor predeterminado &quot;other&quot;.</li>
<li><code>prize</code>: Precio del mueble, un número no negativo.</li>
</ul>
<a id="md:validaciones-y-opciones" class="tsd-anchor"></a><h5><a href="#md:validaciones-y-opciones">Validaciones y Opciones</a></h5><ul>
<li>Se aplican validaciones para asegurar que el nombre del mueble no contenga números ni ciertos caracteres especiales.</li>
<li>El material y el color se validan a través de enumeraciones para garantizar valores válidos.</li>
<li>Se definen valores predeterminados para los campos <code>material</code> y <code>color</code>.</li>
<li>Se utiliza el mecanismo de timestamps para registrar automáticamente las fechas de creación y actualización de los documentos.</li>
</ul>
<a id="md:otros-aspectos" class="tsd-anchor"></a><h5><a href="#md:otros-aspectos">Otros Aspectos</a></h5><ul>
<li>Se importan los tipos <code>Color</code> y <code>Material</code> desde un archivo de variables.</li>
<li>Se utiliza la librería Mongoose para definir el esquema y el modelo del Mueble.</li>
<li>El modelo se exporta como <code>Furniture</code> para su uso en otras partes del código.</li>
</ul>
<a id="md:providerts-2" class="tsd-anchor"></a><h4><a href="#md:providerts-2">Provider.ts</a></h4><p> Se realizó lo siguiente: </p>
<a id="md:interfaz-del-proveedor-providerinterface" class="tsd-anchor"></a><h5><a href="#md:interfaz-del-proveedor-providerinterface">Interfaz del Proveedor (ProviderInterface)</a></h5><p>La interfaz <code>ProviderInterface</code> define la estructura de un objeto de tipo proveedor. Contiene propiedades como <code>cif</code>, <code>name</code>, <code>address</code>, <code>phone</code>, y <code>category</code>, cada una con su tipo de dato correspondiente.</p>
<a id="md:esquema-del-proveedor-providerschema" class="tsd-anchor"></a><h5><a href="#md:esquema-del-proveedor-providerschema">Esquema del Proveedor (ProviderSchema)</a></h5><p>El esquema <code>ProviderSchema</code> define la estructura del documento de Proveedor en MongoDB. Incluye los siguientes campos:</p>
<ul>
<li><code>cif</code>: Código de Identificación Fiscal del proveedor, una cadena recortada, obligatoria y única, con una validación que verifica su formato.</li>
<li><code>name</code>: Nombre del proveedor, una cadena recortada y obligatoria, con una validación para asegurar que no contiene números ni ciertos caracteres especiales.</li>
<li><code>address</code>: Dirección del proveedor, una cadena recortada y obligatoria.</li>
<li><code>phone</code>: Número de teléfono del proveedor, un número obligatorio con una validación para verificar su longitud.</li>
<li><code>category</code>: Categoría del proveedor, una cadena que se convierte a minúsculas, no obligatoria, con un conjunto predefinido de valores y un valor predeterminado &quot;other&quot;.</li>
</ul>
<a id="md:validaciones-y-opciones-1" class="tsd-anchor"></a><h5><a href="#md:validaciones-y-opciones-1">Validaciones y Opciones</a></h5><ul>
<li>Se aplican validaciones para asegurar que el CIF tenga el formato correcto y que el nombre del proveedor no contenga números ni ciertos caracteres especiales.</li>
<li>Se define un conjunto predefinido de valores para la categoría del proveedor, con un valor predeterminado &quot;other&quot;.</li>
<li>Se utiliza el mecanismo de timestamps para registrar automáticamente las fechas de creación y actualización de los documentos.</li>
</ul>
<a id="md:modelo-del-proveedor-provider" class="tsd-anchor"></a><h5><a href="#md:modelo-del-proveedor-provider">Modelo del Proveedor (Provider)</a></h5><p>Se exporta el modelo <code>Provider</code> para su uso en otras partes del código.</p>
<a id="md:transactionsts-2" class="tsd-anchor"></a><h4><a href="#md:transactionsts-2">Transactions.ts</a></h4><a id="md:descripción-general-2" class="tsd-anchor"></a><h6><a href="#md:descripción-general-2">Descripción General</a></h6><p>El script proporciona la definición de un esquema y un modelo para los documentos de Transacción. Esto incluye la creación de una interfaz que describe los campos de una Transacción y un esquema de Mongoose que implementa esta interfaz.</p>
<a id="md:detalles-del-código-2" class="tsd-anchor"></a><h5><a href="#md:detalles-del-código-2">Detalles del Código</a></h5><a id="md:importación-de-mongoose-y-tipos" class="tsd-anchor"></a><h5><a href="#md:importación-de-mongoose-y-tipos">Importación de Mongoose y Tipos</a></h5><p>El script comienza importando Mongoose, una biblioteca de modelado de datos para MongoDB y Node.js que proporciona una solución basada en esquemas para modelar los datos de la aplicación. También se importan los tipos <code>TransactionType</code>, <code>ProviderInterface</code>, <code>FurnitureInterface</code> y <code>CustomerInterface</code> desde archivos externos.</p>
<a id="md:interfaz-transactioninterface" class="tsd-anchor"></a><h5><a href="#md:interfaz-transactioninterface">Interfaz <code>TransactionInterface</code></a></h5><p>Se define una interfaz <code>TransactionInterface</code> que extiende de <code>Document</code>. Esta interfaz describe los campos que un documento de Transacción debe tener:</p>
<ul>
<li><strong>type</strong>: El tipo de transacción, que puede ser &#39;sell&#39; (venta) o &#39;purchase&#39; (compra).</li>
<li><strong>productCode</strong>: El código del producto involucrado en la transacción. Es una cadena obligatoria.</li>
<li><strong>providerCIF</strong>: El CIF del proveedor. Es una cadena opcional.</li>
<li><strong>customerNIF</strong>: El NIF del cliente. Es una cadena opcional.</li>
<li><strong>moneyAmount</strong>: La cantidad de dinero involucrada en la transacción. Es un número obligatorio.</li>
<li><strong>furnitureID</strong>: El ID del mueble involucrado en la transacción. Es una referencia obligatoria a un documento Mueble.</li>
<li><strong>providerID</strong>: El ID del proveedor involucrado en la transacción. Es una referencia opcional a un documento Proveedor.</li>
<li><strong>customerID</strong>: El ID del cliente involucrado en la transacción. Es una referencia opcional a un documento Cliente.</li>
</ul>
<a id="md:esquema-transactionschema" class="tsd-anchor"></a><h5><a href="#md:esquema-transactionschema">Esquema <code>TransactionSchema</code></a></h5><p>Se define el esquema <code>TransactionSchema</code> utilizando la interfaz <code>TransactionInterface</code>. Este esquema incluye los siguientes campos y validaciones:</p>
<ul>
<li><strong>type</strong>: Una cadena recortada y obligatoria que puede ser &#39;sell&#39; o &#39;purchase&#39;.</li>
<li><strong>productCode</strong>: Una cadena recortada y obligatoria.</li>
<li><strong>providerCIF</strong>: Una cadena recortada y opcional.</li>
<li><strong>customerNIF</strong>: Una cadena recortada y opcional.</li>
<li><strong>moneyAmount</strong>: Un número que debe ser mayor o igual a 0.</li>
<li><strong>furnitureID</strong>: Un ObjectId obligatorio que referencia a un documento Mueble.</li>
<li><strong>providerID</strong>: Un ObjectId opcional que referencia a un documento Proveedor.</li>
<li><strong>customerID</strong>: Un ObjectId opcional que referencia a un documento Cliente.</li>
</ul>
<p>El esquema también incluye marcas de tiempo (<code>timestamps</code>) para rastrear la fecha de creación y la última actualización de los documentos.</p>
<a id="md:exportación-del-modelo-1" class="tsd-anchor"></a><h5><a href="#md:exportación-del-modelo-1">Exportación del Modelo</a></h5><p>Finalmente, se exporta el modelo <code>Transaction</code> basado en el esquema <code>TransactionSchema</code>, permitiendo que este modelo sea utilizado en otras partes de la aplicación para interactuar con la colección de Transacciones en la base de datos MongoDB.</p>
<a id="md:resumen-2" class="tsd-anchor"></a><h4><a href="#md:resumen-2">Resumen</a></h4><ul>
<li><strong>Interfaz de la Transacción</strong>: Define la estructura de un documento de Transacción con campos obligatorios y opcionales.</li>
<li><strong>Esquema de la Transacción</strong>: Implementa la interfaz de Transacción y define las validaciones y transformaciones necesarias para cada campo.</li>
<li><strong>Modelo de la Transacción</strong>: Exporta el modelo de Mongoose basado en el esquema, permitiendo su uso para operaciones CRUD en la base de datos.</li>
</ul>
<p>Este script es esencial para gestionar la estructura y las validaciones de los documentos de Transacción en una aplicación Node.js, asegurando que los datos se almacenen correctamente y cumplan con los requisitos establecidos.</p>
<a id="md:routers-1" class="tsd-anchor"></a><h3><a href="#md:routers-1">Routers</a></h3><a id="md:customerts-3" class="tsd-anchor"></a><h4><a href="#md:customerts-3">Customer.ts</a></h4><a id="md:descripción-general-3" class="tsd-anchor"></a><h4><a href="#md:descripción-general-3">Descripción General</a></h4><p>El script proporciona la definición de varias rutas HTTP para crear, obtener, actualizar y eliminar documentos de Cliente. Estas rutas permiten interactuar con la base de datos de manera estructurada y eficiente.</p>
<a id="md:detalles-del-código-3" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-3">Detalles del Código</a></h4><a id="md:importación-de-dependencias" class="tsd-anchor"></a><h5><a href="#md:importación-de-dependencias">Importación de Dependencias</a></h5><p>El script comienza importando Express y el modelo <code>Customer</code> desde el archivo correspondiente. Luego se crea un <code>Router</code> de Express para manejar las rutas de los clientes.</p>
<a id="md:ruta-post-para-39customers39" class="tsd-anchor"></a><h5><a href="#md:ruta-post-para-39customers39">Ruta POST para &#39;/customers&#39;</a></h5><p>Esta ruta permite crear un nuevo cliente en la base de datos.</p>
<ul>
<li><strong>Solicitud</strong>: La solicitud HTTP debe contener los datos del cliente a crear en el cuerpo.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente creado con un estado 201.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-get-para-39customers39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-para-39customers39">Ruta GET para &#39;/customers&#39;</a></h5><p>Esta ruta permite obtener uno o más clientes de la base de datos.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta puede contener un NIF para filtrar los clientes.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve los clientes encontrados.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún cliente con el NIF proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-get-para-39customersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-para-39customersid39">Ruta GET para &#39;/customers/:id&#39;</a></h5><p>Esta ruta permite obtener un cliente específico de la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del cliente a obtener.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente encontrado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún cliente con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-patch-para-39customers39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-para-39customers39">Ruta PATCH para &#39;/customers&#39;</a></h5><p>Esta ruta permite actualizar un cliente específico en la base de datos utilizando su NIF.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta debe contener el NIF del cliente a actualizar y el cuerpo de la solicitud debe contener los campos a actualizar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente actualizado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encuentra ningún cliente con el NIF proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-patch-para-39customersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-para-39customersid39">Ruta PATCH para &#39;/customers/:id&#39;</a></h5><p>Esta ruta permite actualizar un cliente específico en la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del cliente a actualizar y el cuerpo de la solicitud debe contener los campos a actualizar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente actualizado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encuentra ningún cliente con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-delete-para-39customers39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-para-39customers39">Ruta DELETE para &#39;/customers&#39;</a></h5><p>Esta ruta permite eliminar un cliente específico de la base de datos utilizando su NIF.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta debe contener el NIF del cliente a eliminar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente eliminado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún cliente con el NIF proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-delete-para-39customersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-para-39customersid39">Ruta DELETE para &#39;/customers/:id&#39;</a></h5><p>Esta ruta permite eliminar un cliente específico de la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del cliente a eliminar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el cliente eliminado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún cliente con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:resumen-3" class="tsd-anchor"></a><h4><a href="#md:resumen-3">Resumen</a></h4><ul>
<li><strong>Creación de Clientes</strong>: Permite crear nuevos clientes en la base de datos.</li>
<li><strong>Obtención de Clientes</strong>: Permite obtener uno o más clientes, ya sea por NIF o por ID.</li>
<li><strong>Actualización de Clientes</strong>: Permite actualizar clientes existentes, ya sea por NIF o por ID.</li>
<li><strong>Eliminación de Clientes</strong>: Permite eliminar clientes existentes, ya sea por NIF o por ID.</li>
</ul>
<p>Este script es esencial para gestionar las operaciones CRUD de los documentos de Cliente en una aplicación Node.js, asegurando que las solicitudes HTTP se manejen de manera estructurada y eficiente.</p>
<a id="md:defaultsts-1" class="tsd-anchor"></a><h4><a href="#md:defaultsts-1">Defaults.ts</a></h4><a id="md:descripción-general-4" class="tsd-anchor"></a><h4><a href="#md:descripción-general-4">Descripción General</a></h4><p>El script proporciona la definición de una ruta que captura todas las solicitudes no soportadas y devuelve un estado HTTP 501 (Not Implemented). Esto ayuda a manejar casos en los que una solicitud se realiza a una ruta no definida en la aplicación.</p>
<a id="md:detalles-del-código-4" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-4">Detalles del Código</a></h4><a id="md:importación-de-express" class="tsd-anchor"></a><h5><a href="#md:importación-de-express">Importación de Express</a></h5><p>El script comienza importando Express, una biblioteca web para Node.js que se utiliza para crear aplicaciones web y API.</p>
<a id="md:definición-del-router" class="tsd-anchor"></a><h5><a href="#md:definición-del-router">Definición del <code>Router</code></a></h5><p>Se crea un <code>Router</code> de Express denominado <code>defaultRouter</code> para manejar las rutas por defecto.</p>
<a id="md:ruta-por-defecto" class="tsd-anchor"></a><h5><a href="#md:ruta-por-defecto">Ruta por Defecto</a></h5><p>Se define una ruta que captura todas las solicitudes HTTP (usando <code>&#39;*&#39;</code>) que no coinciden con ninguna otra ruta definida en la aplicación.</p>
<ul>
<li><strong>Solicitud</strong>: Captura cualquier solicitud HTTP que no sea soportada.</li>
<li><strong>Respuesta</strong>: Devuelve un estado HTTP 501 (Not Implemented) indicando que la solicitud no es soportada por el servidor.</li>
</ul>
<a id="md:resumen-4" class="tsd-anchor"></a><h4><a href="#md:resumen-4">Resumen</a></h4><ul>
<li><strong>Manejo de Solicitudes No Soportadas</strong>: La ruta por defecto captura todas las solicitudes HTTP que no coinciden con ninguna otra ruta definida y devuelve un estado 501.</li>
<li><strong>Respuesta Consistente</strong>: Asegura que las solicitudes no soportadas se manejen de manera consistente y apropiada, proporcionando una respuesta clara de que la funcionalidad solicitada no está implementada.</li>
</ul>
<p>Este script es esencial para gestionar solicitudes no soportadas en una aplicación Node.js, asegurando que los usuarios reciban respuestas apropiadas y evitando que las solicitudes no definidas causen problemas en el servidor.</p>
<a id="md:furniturets-3" class="tsd-anchor"></a><h4><a href="#md:furniturets-3">Furniture.ts</a></h4><a id="md:descripción-general-5" class="tsd-anchor"></a><h4><a href="#md:descripción-general-5">Descripción General</a></h4><p>El script proporciona la definición de varias rutas HTTP para crear, obtener, actualizar y eliminar documentos de Muebles. Estas rutas permiten interactuar con la base de datos de manera estructurada y eficiente.</p>
<a id="md:detalles-del-código-5" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-5">Detalles del Código</a></h4><a id="md:importación-de-dependencias-1" class="tsd-anchor"></a><h5><a href="#md:importación-de-dependencias-1">Importación de Dependencias</a></h5><p>El script comienza importando Express y el modelo <code>Furniture</code> desde el archivo correspondiente. Luego se crea un <code>Router</code> de Express para manejar las rutas de los muebles.</p>
<a id="md:ruta-post-para-39furnitures39" class="tsd-anchor"></a><h5><a href="#md:ruta-post-para-39furnitures39">Ruta POST para &#39;/furnitures&#39;</a></h5><p>Esta ruta permite crear un nuevo mueble en la base de datos.</p>
<ul>
<li><strong>Solicitud</strong>: La solicitud HTTP debe contener los datos del mueble a crear en el cuerpo.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el mueble creado con un estado 201.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-get-para-39furnitures39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-para-39furnitures39">Ruta GET para &#39;/furnitures&#39;</a></h5><p>Esta ruta permite obtener uno o más muebles de la base de datos.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta puede contener filtros como nombre, material, altura, anchura, profundidad, garantía, color o precio para filtrar los muebles.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve los muebles encontrados.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún mueble con los filtros proporcionados, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-get-para-39furnituresid39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-para-39furnituresid39">Ruta GET para &#39;/furnitures/:id&#39;</a></h5><p>Esta ruta permite obtener un mueble específico de la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del mueble a obtener.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el mueble encontrado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún mueble con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-patch-para-39furnitures39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-para-39furnitures39">Ruta PATCH para &#39;/furnitures&#39;</a></h5><p>Esta ruta permite actualizar uno o más muebles específicos en la base de datos utilizando sus filtros.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta puede contener filtros como nombre, material, altura, anchura, profundidad, garantía, color o precio para identificar los muebles a actualizar. El cuerpo de la solicitud debe contener los campos a actualizar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve los muebles actualizados.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encuentra ningún mueble con los filtros proporcionados, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-patch-para-39furnituresid39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-para-39furnituresid39">Ruta PATCH para &#39;/furnitures/:id&#39;</a></h5><p>Esta ruta permite actualizar un mueble específico en la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del mueble a actualizar y el cuerpo de la solicitud debe contener los campos a actualizar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el mueble actualizado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 400 si la actualización solicitada no es válida, un error con un estado 404 si no se encuentra ningún mueble con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-delete-para-39furnitures39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-para-39furnitures39">Ruta DELETE para &#39;/furnitures&#39;</a></h5><p>Esta ruta permite eliminar uno o más muebles específicos de la base de datos utilizando sus filtros.</p>
<ul>
<li><strong>Solicitud</strong>: La consulta puede contener filtros como nombre, material, altura, anchura, profundidad, garantía, color o precio para identificar los muebles a eliminar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve los muebles eliminados.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún mueble con los filtros proporcionados, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:ruta-delete-para-39furnituresid39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-para-39furnituresid39">Ruta DELETE para &#39;/furnitures/:id&#39;</a></h5><p>Esta ruta permite eliminar un mueble específico de la base de datos utilizando su ID.</p>
<ul>
<li><strong>Solicitud</strong>: Los parámetros deben contener el ID del mueble a eliminar.</li>
<li><strong>Respuesta Exitosa</strong>: Devuelve el mueble eliminado.</li>
<li><strong>Error</strong>: Devuelve un error con un estado 404 si no se encuentra ningún mueble con el ID proporcionado, o un error con un estado 500 si la operación falla.</li>
</ul>
<a id="md:resumen-5" class="tsd-anchor"></a><h4><a href="#md:resumen-5">Resumen</a></h4><ul>
<li><strong>Creación de Muebles</strong>: Permite crear nuevos muebles en la base de datos.</li>
<li><strong>Obtención de Muebles</strong>: Permite obtener uno o más muebles, ya sea por filtros o por ID.</li>
<li><strong>Actualización de Muebles</strong>: Permite actualizar muebles existentes, ya sea por filtros o por ID.</li>
<li><strong>Eliminación de Muebles</strong>: Permite eliminar muebles existentes, ya sea por filtros o por ID.</li>
</ul>
<p>Este script es esencial para gestionar las operaciones CRUD de los documentos de Muebles en una aplicación Node.js, asegurando que las solicitudes HTTP se manejen de manera estructurada y eficiente.</p>
<a id="md:providerts-3" class="tsd-anchor"></a><h4><a href="#md:providerts-3">Provider.ts</a></h4><p> En el providers de la carpeta de routers se realizo lo siguiente:</p>
<a id="md:enrutador-del-proveedor-providerrouter" class="tsd-anchor"></a><h5><a href="#md:enrutador-del-proveedor-providerrouter">Enrutador del Proveedor (providerRouter)</a></h5><p>El enrutador <code>providerRouter</code> maneja las solicitudes HTTP relacionadas con los proveedores.</p>
<a id="md:ruta-post-39providers39" class="tsd-anchor"></a><h5><a href="#md:ruta-post-39providers39">Ruta POST &#39;/providers&#39;</a></h5><ul>
<li>Crea un nuevo proveedor en la base de datos utilizando los datos proporcionados en el cuerpo de la solicitud.</li>
<li>Devuelve el proveedor creado con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-get-39providers39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-39providers39">Ruta GET &#39;/providers&#39;</a></h5><ul>
<li>Obtiene uno o más proveedores de la base de datos, con la opción de filtrar por CIF.</li>
<li>Devuelve los proveedores encontrados en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-get-39providersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-39providersid39">Ruta GET &#39;/providers/:id&#39;</a></h5><ul>
<li>Obtiene un proveedor específico de la base de datos utilizando su ID.</li>
<li>Devuelve el proveedor encontrado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-patch-39providers39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-39providers39">Ruta PATCH &#39;/providers&#39;</a></h5><ul>
<li>Actualiza uno o más proveedores de la base de datos.</li>
<li>Devuelve el proveedor actualizado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-patch-39providersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-39providersid39">Ruta PATCH &#39;/providers/:id&#39;</a></h5><ul>
<li>Actualiza un proveedor específico en la base de datos utilizando su ID.</li>
<li>Devuelve el proveedor actualizado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-delete-39providers39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-39providers39">Ruta DELETE &#39;/providers&#39;</a></h5><ul>
<li>Elimina un proveedor de la base de datos utilizando su CIF.</li>
<li>Devuelve el proveedor eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el CIF proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-delete-39providersid39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-39providersid39">Ruta DELETE &#39;/providers/:id&#39;</a></h5><ul>
<li>Elimina un proveedor específico de la base de datos utilizando su ID.</li>
<li>Devuelve el proveedor eliminado en caso de éxito, un error con un estado 404 si no se encontró ningún proveedor con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:transactionsts-3" class="tsd-anchor"></a><h4><a href="#md:transactionsts-3">Transactions.ts</a></h4><p>En el dichero de transactions se realizo lo siguiente:</p>
<a id="md:enrutador-de-transacciones-transactionrouter" class="tsd-anchor"></a><h5><a href="#md:enrutador-de-transacciones-transactionrouter">Enrutador de Transacciones (transactionRouter)</a></h5><p>El enrutador <code>transactionRouter</code> maneja las solicitudes HTTP relacionadas con las transacciones.</p>
<a id="md:ruta-post-39transactions39" class="tsd-anchor"></a><h5><a href="#md:ruta-post-39transactions39">Ruta POST &#39;/transactions&#39;</a></h5><ul>
<li>Crea una nueva transacción en la base de datos utilizando los datos proporcionados en el cuerpo de la solicitud.</li>
<li>Verifica si existe un mueble con el mismo código de producto. Si no existe, crea uno nuevo.</li>
<li>Verifica si el proveedor o cliente especificado existe y asigna su ID correspondiente a la transacción.</li>
<li>Devuelve la transacción creada con un estado 201 en caso de éxito, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-get-39transactions39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-39transactions39">Ruta GET &#39;/transactions&#39;</a></h5><ul>
<li>Obtiene una o más transacciones de la base de datos, con opciones de filtrado.</li>
<li>Devuelve las transacciones encontradas en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con los filtros proporcionados, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-get-39transactionsid39" class="tsd-anchor"></a><h5><a href="#md:ruta-get-39transactionsid39">Ruta GET &#39;/transactions/:id&#39;</a></h5><ul>
<li>Obtiene una transacción específica de la base de datos utilizando su ID.</li>
<li>Devuelve la transacción encontrada en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-patch-39transactions39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-39transactions39">Ruta PATCH &#39;/transactions&#39;</a></h5><ul>
<li>Actualiza una o más transacciones de la base de datos utilizando filtros y los datos proporcionados en el cuerpo de la solicitud.</li>
<li>Devuelve las transacciones actualizadas en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con los filtros proporcionados, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-patch-39transactionsid39" class="tsd-anchor"></a><h5><a href="#md:ruta-patch-39transactionsid39">Ruta PATCH &#39;/transactions/:id&#39;</a></h5><ul>
<li>Actualiza una transacción específica en la base de datos utilizando su ID y los datos proporcionados en el cuerpo de la solicitud.</li>
<li>Devuelve la transacción actualizada en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-delete-39transactions39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-39transactions39">Ruta DELETE &#39;/transactions&#39;</a></h5><ul>
<li>Elimina una o más transacciones de la base de datos utilizando filtros.</li>
<li>Devuelve las transacciones eliminadas en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con los filtros proporcionados, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:ruta-delete-39transactionsid39" class="tsd-anchor"></a><h5><a href="#md:ruta-delete-39transactionsid39">Ruta DELETE &#39;/transactions/:id&#39;</a></h5><ul>
<li>Elimina una transacción específica de la base de datos utilizando su ID.</li>
<li>Devuelve la transacción eliminada en caso de éxito, un error con un estado 404 si no se encontró ninguna transacción con el ID proporcionado, o un error con un estado 500 en caso de fallo.</li>
</ul>
<a id="md:variables-1" class="tsd-anchor"></a><h3><a href="#md:variables-1">Variables</a></h3><a id="md:typests-1" class="tsd-anchor"></a><h4><a href="#md:typests-1">Types.ts</a></h4><a id="md:descripción-general-6" class="tsd-anchor"></a><h4><a href="#md:descripción-general-6">Descripción General</a></h4><p>El script proporciona la definición de varios tipos de datos que se utilizan en la aplicación. Estos tipos definen los valores permitidos para diferentes campos, como el género de una persona, el color de un mueble, el material de un mueble, el tipo de transacción y la categoría de muebles.</p>
<a id="md:detalles-del-código-6" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-6">Detalles del Código</a></h4><a id="md:tipo-de-género-genre" class="tsd-anchor"></a><h5><a href="#md:tipo-de-género-genre">Tipo de Género (<code>Genre</code>)</a></h5><p>Este tipo define los valores permitidos para el género de una persona. Puede ser:</p>
<ul>
<li><code>male</code>: Masculino</li>
<li><code>female</code>: Femenino</li>
<li><code>undefined</code>: Indefinido</li>
</ul>
<a id="md:tipo-de-color-color" class="tsd-anchor"></a><h5><a href="#md:tipo-de-color-color">Tipo de Color (<code>Color</code>)</a></h5><p>Este tipo define los valores permitidos para el color de un mueble. Puede ser:</p>
<ul>
<li><code>white</code>: Blanco</li>
<li><code>black</code>: Negro</li>
<li><code>blue</code>: Azul</li>
<li><code>red</code>: Rojo</li>
<li><code>yellow</code>: Amarillo</li>
<li><code>green</code>: Verde</li>
<li><code>brown</code>: Marrón</li>
<li><code>gray</code>: Gris</li>
<li><code>other</code>: Otro</li>
</ul>
<a id="md:tipo-de-material-material" class="tsd-anchor"></a><h5><a href="#md:tipo-de-material-material">Tipo de Material (<code>Material</code>)</a></h5><p>Este tipo define los valores permitidos para el material de un mueble. Puede ser:</p>
<ul>
<li><code>wood</code>: Madera</li>
<li><code>metal</code>: Metal</li>
<li><code>unpholstery</code>: Tapicería</li>
<li><code>plastic</code>: Plástico</li>
<li><code>glass</code>: Vidrio</li>
<li><code>stone</code>: Piedra</li>
<li><code>other</code>: Otro</li>
</ul>
<a id="md:tipo-de-transacción-transactiontype" class="tsd-anchor"></a><h5><a href="#md:tipo-de-transacción-transactiontype">Tipo de Transacción (<code>TransactionType</code>)</a></h5><p>Este tipo define los valores permitidos para el tipo de transacción. Puede ser:</p>
<ul>
<li><code>sell</code>: Venta</li>
<li><code>purchase</code>: Compra</li>
</ul>
<a id="md:tipo-de-categoría-de-muebles-catergorytype" class="tsd-anchor"></a><h5><a href="#md:tipo-de-categoría-de-muebles-catergorytype">Tipo de Categoría de Muebles (<code>CatergoryType</code>)</a></h5><p>Este tipo define los valores permitidos para la categoría de un mueble. Puede ser:</p>
<ul>
<li><code>wood</code>: Madera</li>
<li><code>upholstered</code>: Tapizado</li>
<li><code>office</code>: Oficina</li>
<li><code>outdoor</code>: Exterior</li>
<li><code>antique</code>: Antiguo</li>
<li><code>kids</code>: Infantil</li>
<li><code>custom</code>: Personalizado</li>
<li><code>other</code>: Otro</li>
</ul>
<a id="md:resumen-6" class="tsd-anchor"></a><h4><a href="#md:resumen-6">Resumen</a></h4><ul>
<li><strong>Género</strong>: Define los valores permitidos para el género de una persona.</li>
<li><strong>Color</strong>: Define los valores permitidos para el color de un mueble.</li>
<li><strong>Material</strong>: Define los valores permitidos para el material de un mueble.</li>
<li><strong>Tipo de Transacción</strong>: Define los valores permitidos para el tipo de transacción.</li>
<li><strong>Categoría de Muebles</strong>: Define los valores permitidos para la categoría de un mueble.</li>
</ul>
<p>Este script es esencial para garantizar la consistencia y la validación de los datos en una aplicación Node.js utilizando TypeScript, asegurando que los valores de los campos se limiten a las opciones permitidas.</p>
<a id="md:indexts-1" class="tsd-anchor"></a><h3><a href="#md:indexts-1">Index.ts</a></h3><a id="md:descripción-general-7" class="tsd-anchor"></a><h4><a href="#md:descripción-general-7">Descripción General</a></h4><p>El script configura el servidor principal de la aplicación, define los middlewares necesarios y monta las rutas para manejar las solicitudes HTTP. Finalmente, inicia el servidor en un puerto especificado.</p>
<a id="md:detalles-del-código-7" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-7">Detalles del Código</a></h4><a id="md:importación-de-dependencias-2" class="tsd-anchor"></a><h5><a href="#md:importación-de-dependencias-2">Importación de Dependencias</a></h5><p>El script comienza importando las dependencias necesarias, incluyendo Express para crear el servidor, CORS para manejar solicitudes de recursos cruzados, y los routers para los diferentes recursos (clientes, muebles, proveedores, transacciones y una ruta por defecto).</p>
<a id="md:configuración-del-puerto" class="tsd-anchor"></a><h5><a href="#md:configuración-del-puerto">Configuración del Puerto</a></h5><p>Se define el puerto en el que el servidor escuchará las solicitudes. El puerto se toma de las variables de entorno si está definido, o se usa el puerto 3000 por defecto.</p>
<a id="md:creación-de-la-aplicación-express" class="tsd-anchor"></a><h5><a href="#md:creación-de-la-aplicación-express">Creación de la Aplicación Express</a></h5><p>Se crea una instancia de la aplicación Express denominada <code>app</code>.</p>
<a id="md:middlewares" class="tsd-anchor"></a><h5><a href="#md:middlewares">Middlewares</a></h5><p>Se configuran los middlewares necesarios:</p>
<ul>
<li><strong>CORS</strong>: Permite que el servidor maneje solicitudes de recursos cruzados.</li>
<li><strong>Express JSON</strong>: Permite que el servidor maneje solicitudes con cuerpos JSON.</li>
</ul>
<a id="md:montaje-de-routers" class="tsd-anchor"></a><h5><a href="#md:montaje-de-routers">Montaje de Routers</a></h5><p>Se montan los routers importados para manejar las rutas específicas:</p>
<ul>
<li><strong>customerRouter</strong>: Maneja las rutas para los clientes.</li>
<li><strong>furnitureRouter</strong>: Maneja las rutas para los muebles.</li>
<li><strong>providerRouter</strong>: Maneja las rutas para los proveedores.</li>
<li><strong>transactionRouter</strong>: Maneja las rutas para las transacciones.</li>
<li><strong>defaultRouter</strong>: Maneja las rutas no definidas (por defecto).</li>
</ul>
<a id="md:inicio-del-servidor" class="tsd-anchor"></a><h5><a href="#md:inicio-del-servidor">Inicio del Servidor</a></h5><p>Finalmente, se inicia el servidor para que escuche las solicitudes en el puerto definido. Se imprime un mensaje en la consola indicando que el servidor está activo y proporcionando la URL del servidor.</p>
<a id="md:resumen-7" class="tsd-anchor"></a><h4><a href="#md:resumen-7">Resumen</a></h4><ul>
<li><strong>Configuración del Puerto</strong>: Define el puerto en el que el servidor escucha las solicitudes.</li>
<li><strong>Creación de la Aplicación Express</strong>: Crea una instancia de la aplicación Express.</li>
<li><strong>Middlewares</strong>: Configura los middlewares necesarios para manejar CORS y JSON.</li>
<li><strong>Montaje de Routers</strong>: Monta los routers para manejar las rutas específicas.</li>
<li><strong>Inicio del Servidor</strong>: Inicia el servidor y escucha las solicitudes en el puerto definido.</li>
</ul>
<p>Este script es esencial para configurar y ejecutar el servidor principal de una aplicación Node.js utilizando Express, asegurando que las solicitudes HTTP se manejen de manera estructurada y eficiente.</p>
<a id="md:pruebas-hechas" class="tsd-anchor"></a><h2><a href="#md:pruebas-hechas">Pruebas hechas.</a></h2><p> Para comporbar el código realizado se hicieron multitud de pruebas.</p>
<a id="md:customerspects" class="tsd-anchor"></a><h3><a href="#md:customerspects">Customer.spec.ts</a></h3><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">&quot;mocha&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">expect</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;chai&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">request</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;supertest&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">app</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../src/index.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Customer</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/customers.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">connectDB</span><span class="hl-0">, </span><span class="hl-5">closeDB</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/db/database.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">// Declaramos los clientes de prueba</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">firstCustomer</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;John&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Doe&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&quot;11111111A&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;male&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">secondCustomer</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Jane&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Doe&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&quot;11111111B&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;female&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">thirdCustomer</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Jim&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Beam&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&quot;11111111C&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;male&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-8">// Declaramos los hooks, son funciones que se ejecutan antes y después de los tests</span><br/><span class="hl-8">// Este hook es utilizado para conectarse a la base de datos antes de los tests</span><br/><span class="hl-1">before</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-4">function</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">connectDB</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Este hook es utilizado para cerrar la conexión a la base de datos después de los tests</span><br/><span class="hl-1">after</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-4">function</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">closeDB</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Declaramos los hooks, son funciones que se ejecutan antes y después de los tests</span><br/><span class="hl-1">beforeEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Customer</span><span class="hl-0">(</span><span class="hl-5">firstCustomer</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Customer</span><span class="hl-0">(</span><span class="hl-5">secondCustomer</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Customer</span><span class="hl-0">(</span><span class="hl-5">thirdCustomer</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Este hook es utilizado para borrar todos los clientes de la base de datos antes de cada test</span><br/><span class="hl-1">afterEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Tests</span><br/><span class="hl-8">// Pruebas para la API de clientes.</span><br/><span class="hl-8">// funcion get que obtiene todos los clientes</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;GET /customers&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para obtener todos los clientes, debería devolver un array con 3 clientes</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return all customers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">lengthOf</span><span class="hl-0">(</span><span class="hl-9">3</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para obtener un cliente con un NIF específico, debería devolver un cliente con el NIF 11111111A</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return a customer with a specific nif&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">`/customers/</span><span class="hl-4">${</span><span class="hl-5">firstCustomer</span><span class="hl-17">.</span><span class="hl-5">nif</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;nif&#39;</span><span class="hl-0">, </span><span class="hl-5">firstCustomer</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para obtener un cliente con un NIF que no existe, debería devolver un error 404</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return a 404 error if the customer does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/12345678A&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Pruebas para la API de clientes.</span><br/><span class="hl-8">// funcion post que guarda un cliente en la base de datos</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;POST /customers&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para guardar un cliente en la base de datos, debería devolver un cliente con el NIF 11111111D</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should save a customer in the database&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Mary&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Poppins&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&quot;11111111D&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;female&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-8">// se envía una petición POST a la ruta /customers con el cliente a guardar</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">customer</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;nif&#39;</span><span class="hl-0">, </span><span class="hl-5">customer</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba para guardar un cliente que ya existe en la base de datos, debería devolver un error 500</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return a 500 error if the customer already exists&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// se envía una petición POST a la ruta /customers con el cliente que ya existe</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers&#39;</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">firstCustomer</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">500</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Pruebas para la API de clientes.</span><br/><span class="hl-8">// funcion patch que actualiza un cliente en la base de datos</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;PATCH /customers&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para actualizar un cliente en la base de datos, debería devolver un cliente</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should update a customer in the database&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">`/customers/</span><span class="hl-4">${</span><span class="hl-5">firstCustomer</span><span class="hl-17">.</span><span class="hl-5">nif</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;female&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;genre&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;female&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para actualizar un cliente que no existe en la base de datos, debería devolver un error 404</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return a 404 error if the customer does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/12345678A&#39;</span><span class="hl-0">).</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;female&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba para actualizar parcialmente un cliente en la base de datos</span><br/><span class="hl-0"> </span><span class="hl-8">// se actualiza el apellido de un cliente, debería devolver un cliente con el apellido actualizado</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should partially update a customer in the database&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     </span><span class="hl-8">// se envía una petición PATCH a la ruta /customers con el apellido a actualizar</span><br/><span class="hl-0">     .</span><span class="hl-1">patch</span><span class="hl-0">(</span><span class="hl-2">`/customers/</span><span class="hl-4">${</span><span class="hl-5">firstCustomer</span><span class="hl-17">.</span><span class="hl-5">nif</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">({ </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&#39;Updated&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0"> </span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;surname&#39;</span><span class="hl-0">, </span><span class="hl-2">&#39;Updated&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;name&#39;</span><span class="hl-0">, </span><span class="hl-5">firstCustomer</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Pruebas para la API de clientes.</span><br/><span class="hl-8">// funcion delete que borra un cliente de la base de datos</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;DELETE /customers&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para borrar un cliente de la base de datos, debería devolver un 200</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should delete a customer from the database&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// se envía una petición DELETE a la ruta /customers con el NIF del cliente a borrar</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">`/customers/</span><span class="hl-4">${</span><span class="hl-5">firstCustomer</span><span class="hl-17">.</span><span class="hl-5">nif</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">deletedCustomer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">findOne</span><span class="hl-0">({ </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-5">firstCustomer</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0"> });</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">deletedCustomer</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">be</span><span class="hl-0">.</span><span class="hl-5">null</span><span class="hl-0">;</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para borrar un cliente que no existe en la base de datos, debería devolver un error 404</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return a 404 error if the customer does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">res</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">).</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">&#39;/customers/12345678A&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">res</span><span class="hl-0">.</span><span class="hl-5">status</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Pruebas para el esquema de clientes.</span><br/><span class="hl-8">// se utiliza para validar los datos de los clientes</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;Customer Schema&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// prueba para validar que el nombre de un cliente no esté vacío</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return an error if the NIF of a customer is empty&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">create</span><span class="hl-0">({ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&#39;&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0">   } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">err</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">err</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;ValidationError&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba para validar que el NIF de un cliente tenga 9 caracteres</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return an error if the NIF of a customer does not have 9 characters&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">create</span><span class="hl-0">({ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&#39;12345678&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0">   } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">err</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">err</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;ValidationError&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba para validar que el NIF de un cliente tenga un formato válido</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return an error if the NIF of a customer does not have a valid format&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">create</span><span class="hl-0">({ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&#39;12345678a&#39;</span><span class="hl-0"> }); </span><br/><span class="hl-0">   } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">err</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">err</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;ValidationError&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0"> });</span><br/><span class="hl-0"> </span><br/><span class="hl-0"> </span><span class="hl-8">// prueba para validar que el género de un cliente sea válido</span><br/><span class="hl-0"> </span><span class="hl-8">// debera ser masculino o femenino</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;Should return an error if the genre of a customer is not valid&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">try</span><span class="hl-0"> {</span><br/><span class="hl-0">     </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">create</span><span class="hl-0">({ </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&quot;Test&quot;</span><span class="hl-0">, </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&#39;123456789&#39;</span><span class="hl-0">, </span><span class="hl-5">genre:</span><span class="hl-0"> </span><span class="hl-2">&#39;invalid&#39;</span><span class="hl-0"> });</span><br/><span class="hl-0">   } </span><span class="hl-6">catch</span><span class="hl-0"> (</span><span class="hl-5">err</span><span class="hl-0">) {</span><br/><span class="hl-0">     </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">err</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;ValidationError&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   }</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:descripción-general-8" class="tsd-anchor"></a><h4><a href="#md:descripción-general-8">Descripción General</a></h4><p>El script proporciona pruebas automatizadas para las siguientes funcionalidades:</p>
<ol>
<li><strong>Conexión a la base de datos</strong>: Establece y cierra la conexión a la base de datos antes y después de las pruebas.</li>
<li><strong>Operaciones CRUD</strong>: Pruebas para las operaciones de creación, obtención, actualización y eliminación de clientes.</li>
<li><strong>Validación del esquema</strong>: Pruebas para asegurar que los datos del cliente cumplen con las restricciones del esquema.</li>
</ol>
<a id="md:detalles-del-código-8" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-8">Detalles del Código</a></h4><a id="md:importación-de-dependencias-3" class="tsd-anchor"></a><h5><a href="#md:importación-de-dependencias-3">Importación de Dependencias</a></h5><p>El script comienza importando Mocha, Chai, Supertest, la aplicación Express, el modelo de Cliente, y las funciones de conexión y cierre de la base de datos.</p>
<a id="md:declaración-de-clientes-de-prueba" class="tsd-anchor"></a><h5><a href="#md:declaración-de-clientes-de-prueba">Declaración de Clientes de Prueba</a></h5><p>Se definen tres clientes de prueba que se utilizarán en las diferentes pruebas.</p>
<a id="md:hooks-para-configuración-y-limpieza" class="tsd-anchor"></a><h5><a href="#md:hooks-para-configuración-y-limpieza">Hooks para Configuración y Limpieza</a></h5><p>Se definen hooks que se ejecutan antes y después de todas las pruebas:</p>
<ul>
<li><strong>before</strong>: Conecta a la base de datos antes de ejecutar cualquier prueba.</li>
<li><strong>after</strong>: Cierra la conexión a la base de datos después de ejecutar todas las pruebas.</li>
</ul>
<p>Hooks que se ejecutan antes y después de cada prueba individual:</p>
<ul>
<li><strong>beforeEach</strong>: Borra todos los clientes de la base de datos y añade los clientes de prueba antes de cada prueba.</li>
<li><strong>afterEach</strong>: Borra todos los clientes de la base de datos después de cada prueba.</li>
</ul>
<a id="md:pruebas-get" class="tsd-anchor"></a><h5><a href="#md:pruebas-get">Pruebas GET</a></h5><ul>
<li><strong>Obtener todos los clientes</strong>: Verifica que se pueden obtener todos los clientes y que el número de clientes es 3.</li>
<li><strong>Obtener un cliente por NIF</strong>: Verifica que se puede obtener un cliente específico por su NIF.</li>
<li><strong>Cliente no encontrado</strong>: Verifica que se devuelve un error 404 si no se encuentra un cliente con el NIF proporcionado.</li>
</ul>
<a id="md:pruebas-post" class="tsd-anchor"></a><h5><a href="#md:pruebas-post">Pruebas POST</a></h5><ul>
<li><strong>Guardar un cliente</strong>: Verifica que se puede guardar un nuevo cliente en la base de datos.</li>
<li><strong>Cliente ya existente</strong>: Verifica que se devuelve un error 500 si se intenta guardar un cliente que ya existe en la base de datos.</li>
</ul>
<a id="md:pruebas-patch" class="tsd-anchor"></a><h5><a href="#md:pruebas-patch">Pruebas PATCH</a></h5><ul>
<li><strong>Actualizar un cliente</strong>: Verifica que se puede actualizar un cliente existente en la base de datos.</li>
<li><strong>Cliente no encontrado para actualizar</strong>: Verifica que se devuelve un error 404 si se intenta actualizar un cliente que no existe.</li>
<li><strong>Actualización parcial de un cliente</strong>: Verifica que se puede actualizar parcialmente un cliente en la base de datos.</li>
</ul>
<a id="md:pruebas-delete" class="tsd-anchor"></a><h5><a href="#md:pruebas-delete">Pruebas DELETE</a></h5><ul>
<li><strong>Borrar un cliente</strong>: Verifica que se puede borrar un cliente de la base de datos.</li>
<li><strong>Cliente no encontrado para borrar</strong>: Verifica que se devuelve un error 404 si se intenta borrar un cliente que no existe.</li>
</ul>
<a id="md:pruebas-del-esquema-de-cliente" class="tsd-anchor"></a><h5><a href="#md:pruebas-del-esquema-de-cliente">Pruebas del Esquema de Cliente</a></h5><ul>
<li><strong>Validar NIF vacío</strong>: Verifica que se devuelve un error si el NIF de un cliente está vacío.</li>
<li><strong>Validar longitud del NIF</strong>: Verifica que se devuelve un error si el NIF de un cliente no tiene 9 caracteres.</li>
<li><strong>Validar formato del NIF</strong>: Verifica que se devuelve un error si el NIF de un cliente no tiene un formato válido.</li>
<li><strong>Validar género del cliente</strong>: Verifica que se devuelve un error si el género de un cliente no es válido.</li>
</ul>
<a id="md:resumen-8" class="tsd-anchor"></a><h4><a href="#md:resumen-8">Resumen</a></h4><ul>
<li><strong>Conexión y Limpieza</strong>: Establece y cierra la conexión a la base de datos, y limpia los datos antes y después de las pruebas.</li>
<li><strong>Pruebas CRUD</strong>: Valida las operaciones de creación, obtención, actualización y eliminación de clientes.</li>
<li><strong>Validación del Esquema</strong>: Asegura que los datos del cliente cumplen con las restricciones del esquema.</li>
</ul>
<p>Este conjunto de pruebas es esencial para garantizar que la API de clientes funcione correctamente y que los datos almacenados cumplan con los requisitos establecidos.</p>
<a id="md:furniturespects" class="tsd-anchor"></a><h3><a href="#md:furniturespects">Furniture.spec.ts</a></h3><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">&quot;mocha&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">expect</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;chai&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">request</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;supertest&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">app</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../src/index.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Furniture</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&quot;../src/models/furnitures.js&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">connectDB</span><span class="hl-0">, </span><span class="hl-5">closeDB</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/db/database.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">// declaramos muebles de prueba con sus respectivos datos</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">firstFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Mesa&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">10</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">secondFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Silla&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">50</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">20</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;office&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">thirdFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0"> </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&quot;Armario&quot;</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">200</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0"> </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">};</span><br/><br/><span class="hl-8">// declaramos los hooks, son funciones que se ejecutan antes y después de los tests</span><br/><span class="hl-8">// este es utilizado para conectarse a la base de datos antes de los tests</span><br/><span class="hl-1">before</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-4">function</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">connectDB</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// este es utilizado para cerrar la conexión a la base de datos después de los tests</span><br/><span class="hl-1">after</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> </span><span class="hl-4">function</span><span class="hl-0"> (</span><span class="hl-5">done</span><span class="hl-0">) {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">closeDB</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-1">done</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// este se utiliza para insertar los muebles de prueba en la base de datos antes de cada test</span><br/><span class="hl-1">beforeEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">(</span><span class="hl-5">firstFurniture</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">(</span><span class="hl-5">secondFurniture</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">(</span><span class="hl-5">thirdFurniture</span><span class="hl-0">).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// este es utilizado para borrar todos los muebles de la base de datos después de cada test</span><br/><span class="hl-1">afterEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-8">// Tests de integración para la API de muebles</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;Furniture API&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// prueba que crea un nuevo mueble en la base de datos</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should create a new furniture&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-8">// enviamos la petición POST para crear un nuevo mueble</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// comprobamos que el nombre del mueble creado sea el mismo que el enviado</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newFurniture</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al crear un mueble sin nombre</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to create a furniture without a name&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Name is required&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al crear un mueble con una categoría inválida</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to create a furniture with invalid category&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;invalid_category&#39;</span><span class="hl-0"> </span><span class="hl-8">// categoría inválida</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Invalid category&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al crear un mueble con stock negativo</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to create a furniture with negative stock&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> -</span><span class="hl-9">5</span><span class="hl-0">, </span><span class="hl-8">// stock negativo</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Stock cannot be negative&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que actualiza un mueble en la base de datos por su id</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should update a furniture by id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">updatedFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro grande&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">200</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">10</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">put</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/</span><span class="hl-4">${</span><span class="hl-5">furniture</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">updatedFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// comporbamos que los datos del mueble actualizado sean los mismos que los enviados</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">updatedFurniture</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">price</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">updatedFurniture</span><span class="hl-0">.</span><span class="hl-5">price</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">stock</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">updatedFurniture</span><span class="hl-0">.</span><span class="hl-5">stock</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al actualizar un mueble con un id inexistente</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to update a furniture with non-existent id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">updatedFurniture</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro grande&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">200</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">10</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">put</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/1234567890abcdef12345678`</span><span class="hl-0">) </span><span class="hl-8">// id inexistente</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">updatedFurniture</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Furniture not found&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que obtiene todos los muebles de la base de datos</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get all furnitures&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/furnitures&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// comprobamos que la respuesta tenga 3 muebles</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">lengthOf</span><span class="hl-0">(</span><span class="hl-9">3</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al obtener un mueble con un id inexistente</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to get a furniture with non-existent id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/1234567890abcdef12345678`</span><span class="hl-0">) </span><span class="hl-8">// id inexistente</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Furniture not found&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba para asegurarnos que no devuelve algo inexistente</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get a furniture by id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/</span><span class="hl-4">${</span><span class="hl-5">furniture</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// comprobamos que el nombre del mueble obtenido sea el mismo que el creado</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que elimina un mueble de la base de datos por su id</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should delete a furniture by id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Mesa de centro&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">price:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">stock:</span><span class="hl-0"> </span><span class="hl-9">5</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/</span><span class="hl-4">${</span><span class="hl-5">furniture</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">); </span><br/><span class="hl-0">   </span><span class="hl-8">// comprobamos que el nombre del mueble eliminado sea el mismo que el creado</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// prueba que falla al eliminar un mueble con un id inexistente</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should fail to delete a furniture with non-existent id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">`/furnitures/1234567890abcdef12345678`</span><span class="hl-0">) </span><span class="hl-8">// id inexistente</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">404</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Furniture not found&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:creación-de-muebles" class="tsd-anchor"></a><h4><a href="#md:creación-de-muebles">Creación de Muebles</a></h4><ul>
<li><code>should create a new furniture</code>: Prueba que crea un nuevo mueble en la base de datos.</li>
<li><code>should fail to create a furniture without a name</code>: Prueba que falla al crear un mueble sin nombre.</li>
<li><code>should fail to create a furniture with invalid category</code>: Prueba que falla al crear un mueble con una categoría inválida.</li>
<li><code>should fail to create a furniture with negative stock</code>: Prueba que falla al crear un mueble con stock negativo.</li>
</ul>
<a id="md:actualización-de-muebles" class="tsd-anchor"></a><h4><a href="#md:actualización-de-muebles">Actualización de Muebles</a></h4><ul>
<li><code>should update a furniture by id</code>: Prueba que actualiza un mueble en la base de datos por su id.</li>
<li><code>should fail to update a furniture with non-existent id</code>: Prueba que falla al actualizar un mueble con un id inexistente.</li>
</ul>
<a id="md:obtención-de-muebles" class="tsd-anchor"></a><h4><a href="#md:obtención-de-muebles">Obtención de Muebles</a></h4><ul>
<li><code>should get all furnitures</code>: Prueba que obtiene todos los muebles de la base de datos.</li>
<li><code>should fail to get a furniture with non-existent id</code>: Prueba que falla al obtener un mueble con un id inexistente.</li>
<li><code>should get a furniture by id</code>: Prueba que obtiene un mueble de la base de datos por su id.</li>
</ul>
<a id="md:eliminación-de-muebles" class="tsd-anchor"></a><h4><a href="#md:eliminación-de-muebles">Eliminación de Muebles</a></h4><ul>
<li><code>should delete a furniture by id</code>: Prueba que elimina un mueble de la base de datos por su id.</li>
<li><code>should fail to delete a furniture with non-existent id</code>: Prueba que falla al eliminar un mueble con un id inexistente.</li>
</ul>
<a id="md:providerspects" class="tsd-anchor"></a><h3><a href="#md:providerspects">Provider.spec.ts</a></h3><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">&quot;mocha&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">expect</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">request</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;supertest&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;mongoose&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">app</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/index.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Provider</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/providers.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8">* Pruebas de integración para la API de proveedores</span><br/><span class="hl-8">*/</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;Provider API&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0"> </span><span class="hl-8">// Antes de todas las pruebas, nos conectamos a la base de datos</span><br/><span class="hl-0"> </span><span class="hl-1">before</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">url</span><span class="hl-0"> = </span><span class="hl-2">&#39;mongodb://127.0.0.1/provider_test&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-1">connect</span><span class="hl-0">(</span><span class="hl-5">url</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Después de todas las pruebas, eliminamos la base de datos y cerramos la conexión</span><br/><span class="hl-0"> </span><span class="hl-1">after</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">connection</span><span class="hl-0">.</span><span class="hl-1">dropDatabase</span><span class="hl-0">();</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">connection</span><span class="hl-0">.</span><span class="hl-1">close</span><span class="hl-0">();</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Antes de cada prueba, eliminamos todos los proveedores</span><br/><span class="hl-0"> </span><span class="hl-1">afterEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Pruebas</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should create a new provider&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor de ejemplo</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><span class="hl-0">   </span><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que el proveedor se ha creado correctamente</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;_id&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que los datos del proveedor son correctos</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se obtienen todos los proveedores</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get a list of providers&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos dos proveedores de ejemplo</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">providers</span><span class="hl-0"> = [</span><br/><span class="hl-0">     { </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">, </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor 1&#39;</span><span class="hl-0">, </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle 1&#39;</span><span class="hl-0">, </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">, </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><span class="hl-0"> },</span><br/><span class="hl-0">     { </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567C&#39;</span><span class="hl-0">, </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor 2&#39;</span><span class="hl-0">, </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle 2&#39;</span><span class="hl-0">, </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345679</span><span class="hl-0">, </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;office&#39;</span><span class="hl-0"> }</span><br/><span class="hl-0">   ];</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Insertamos los proveedores en la base de datos</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">insertMany</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición GET para obtener todos los proveedores</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que se han obtenido los dos proveedores</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">2</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que los datos de los proveedores son correctos</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">address</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">address</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">address</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">address</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">phone</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">phone</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">phone</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">phone</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">category</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">providers</span><span class="hl-0">[</span><span class="hl-9">1</span><span class="hl-0">].</span><span class="hl-5">category</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se obtiene un proveedor por su id</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get a provider by id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor de ejemplo</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Provider</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Guardamos el proveedor en la base de datos</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición GET para obtener el proveedor por su id</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">`/providers/</span><span class="hl-4">${</span><span class="hl-5">provider</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que los datos del proveedor son correctos</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se actualiza un proveedor</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should update a provider&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor de ejemplo</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Provider</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Guardamos el proveedor en la base de datos</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Datos a actualizar</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">updates</span><span class="hl-0"> = { </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Actualizado&#39;</span><span class="hl-0">, </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;office&#39;</span><span class="hl-0"> };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición PUT para actualizar el proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">put</span><span class="hl-0">(</span><span class="hl-2">`/providers/</span><span class="hl-4">${</span><span class="hl-5">provider</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">updates</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que los datos del proveedor se han actualizado correctamente</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">updates</span><span class="hl-0">.</span><span class="hl-5">name</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">updates</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">address</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">phone</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se elimina un proveedor</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should delete a provider&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor de ejemplo</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Provider</span><span class="hl-0">({</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Guardamos el proveedor en la base de datos</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición DELETE para eliminar el proveedor</span><br/><span class="hl-0">   </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">`/providers/</span><span class="hl-4">${</span><span class="hl-5">provider</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">204</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que el proveedor se ha eliminado correctamente</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">foundProvider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">);</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">foundProvider</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">be</span><span class="hl-0">.</span><span class="hl-5">null</span><span class="hl-0">;</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Pruebas para errores</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 if required fields are missing&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor con datos incompletos</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><br/><span class="hl-0">   };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que se ha devuelto un error</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">not</span><span class="hl-0">.</span><span class="hl-5">be</span><span class="hl-0">.</span><span class="hl-5">null</span><span class="hl-0">;</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se devuelve un error si el CIF ya existe</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 for invalid CIF format&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor con un CIF inválido</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;INVALIDCIF&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que se ha devuelto un error</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;El Código de Identificación Fiscal no es válido&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se devuelve un error si el CIF ya existe</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 for invalid phone number&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor con un número de teléfono inválido</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">123</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><br/><span class="hl-0">   };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que se ha devuelto un error</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;Número de teléfono válido&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se devuelve un error si no se proporciona una categoría</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should set default category to &quot;other&quot; if not provided&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor sin categoría</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><br/><span class="hl-0">   };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que la categoría por defecto es &quot;other&quot;</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">category</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;other&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><br/><span class="hl-0"> </span><span class="hl-8">// Prueba para comprobar que se devuelve un error si la categoría no es válida</span><br/><span class="hl-0"> </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 for invalid category value&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">   </span><span class="hl-8">// Creamos un proveedor con una categoría inválida</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newProvider</span><span class="hl-0"> = {</span><br/><span class="hl-0">     </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Proveedor Ejemplo&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Calle Falsa 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><span class="hl-0">,</span><br/><span class="hl-0">     </span><span class="hl-5">category:</span><span class="hl-0"> </span><span class="hl-2">&#39;invalidcategory&#39;</span><br/><span class="hl-0">   };</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Enviamos la petición POST para crear un nuevo proveedor</span><br/><span class="hl-0">   </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/providers&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newProvider</span><span class="hl-0">)</span><br/><span class="hl-0">     .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">   </span><span class="hl-8">// Comprobamos que se ha devuelto un error</span><br/><span class="hl-0">   </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-2">&#39;`invalidcategory` is not a valid enum value for path `category`.&#39;</span><span class="hl-0">);</span><br/><span class="hl-0"> });</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:creación-de-proveedores" class="tsd-anchor"></a><h4><a href="#md:creación-de-proveedores">Creación de Proveedores</a></h4><ul>
<li><code>should create a new provider</code>: Prueba que crea un nuevo proveedor en la base de datos.</li>
<li><code>should return 400 if required fields are missing</code>: Prueba que devuelve un error si faltan campos obligatorios al crear un proveedor.</li>
<li><code>should return 400 for invalid CIF format</code>: Prueba que devuelve un error si el formato del CIF es inválido.</li>
<li><code>should return 400 for invalid phone number</code>: Prueba que devuelve un error si el número de teléfono es inválido.</li>
<li><code>should set default category to &quot;other&quot; if not provided</code>: Prueba que establece la categoría predeterminada como &quot;otra&quot; si no se proporciona ninguna.</li>
<li><code>should return 400 for invalid category value</code>: Prueba que devuelve un error si el valor de la categoría es inválido.</li>
</ul>
<a id="md:obtención-de-proveedores" class="tsd-anchor"></a><h4><a href="#md:obtención-de-proveedores">Obtención de Proveedores</a></h4><ul>
<li><code>should get a list of providers</code>: Prueba que obtiene una lista de todos los proveedores de la base de datos.</li>
<li><code>should get a provider by id</code>: Prueba que obtiene un proveedor de la base de datos por su id.</li>
</ul>
<a id="md:actualización-de-proveedores" class="tsd-anchor"></a><h4><a href="#md:actualización-de-proveedores">Actualización de Proveedores</a></h4><ul>
<li><code>should update a provider</code>: Prueba que actualiza un proveedor en la base de datos.</li>
</ul>
<a id="md:eliminación-de-proveedores" class="tsd-anchor"></a><h4><a href="#md:eliminación-de-proveedores">Eliminación de Proveedores</a></h4><ul>
<li><code>should delete a provider</code>: Prueba que elimina un proveedor de la base de datos.</li>
</ul>
<a id="md:transactionspects" class="tsd-anchor"></a><h3><a href="#md:transactionspects">Transaction.spec.ts</a></h3><pre><code class="language-typescript"><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">expect</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-2">&quot;mocha&quot;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">request</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;supertest&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">app</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/index.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0"> </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;mongoose&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Transaction</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/transactions.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Furniture</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/furnitures.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Provider</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/providers.js&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">import</span><span class="hl-0"> { </span><span class="hl-5">Customer</span><span class="hl-0"> } </span><span class="hl-6">from</span><span class="hl-0"> </span><span class="hl-2">&#39;../src/models/customers.js&#39;</span><span class="hl-0">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Pruebas para el API de transacciones.</span><br/><span class="hl-8"> */</span><br/><span class="hl-1">describe</span><span class="hl-0">(</span><span class="hl-2">&#39;Transactions API&#39;</span><span class="hl-0">, () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-8">// Antes de todas las pruebas, nos conectamos a la base de datos.</span><br/><span class="hl-0">  </span><span class="hl-1">before</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">url</span><span class="hl-0"> = </span><span class="hl-2">&#39;mongodb://127.0.0.1/transactions_test&#39;</span><span class="hl-0">;</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-1">connect</span><span class="hl-0">(</span><span class="hl-5">url</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Después de todas las pruebas, eliminamos la base de datos y cerramos la conexión.</span><br/><span class="hl-0">  </span><span class="hl-1">after</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">connection</span><span class="hl-0">.</span><span class="hl-1">dropDatabase</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">connection</span><span class="hl-0">.</span><span class="hl-1">close</span><span class="hl-0">();</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Antes de cada prueba, eliminamos todos los documentos de las colecciones.</span><br/><span class="hl-0">  </span><span class="hl-1">afterEach</span><span class="hl-0">(</span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Furniture</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Provider</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Customer</span><span class="hl-0">.</span><span class="hl-1">deleteMany</span><span class="hl-0">();</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para crear una nueva transacción.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should create a new transaction&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos un mueble, un proveedor y un</span><br/><span class="hl-0">    </span><span class="hl-8">// cliente para poder crear una transacción.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Chair&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-9">50</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-9">2</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-9">150</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">provider</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Provider</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">cif:</span><span class="hl-0"> </span><span class="hl-2">&#39;A1234567B&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Provider One&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">address:</span><span class="hl-0"> </span><span class="hl-2">&#39;Some Street 123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">phone:</span><span class="hl-0"> </span><span class="hl-9">912345678</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">customer</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Customer</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">surname:</span><span class="hl-0"> </span><span class="hl-2">&#39;Smith&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;John&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">nif:</span><span class="hl-0"> </span><span class="hl-2">&#39;12345678A&#39;</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una nueva transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newTransaction</span><span class="hl-0"> = {</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">providerCIF:</span><span class="hl-0"> </span><span class="hl-5">provider</span><span class="hl-0">.</span><span class="hl-5">cif</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">customerNIF:</span><span class="hl-0"> </span><span class="hl-5">customer</span><span class="hl-0">.</span><span class="hl-5">nif</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">200</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">_id</span><br/><span class="hl-0">    };</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newTransaction</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">201</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que la transacción se haya creado correctamente.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">have</span><span class="hl-0">.</span><span class="hl-1">property</span><span class="hl-0">(</span><span class="hl-2">&#39;_id&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">type</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">newTransaction</span><span class="hl-0">.</span><span class="hl-5">type</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get all transactions&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una transacción de compra.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Transaction</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;purchase&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">500</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto es válido</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que la transacción se haya creado correctamente.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">length</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-9">1</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que los datos de la transacción sean correctos.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">moneyAmount</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">type</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">type</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">[</span><span class="hl-9">0</span><span class="hl-0">].</span><span class="hl-5">furnitureID</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">furnitureID</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">());</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para obtener una transacción por su id.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should get a transaction by id&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Transaction</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">300</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto es válido</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">get</span><span class="hl-0">(</span><span class="hl-2">`/transactions/</span><span class="hl-4">${</span><span class="hl-5">transaction</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que la transacción se haya creado correctamente y que los datos sean correctos.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">type</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">type</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">furnitureID</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">furnitureID</span><span class="hl-0">.</span><span class="hl-1">toString</span><span class="hl-0">());</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para eliminar una transacción.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should delete a transaction&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una transacción de compra.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Transaction</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;purchase&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">500</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto es válido</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">delete</span><span class="hl-0">(</span><span class="hl-2">`/transactions/</span><span class="hl-4">${</span><span class="hl-5">transaction</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">204</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que la transacción se haya eliminado correctamente.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">deletedTransaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-5">Transaction</span><span class="hl-0">.</span><span class="hl-1">findById</span><span class="hl-0">(</span><span class="hl-5">transaction</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">deletedTransaction</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-5">be</span><span class="hl-0">.</span><span class="hl-5">null</span><span class="hl-0">;</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para actualizar una transacción.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should update a transaction&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">transaction</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Transaction</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">150</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto es válido</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Actualizamos la cantidad de dinero de la transacción.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">update</span><span class="hl-0"> = { </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">250</span><span class="hl-0"> };</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">put</span><span class="hl-0">(</span><span class="hl-2">`/transactions/</span><span class="hl-4">${</span><span class="hl-5">transaction</span><span class="hl-17">.</span><span class="hl-5">_id</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">update</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">200</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que la transacción se haya actualizado correctamente.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">equal</span><span class="hl-0">(</span><span class="hl-5">update</span><span class="hl-0">.</span><span class="hl-5">moneyAmount</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Pruebas para comprobar los errores.</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para comprobar que se devuelve un error 404 si no se encuentra la transacción.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 if referenced furnitureID does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newTransaction</span><span class="hl-0"> = {</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Esto no existe</span><br/><span class="hl-0">    };</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newTransaction</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que se haya devuelto un error 404.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">include</span><span class="hl-0">(</span><span class="hl-2">&#39;validation failed&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para comprobar que se devuelve un error 400 si no se encuentra el proveedor.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 if referenced providerID does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos un mueble para poder crear una transacción.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Chair&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-9">50</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-9">2</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-9">150</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una nueva transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newTransaction</span><span class="hl-0"> = {</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">providerID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto no existe</span><br/><span class="hl-0">    };</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newTransaction</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que se haya devuelto un error 400.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">include</span><span class="hl-0">(</span><span class="hl-2">&#39;validation failed&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Prueba para comprobar que se devuelve un error 400 si no se encuentra el cliente.</span><br/><span class="hl-0">  </span><span class="hl-1">it</span><span class="hl-0">(</span><span class="hl-2">&#39;should return 400 if referenced customerID does not exist&#39;</span><span class="hl-0">, </span><span class="hl-4">async</span><span class="hl-0"> () </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-8">// Creamos un mueble para poder crear una transacción.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">furniture</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-1">Furniture</span><span class="hl-0">({</span><br/><span class="hl-0">      </span><span class="hl-5">name:</span><span class="hl-0"> </span><span class="hl-2">&#39;Chair&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">material:</span><span class="hl-0"> </span><span class="hl-2">&#39;wood&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">height:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">width:</span><span class="hl-0"> </span><span class="hl-9">50</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">warranty:</span><span class="hl-0"> </span><span class="hl-9">2</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">prize:</span><span class="hl-0"> </span><span class="hl-9">150</span><br/><span class="hl-0">    }).</span><span class="hl-1">save</span><span class="hl-0">();</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Creamos una nueva transacción de venta.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">newTransaction</span><span class="hl-0"> = {</span><br/><span class="hl-0">      </span><span class="hl-5">type:</span><span class="hl-0"> </span><span class="hl-2">&#39;sell&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">productCode:</span><span class="hl-0"> </span><span class="hl-2">&#39;C123&#39;</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">moneyAmount:</span><span class="hl-0"> </span><span class="hl-9">100</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">furnitureID:</span><span class="hl-0"> </span><span class="hl-5">furniture</span><span class="hl-0">.</span><span class="hl-5">_id</span><span class="hl-0">,</span><br/><span class="hl-0">      </span><span class="hl-5">customerID:</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">mongoose</span><span class="hl-0">.</span><span class="hl-5">Types</span><span class="hl-0">.</span><span class="hl-1">ObjectId</span><span class="hl-0">() </span><span class="hl-8">// Asume que esto no existe</span><br/><span class="hl-0">    };</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Enviamos la petición al servidor.</span><br/><span class="hl-0">    </span><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-10">response</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-1">request</span><span class="hl-0">(</span><span class="hl-5">app</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">post</span><span class="hl-0">(</span><span class="hl-2">&#39;/transactions&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">send</span><span class="hl-0">(</span><span class="hl-5">newTransaction</span><span class="hl-0">)</span><br/><span class="hl-0">      .</span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-9">400</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-8">// Verificamos que se haya devuelto un error 400.</span><br/><span class="hl-0">    </span><span class="hl-1">expect</span><span class="hl-0">(</span><span class="hl-5">response</span><span class="hl-0">.</span><span class="hl-5">body</span><span class="hl-0">.</span><span class="hl-5">message</span><span class="hl-0">).</span><span class="hl-5">to</span><span class="hl-0">.</span><span class="hl-1">include</span><span class="hl-0">(</span><span class="hl-2">&#39;validation failed&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<a id="md:detalles-del-código-9" class="tsd-anchor"></a><h4><a href="#md:detalles-del-código-9">Detalles del Código</a></h4><a id="md:importación-de-dependencias-4" class="tsd-anchor"></a><h5><a href="#md:importación-de-dependencias-4">Importación de Dependencias</a></h5><p>El script comienza importando Mocha, Chai, Supertest, la aplicación Express, Mongoose, y los modelos de Transacción, Mueble, Proveedor y Cliente.</p>
<a id="md:hooks-para-configuración-y-limpieza-1" class="tsd-anchor"></a><h5><a href="#md:hooks-para-configuración-y-limpieza-1">Hooks para Configuración y Limpieza</a></h5><p>Se definen hooks que se ejecutan antes y después de todas las pruebas:</p>
<ul>
<li><strong>before</strong>: Conecta a la base de datos antes de ejecutar cualquier prueba.</li>
<li><strong>after</strong>: Elimina la base de datos y cierra la conexión después de ejecutar todas las pruebas.</li>
</ul>
<p>Hook que se ejecuta después de cada prueba individual:</p>
<ul>
<li><strong>afterEach</strong>: Borra todos los documentos de las colecciones después de cada prueba.</li>
</ul>
<a id="md:pruebas-post-1" class="tsd-anchor"></a><h5><a href="#md:pruebas-post-1">Pruebas POST</a></h5><ul>
<li><strong>Crear una nueva transacción</strong>: Verifica que se puede crear una nueva transacción en la base de datos, asociando un mueble, un proveedor y un cliente.</li>
</ul>
<a id="md:pruebas-get-1" class="tsd-anchor"></a><h5><a href="#md:pruebas-get-1">Pruebas GET</a></h5><ul>
<li><strong>Obtener todas las transacciones</strong>: Verifica que se pueden obtener todas las transacciones almacenadas en la base de datos.</li>
<li><strong>Obtener una transacción por ID</strong>: Verifica que se puede obtener una transacción específica utilizando su ID.</li>
</ul>
<a id="md:pruebas-delete-1" class="tsd-anchor"></a><h5><a href="#md:pruebas-delete-1">Pruebas DELETE</a></h5><ul>
<li><strong>Eliminar una transacción</strong>: Verifica que se puede eliminar una transacción de la base de datos.</li>
</ul>
<a id="md:pruebas-put" class="tsd-anchor"></a><h5><a href="#md:pruebas-put">Pruebas PUT</a></h5><ul>
<li><strong>Actualizar una transacción</strong>: Verifica que se puede actualizar una transacción en la base de datos.</li>
</ul>
<a id="md:pruebas-de-validación-de-referencias" class="tsd-anchor"></a><h5><a href="#md:pruebas-de-validación-de-referencias">Pruebas de Validación de Referencias</a></h5><ul>
<li><strong>Referencia inválida de mueble</strong>: Verifica que se devuelve un error 400 si el <code>furnitureID</code> referenciado no existe.</li>
<li><strong>Referencia inválida de proveedor</strong>: Verifica que se devuelve un error 400 si el <code>providerID</code> referenciado no existe.</li>
<li><strong>Referencia inválida de cliente</strong>: Verifica que se devuelve un error 400 si el <code>customerID</code> referenciado no existe.</li>
</ul>
<a id="md:resumen-9" class="tsd-anchor"></a><h4><a href="#md:resumen-9">Resumen</a></h4><ul>
<li><strong>Conexión y Limpieza</strong>: Establece y cierra la conexión a la base de datos, y limpia los datos después de las pruebas.</li>
<li><strong>Pruebas CRUD</strong>: Valida las operaciones de creación, obtención, actualización y eliminación de transacciones.</li>
<li><strong>Validación de Referencias</strong>: Asegura que las referencias a otros documentos son válidas y existentes.</li>
</ul>
<p>Este conjunto de pruebas es esencial para garantizar que la API de transacciones funcione correctamente y que las relaciones entre documentos se manejen de manera adecuada en una aplicación Node.js.</p>
<a id="md:11-conclusion" class="tsd-anchor"></a><h1><a href="#md:11-conclusion">11. Conclusion.</a></h1><p>Este proyecto se centró en el desarrollo de una API RESTful utilizando Node.js, Express y Mongoose para gestionar diversas entidades, tales como Clientes, Muebles, Proveedores y Transacciones en una base de datos MongoDB. El objetivo principal fue proporcionar una infraestructura robusta para realizar operaciones CRUD (Crear, Leer, Actualizar y Eliminar) sobre estas entidades, asegurando la integridad y la validación de los datos. Se definieron esquemas detallados para cada entidad, incluyendo validaciones específicas para cada campo y referencias entre entidades cuando fue necesario. Se implementaron rutas y controladores para manejar las operaciones CRUD, asegurando que las solicitudes HTTP se manejaran de manera estructurada y eficiente. Además, se realizaron pruebas exhaustivas utilizando Mocha, Chai y Supertest para verificar el correcto funcionamiento de las operaciones y la validación de los datos. A través de estas pruebas, se identificaron y solucionaron varios problemas, mejorando la confiabilidad y estabilidad del sistema.</p>
<p>El proyecto logró una implementación sólida de la API RESTful, cumpliendo con los requisitos de gestión de datos y operaciones CRUD. Se garantizó la integridad de los datos mediante esquemas detallados y validaciones robustas. Los retos significativos incluyeron la gestión de referencias entre entidades y la realización de pruebas de integración. Sin embargo, a través de estos desafíos, se adquirieron importantes aprendizajes y se mejoró la confiabilidad del sistema. Las futuras mejoras sugeridas incluyen la optimización del rendimiento, la implementación de mecanismos de autenticación y autorización para mejorar la seguridad de la API, y la ampliación de la documentación para facilitar el uso y mantenimiento por parte de otros desarrolladores.</p>
<p>Concluimos diciendo que este proyecto proporciona una base sólida para la gestión de datos en una aplicación Node.js, demostrando la efectividad de usar Mongoose para modelar datos en MongoDB y Express para manejar rutas y controladores. Las pruebas exhaustivas aseguran la funcionalidad y confiabilidad de la API, estableciendo un buen punto de partida para futuras mejoras y expansiones.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:práctica-13-api-rest-con-nodeexpress-para-gestionar-una-tienda-de-muebles"><span>Práctica 13: API REST con <wbr/>Node/<wbr/>Express para gestionar una tienda de muebles</span></a><a href="#md:índice"><span>Índice</span></a><a href="#md:1-introducción"><span>1. <wbr/>Introducción.</span></a><a href="#md:2-objetivos"><span>2. <wbr/>Objetivos.</span></a><a href="#md:3-antes-de-empezar"><span>3. <wbr/>Antes de empezar</span></a><ul><li><a href="#md:creación-de-directorios"><span>Creación de directorios.</span></a></li><li><a href="#md:configuración-para-llevar-a-cabo-la-práctica"><span>Configuración para llevar a cabo la práctica:</span></a></li><li><a href="#md:instalación-de-eslint"><span>Instalación de ESlint.</span></a></li><li><a href="#md:typedoc"><span>Typedoc.</span></a></li><li><ul><li><a href="#md:instalación-de-la-herramienta"><span>Instalación de la herramienta.</span></a></li><li><a href="#md:uso-básico"><span>Uso básico.</span></a></li><li><a href="#md:configuración"><span>Configuración.</span></a></li></ul></li><li><a href="#md:mocha-y-chai"><span>mocha y chai</span></a></li><li><ul><li><a href="#md:instalación-de-las-herramientas"><span>Instalación de las herramientas.</span></a></li><li><a href="#md:estructura-de-las-pruebas"><span>Estructura de las pruebas.</span></a></li><li><a href="#md:escribir-las-pruebas"><span>Escribir las pruebas.</span></a></li></ul></li><li><a href="#md:subir-archivos"><span>Subir archivos</span></a></li></ul><a href="#md:4-configuracion-de-istanbul-y-coveralls"><span>4. <wbr/>Configuracion de <wbr/>Istanbul y coveralls.</span></a><ul><li><ul><li><a href="#md:¿que-son"><span>¿<wbr/>Que son?</span></a></li><li><a href="#md:instalación"><span>Instalación</span></a></li><li><a href="#md:inicio-de-sesión-en-coveralls-para-el-cubrimiento-del-código"><span>Inicio de sesión en <wbr/>Coveralls para el cubrimiento del código</span></a></li></ul></li></ul><a href="#md:5-principios-solid"><span>5. <wbr/>Principios SOLID.</span></a><ul><li><a href="#md:¿cuáles-son"><span>¿<wbr/>Cuáles son?</span></a></li><li><ul><li><a href="#md:s---principio-de-responsabilidad-única-single-responsibility-principle---srp"><span>S -<wbr/> <wbr/>Principio de <wbr/>Responsabilidad Única (<wbr/>Single <wbr/>Responsibility <wbr/>Principle -<wbr/> SRP)</span></a></li><li><a href="#md:o---principio-de-abiertocerrado-openclosed-principle---ocp"><span>O -<wbr/> <wbr/>Principio de <wbr/>Abierto/<wbr/>Cerrado (<wbr/>Open/<wbr/>Closed <wbr/>Principle -<wbr/> OCP)</span></a></li><li><a href="#md:l---principio-de-sustitución-de-liskov-liskov-substitution-principle---lsp"><span>L -<wbr/> <wbr/>Principio de <wbr/>Sustitución de <wbr/>Liskov (<wbr/>Liskov <wbr/>Substitution <wbr/>Principle -<wbr/> LSP)</span></a></li><li><a href="#md:i---principio-de-segregación-de-interfaces-interface-segregation-principle---isp"><span>I -<wbr/> <wbr/>Principio de <wbr/>Segregación de <wbr/>Interfaces (<wbr/>Interface <wbr/>Segregation <wbr/>Principle -<wbr/> ISP)</span></a></li><li><a href="#md:d---principio-de-inversión-de-dependencia-dependency-inversion-principle---dip"><span>D -<wbr/> <wbr/>Principio de <wbr/>Inversión de <wbr/>Dependencia (<wbr/>Dependency <wbr/>Inversion <wbr/>Principle -<wbr/> DIP)</span></a></li></ul></li><li><a href="#md:importancia-y-beneficios"><span>Importancia y <wbr/>Beneficios</span></a></li></ul><a href="#md:6-github-actions"><span>6. <wbr/>Git<wbr/>Hub <wbr/>Actions</span></a><ul><li><a href="#md:¿qué-es"><span>¿<wbr/>Qué es?</span></a></li><li><a href="#md:características"><span>Características</span></a></li><li><ul><li><a href="#md:automatización-de-tareas"><span>Automatización de tareas</span></a></li><li><a href="#md:personalización"><span>Personalización</span></a></li><li><a href="#md:eventos-del-repositorio"><span>Eventos del repositorio</span></a></li><li><a href="#md:integración-con-el-ecosistema-de-github"><span>Integración con el ecosistema de <wbr/>Git<wbr/>Hub</span></a></li></ul></li><li><a href="#md:configuración-1"><span>Configuración</span></a></li></ul><a href="#md:7-módulos"><span>7. <wbr/>Módulos</span></a><a href="#md:8-sonarcloud"><span>8. <wbr/>Sonar<wbr/>Cloud</span></a><ul><li><ul><li><a href="#md:¿qué-es-sonarcloud"><span>¿<wbr/>Qué es <wbr/>Sonar<wbr/>Cloud?</span></a></li><li><a href="#md:características-de-sonarcloud"><span>Características de <wbr/>Sonar<wbr/>Cloud:</span></a></li></ul></li><li><a href="#md:configuración-2"><span>Configuración</span></a></li></ul><a href="#md:9-mongodb-y-mongoose"><span>9. <wbr/>Mongodb y <wbr/>Mongoose.</span></a><ul><li><a href="#md:¿qué-es-mongodb"><span>¿<wbr/>Qué es <wbr/>Mongodb?</span></a></li><li><a href="#md:operaciones-crud-en-mongodb"><span>Operaciones CRUD en <wbr/>MongoDB</span></a></li><li><a href="#md:¿qué-es-mongoose"><span>¿<wbr/>Qué es <wbr/>Mongoose?</span></a></li><li><ul><li><a href="#md:características-principales-de-mongoose"><span>Características principales de <wbr/>Mongoose:</span></a></li></ul></li><li><a href="#md:instalación-1"><span>Instalación</span></a></li></ul><a href="#md:10-ejercicio"><span>10. <wbr/>Ejercicio.</span></a><ul><li><a href="#md:enunciado-del-ejercicio"><span>Enunciado del ejercicio.</span></a></li><li><a href="#md:código-propuesto"><span>Código propuesto.</span></a></li><li><ul><li><a href="#md:database"><span>Database</span></a></li><li><ul><li><a href="#md:databasets"><span>Database.ts</span></a></li></ul></li><li><a href="#md:models"><span>Models</span></a></li><li><ul><li><a href="#md:customerts"><span>Customer.ts</span></a></li><li><a href="#md:furniturets"><span>Furniture.ts</span></a></li><li><a href="#md:providerts"><span>Provider.ts</span></a></li><li><a href="#md:transactionsts"><span>Transactions.ts</span></a></li></ul></li><li><a href="#md:routers"><span>Routers</span></a></li><li><ul><li><a href="#md:customerts-1"><span>Customer.ts</span></a></li><li><a href="#md:defaultsts"><span>Defaults.ts</span></a></li><li><a href="#md:furniturets-1"><span>Furniture.ts</span></a></li><li><a href="#md:providerts-1"><span>Provider.ts</span></a></li><li><a href="#md:transactionsts-1"><span>Transactions.ts</span></a></li></ul></li><li><a href="#md:variables"><span>Variables</span></a></li><li><ul><li><a href="#md:typests"><span>Types.ts</span></a></li></ul></li><li><a href="#md:indexts"><span>Index.ts</span></a></li></ul></li><li><a href="#md:explicacion-de-lo-realizado"><span>Explicacion de lo realizado</span></a></li><li><ul><li><a href="#md:database-1"><span>Database</span></a></li><li><ul><li><a href="#md:databasets-1"><span>Database.ts</span></a></li><li><a href="#md:descripción-general"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código"><span>Detalles del <wbr/>Código</span></a></li><li><a href="#md:importación-de-mongoose"><span>Importación de <wbr/>Mongoose</span></a></li><li><a href="#md:función-connectdb"><span>Función connectDB</span></a></li><li><a href="#md:función-closedb"><span>Función closeDB</span></a></li><li><a href="#md:resumen"><span>Resumen</span></a></li></ul></li><li><a href="#md:models-1"><span>Models</span></a></li><li><ul><li><a href="#md:customerts-2"><span>Customer.ts</span></a></li><li><a href="#md:descripción-general-1"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-1"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-mongoose-1"><span>Importación de <wbr/>Mongoose</span></a></li><li><a href="#md:interfaz-customerinterface"><span>Interfaz <wbr/>Customer<wbr/>Interface</span></a></li><li><a href="#md:esquema-customerschema"><span>Esquema <wbr/>Customer<wbr/>Schema</span></a></li><li><a href="#md:exportación-del-modelo"><span>Exportación del <wbr/>Modelo</span></a></li></ul></li><li><a href="#md:resumen-1"><span>Resumen</span></a></li><li><a href="#md:furniturets-2"><span>Furniture.ts</span></a></li></ul></li><li><a href="#md:interfaz-del-mueble-furnitureinterface"><span>Interfaz del <wbr/>Mueble (<wbr/>Furniture<wbr/>Interface)</span></a></li><li><ul><li><ul><li><a href="#md:esquema-del-mueble-furnitureschema"><span>Esquema del <wbr/>Mueble (<wbr/>Furniture<wbr/>Schema)</span></a></li><li><a href="#md:validaciones-y-opciones"><span>Validaciones y <wbr/>Opciones</span></a></li><li><a href="#md:otros-aspectos"><span>Otros <wbr/>Aspectos</span></a></li></ul></li><li><a href="#md:providerts-2"><span>Provider.ts</span></a></li><li><ul><li><a href="#md:interfaz-del-proveedor-providerinterface"><span>Interfaz del <wbr/>Proveedor (<wbr/>Provider<wbr/>Interface)</span></a></li><li><a href="#md:esquema-del-proveedor-providerschema"><span>Esquema del <wbr/>Proveedor (<wbr/>Provider<wbr/>Schema)</span></a></li><li><a href="#md:validaciones-y-opciones-1"><span>Validaciones y <wbr/>Opciones</span></a></li><li><a href="#md:modelo-del-proveedor-provider"><span>Modelo del <wbr/>Proveedor (<wbr/>Provider)</span></a></li></ul></li><li><a href="#md:transactionsts-2"><span>Transactions.ts</span></a></li><li><ul><li><ul><li><a href="#md:descripción-general-2"><span>Descripción <wbr/>General</span></a></li></ul></li><li><a href="#md:detalles-del-código-2"><span>Detalles del <wbr/>Código</span></a></li><li><a href="#md:importación-de-mongoose-y-tipos"><span>Importación de <wbr/>Mongoose y <wbr/>Tipos</span></a></li><li><a href="#md:interfaz-transactioninterface"><span>Interfaz <wbr/>Transaction<wbr/>Interface</span></a></li><li><a href="#md:esquema-transactionschema"><span>Esquema <wbr/>Transaction<wbr/>Schema</span></a></li><li><a href="#md:exportación-del-modelo-1"><span>Exportación del <wbr/>Modelo</span></a></li></ul></li><li><a href="#md:resumen-2"><span>Resumen</span></a></li></ul></li><li><a href="#md:routers-1"><span>Routers</span></a></li><li><ul><li><a href="#md:customerts-3"><span>Customer.ts</span></a></li><li><a href="#md:descripción-general-3"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-3"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-dependencias"><span>Importación de <wbr/>Dependencias</span></a></li><li><a href="#md:ruta-post-para-39customers39"><span>Ruta POST para &#39;/customers&#39;</span></a></li><li><a href="#md:ruta-get-para-39customers39"><span>Ruta GET para &#39;/customers&#39;</span></a></li><li><a href="#md:ruta-get-para-39customersid39"><span>Ruta GET para &#39;/customers/:id&#39;</span></a></li><li><a href="#md:ruta-patch-para-39customers39"><span>Ruta PATCH para &#39;/customers&#39;</span></a></li><li><a href="#md:ruta-patch-para-39customersid39"><span>Ruta PATCH para &#39;/customers/:id&#39;</span></a></li><li><a href="#md:ruta-delete-para-39customers39"><span>Ruta DELETE para &#39;/customers&#39;</span></a></li><li><a href="#md:ruta-delete-para-39customersid39"><span>Ruta DELETE para &#39;/customers/:id&#39;</span></a></li></ul></li><li><a href="#md:resumen-3"><span>Resumen</span></a></li><li><a href="#md:defaultsts-1"><span>Defaults.ts</span></a></li><li><a href="#md:descripción-general-4"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-4"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-express"><span>Importación de <wbr/>Express</span></a></li><li><a href="#md:definición-del-router"><span>Definición del <wbr/>Router</span></a></li><li><a href="#md:ruta-por-defecto"><span>Ruta por <wbr/>Defecto</span></a></li></ul></li><li><a href="#md:resumen-4"><span>Resumen</span></a></li><li><a href="#md:furniturets-3"><span>Furniture.ts</span></a></li><li><a href="#md:descripción-general-5"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-5"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-dependencias-1"><span>Importación de <wbr/>Dependencias</span></a></li><li><a href="#md:ruta-post-para-39furnitures39"><span>Ruta POST para &#39;/furnitures&#39;</span></a></li><li><a href="#md:ruta-get-para-39furnitures39"><span>Ruta GET para &#39;/furnitures&#39;</span></a></li><li><a href="#md:ruta-get-para-39furnituresid39"><span>Ruta GET para &#39;/furnitures/:id&#39;</span></a></li><li><a href="#md:ruta-patch-para-39furnitures39"><span>Ruta PATCH para &#39;/furnitures&#39;</span></a></li><li><a href="#md:ruta-patch-para-39furnituresid39"><span>Ruta PATCH para &#39;/furnitures/:id&#39;</span></a></li><li><a href="#md:ruta-delete-para-39furnitures39"><span>Ruta DELETE para &#39;/furnitures&#39;</span></a></li><li><a href="#md:ruta-delete-para-39furnituresid39"><span>Ruta DELETE para &#39;/furnitures/:id&#39;</span></a></li></ul></li><li><a href="#md:resumen-5"><span>Resumen</span></a></li><li><a href="#md:providerts-3"><span>Provider.ts</span></a></li><li><ul><li><a href="#md:enrutador-del-proveedor-providerrouter"><span>Enrutador del <wbr/>Proveedor (provider<wbr/>Router)</span></a></li><li><a href="#md:ruta-post-39providers39"><span>Ruta POST &#39;/providers&#39;</span></a></li><li><a href="#md:ruta-get-39providers39"><span>Ruta GET &#39;/providers&#39;</span></a></li><li><a href="#md:ruta-get-39providersid39"><span>Ruta GET &#39;/providers/:id&#39;</span></a></li><li><a href="#md:ruta-patch-39providers39"><span>Ruta PATCH &#39;/providers&#39;</span></a></li><li><a href="#md:ruta-patch-39providersid39"><span>Ruta PATCH &#39;/providers/:id&#39;</span></a></li><li><a href="#md:ruta-delete-39providers39"><span>Ruta DELETE &#39;/providers&#39;</span></a></li><li><a href="#md:ruta-delete-39providersid39"><span>Ruta DELETE &#39;/providers/:id&#39;</span></a></li></ul></li><li><a href="#md:transactionsts-3"><span>Transactions.ts</span></a></li><li><ul><li><a href="#md:enrutador-de-transacciones-transactionrouter"><span>Enrutador de <wbr/>Transacciones (transaction<wbr/>Router)</span></a></li><li><a href="#md:ruta-post-39transactions39"><span>Ruta POST &#39;/transactions&#39;</span></a></li><li><a href="#md:ruta-get-39transactions39"><span>Ruta GET &#39;/transactions&#39;</span></a></li><li><a href="#md:ruta-get-39transactionsid39"><span>Ruta GET &#39;/transactions/:id&#39;</span></a></li><li><a href="#md:ruta-patch-39transactions39"><span>Ruta PATCH &#39;/transactions&#39;</span></a></li><li><a href="#md:ruta-patch-39transactionsid39"><span>Ruta PATCH &#39;/transactions/:id&#39;</span></a></li><li><a href="#md:ruta-delete-39transactions39"><span>Ruta DELETE &#39;/transactions&#39;</span></a></li><li><a href="#md:ruta-delete-39transactionsid39"><span>Ruta DELETE &#39;/transactions/:id&#39;</span></a></li></ul></li></ul></li><li><a href="#md:variables-1"><span>Variables</span></a></li><li><ul><li><a href="#md:typests-1"><span>Types.ts</span></a></li><li><a href="#md:descripción-general-6"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-6"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:tipo-de-género-genre"><span>Tipo de <wbr/>Género (<wbr/>Genre)</span></a></li><li><a href="#md:tipo-de-color-color"><span>Tipo de <wbr/>Color (<wbr/>Color)</span></a></li><li><a href="#md:tipo-de-material-material"><span>Tipo de <wbr/>Material (<wbr/>Material)</span></a></li><li><a href="#md:tipo-de-transacción-transactiontype"><span>Tipo de <wbr/>Transacción (<wbr/>Transaction<wbr/>Type)</span></a></li><li><a href="#md:tipo-de-categoría-de-muebles-catergorytype"><span>Tipo de <wbr/>Categoría de <wbr/>Muebles (<wbr/>Catergory<wbr/>Type)</span></a></li></ul></li><li><a href="#md:resumen-6"><span>Resumen</span></a></li></ul></li><li><a href="#md:indexts-1"><span>Index.ts</span></a></li><li><ul><li><a href="#md:descripción-general-7"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-7"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-dependencias-2"><span>Importación de <wbr/>Dependencias</span></a></li><li><a href="#md:configuración-del-puerto"><span>Configuración del <wbr/>Puerto</span></a></li><li><a href="#md:creación-de-la-aplicación-express"><span>Creación de la <wbr/>Aplicación <wbr/>Express</span></a></li><li><a href="#md:middlewares"><span>Middlewares</span></a></li><li><a href="#md:montaje-de-routers"><span>Montaje de <wbr/>Routers</span></a></li><li><a href="#md:inicio-del-servidor"><span>Inicio del <wbr/>Servidor</span></a></li></ul></li><li><a href="#md:resumen-7"><span>Resumen</span></a></li></ul></li></ul></li><li><a href="#md:pruebas-hechas"><span>Pruebas hechas.</span></a></li><li><ul><li><a href="#md:customerspects"><span>Customer.spec.ts</span></a></li><li><ul><li><a href="#md:descripción-general-8"><span>Descripción <wbr/>General</span></a></li><li><a href="#md:detalles-del-código-8"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-dependencias-3"><span>Importación de <wbr/>Dependencias</span></a></li><li><a href="#md:declaración-de-clientes-de-prueba"><span>Declaración de <wbr/>Clientes de <wbr/>Prueba</span></a></li><li><a href="#md:hooks-para-configuración-y-limpieza"><span>Hooks para <wbr/>Configuración y <wbr/>Limpieza</span></a></li><li><a href="#md:pruebas-get"><span>Pruebas GET</span></a></li><li><a href="#md:pruebas-post"><span>Pruebas POST</span></a></li><li><a href="#md:pruebas-patch"><span>Pruebas PATCH</span></a></li><li><a href="#md:pruebas-delete"><span>Pruebas DELETE</span></a></li><li><a href="#md:pruebas-del-esquema-de-cliente"><span>Pruebas del <wbr/>Esquema de <wbr/>Cliente</span></a></li></ul></li><li><a href="#md:resumen-8"><span>Resumen</span></a></li></ul></li><li><a href="#md:furniturespects"><span>Furniture.spec.ts</span></a></li><li><ul><li><a href="#md:creación-de-muebles"><span>Creación de <wbr/>Muebles</span></a></li><li><a href="#md:actualización-de-muebles"><span>Actualización de <wbr/>Muebles</span></a></li><li><a href="#md:obtención-de-muebles"><span>Obtención de <wbr/>Muebles</span></a></li><li><a href="#md:eliminación-de-muebles"><span>Eliminación de <wbr/>Muebles</span></a></li></ul></li><li><a href="#md:providerspects"><span>Provider.spec.ts</span></a></li><li><ul><li><a href="#md:creación-de-proveedores"><span>Creación de <wbr/>Proveedores</span></a></li><li><a href="#md:obtención-de-proveedores"><span>Obtención de <wbr/>Proveedores</span></a></li><li><a href="#md:actualización-de-proveedores"><span>Actualización de <wbr/>Proveedores</span></a></li><li><a href="#md:eliminación-de-proveedores"><span>Eliminación de <wbr/>Proveedores</span></a></li></ul></li><li><a href="#md:transactionspects"><span>Transaction.spec.ts</span></a></li><li><ul><li><a href="#md:detalles-del-código-9"><span>Detalles del <wbr/>Código</span></a></li><li><ul><li><a href="#md:importación-de-dependencias-4"><span>Importación de <wbr/>Dependencias</span></a></li><li><a href="#md:hooks-para-configuración-y-limpieza-1"><span>Hooks para <wbr/>Configuración y <wbr/>Limpieza</span></a></li><li><a href="#md:pruebas-post-1"><span>Pruebas POST</span></a></li><li><a href="#md:pruebas-get-1"><span>Pruebas GET</span></a></li><li><a href="#md:pruebas-delete-1"><span>Pruebas DELETE</span></a></li><li><a href="#md:pruebas-put"><span>Pruebas PUT</span></a></li><li><a href="#md:pruebas-de-validación-de-referencias"><span>Pruebas de <wbr/>Validación de <wbr/>Referencias</span></a></li></ul></li><li><a href="#md:resumen-9"><span>Resumen</span></a></li></ul></li></ul></li></ul><a href="#md:11-conclusion"><span>11. <wbr/>Conclusion.</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>practica-13-dsi-kea</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>